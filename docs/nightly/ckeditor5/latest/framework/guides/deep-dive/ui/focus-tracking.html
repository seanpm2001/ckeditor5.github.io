<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Focus tracking - CKEditor 5 Documentation</title>
    <meta name="description" content="Learn how to install, integrate and configure CKEditor 5 Builds and how to work with CKEditor 5 Framework, customize it, create your own plugins and custom editors, change the UI or even bring your own UI to the editor. API reference and examples included.">
    <meta name="twitter:card" content="Learn how to install, integrate and configure CKEditor 5 Builds and how to work with CKEditor 5 Framework, customize it, create your own plugins and custom editors, change the UI or even bring your own UI to the editor. API reference and examples included.">
    <meta name="twitter:site" content="@ckeditor">
    <meta name="x-generated-at" content="Thu Feb 23 2023 04:16:15 GMT+0000 (Coordinated Universal Time)">
    <meta property="og:title" content="Focus tracking - CKEditor 5 Documentation">
    <meta property="og:description" content="Learn how to install, integrate and configure CKEditor 5 Builds and how to work with CKEditor 5 Framework, customize it, create your own plugins and custom editors, change the UI or even bring your own UI to the editor. API reference and examples included.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ckeditor.com/docs/ckeditor5/latest/framework/guides/deep-dive/ui/focus-tracking.html">
    <meta property="DC.language" content="en">
    <meta property="DC.publisher" content="CKSource">
    <meta property="DC.creator" content="CKEditor">
    <meta property="DC.title" content="Focus tracking - CKEditor 5 Documentation">
    <meta property="DC.format" content="text/html">
    <meta property="DC.type" content="Text">
    <meta property="DC.description" content="Learn how to install, integrate and configure CKEditor 5 Builds and how to work with CKEditor 5 Framework, customize it, create your own plugins and custom editors, change the UI or even bring your own UI to the editor. API reference and examples included.">
    <link rel="canonical" href="https://ckeditor.com/docs/ckeditor5/latest/framework/guides/deep-dive/ui/focus-tracking.html">
    <link rel="icon" type="image/png" href="../../../../assets/img/favicons/16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="../../../../assets/img/favicons/32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="../../../../assets/img/favicons/96x96.png" sizes="96x96">
    <link rel="apple-touch-icon" type="image/png" href="../../../../assets/img/favicons/200x200.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
    <link rel="stylesheet" href="../../../../../../assets/2.4.0/css/styles.css" type="text/css" media="all">
    <link rel="stylesheet" href="../../../../assets/styles.css" type="text/css">
    <script>if ( ["ckeditor5.github.io"].indexOf( location.hostname ) !== -1 ) {
      	function pageView() {
      		ga( 'send', 'pageview', location.pathname + location.search + location.hash );
      	}
      
      	(function( i, s, o, g, r, a, m ) {
      		i[ 'GoogleAnalyticsObject' ] = r;
      		i[ r ] = i[ r ] || function() {
      				(i[ r ].q = i[ r ].q || []).push( arguments )
      			}, i[ r ].l = 1 * new Date();
      		a = s.createElement( o ),
      			m = s.getElementsByTagName( o )[ 0 ];
      		a.async = 1;
      		a.src = g;
      		m.parentNode.insertBefore( a, m )
      	})( window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga' );
      
      	ga( 'create', {"trackingId":"UA-271067-19","cookieDomain":"ckeditor5.github.io"} );
      
      	pageView();
      
      	window.addEventListener( 'hashchange', pageView );
      }
    </script>
  <meta name="generator" content="Hexo 6.3.0"></head>
  <body>
    <header class="top" data-project="ckeditor5">
      <div class="header__main">
        <div class="header__main-rwd-button"><a href="#"><span></span><span></span><span></span></a></div>
        <div class="header__main-title"><a class="header__main-title-home" href="../../../../../../index.html">CKEditor Ecosystem Documentation</a></div>
        <div class="top__search">
          <input class="top__search__box" type="text" id="docsearch_input" placeholder="Search in CKEditor 5">
          <div class="top__search__button"><img src="../../../../../../assets/2.4.0/img/loupe.svg" alt="Search"></div>
        </div>
      </div>
      <div class="header__sub">
        <ul class="top__menu">
          <li class="top__menu-project-logo"><a href="../../../../index.html">CKEditor 5</a></li>
          <li><a href="../../../../installation/index.html">Getting started</a></li>
          <li><a href="../../../../features/index.html">Features</a></li>
          <li><a href="../../../../examples/index.html">Examples</a></li>
          <li><a href="../../../../updating/index.html">Updating</a></li>
          <li><a href="../../../../support/index.html">Support</a></li>
          <li><a class="top__menu__item--active" href="../../../index.html">Framework</a></li>
          <li><a class="top__menu__api" href="../../../../api/index.html">API</a></li>
          <li><a class="top__menu-github-link" href="https://github.com/ckeditor/ckeditor5" target="_blank" title="CKEditor 5 on GitHub."><svg viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a></li>
        </ul>
      </div>
      <div class="header__menu-rwd">
        <ul class="header__menu-rwd__projects">
          <li data-project="ckeditor5"><a href="../../../../../latest/index.html">CKEditor 5</a>
            <ul class="tree header__menu-rwd__projects-pages">
              <li data-group="installation"><a href="../../../../installation/index.html">Getting started</a>
              </li>
              <li data-group="features"><a href="../../../../features/index.html">Features</a>
              </li>
              <li data-group="examples"><a href="../../../../examples/index.html">Examples</a>
              </li>
              <li data-group="updating"><a href="../../../../updating/index.html">Updating</a>
              </li>
              <li data-group="support"><a href="../../../../support/index.html">Support</a>
              </li>
              <li data-group="framework"><a href="../../../index.html">Framework</a>
                <ul class="header__menu-rwd__projects-subpages">
                          <li><a href="../../../index.html">
                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Overview</span>
                              </div></a></li>
                          <li>
                            <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Guides</span>
                            </div>
                            <ul class="tree__item-nested-list">
                                  <li><a href="../../quick-start.html">
                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Quick start</span>
                                      </div></a></li>
                                  <li><a href="../../development-tools.html">
                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Development tools</span>
                                      </div></a></li>
                                  <li>
                                    <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Architecture</span>
                                    </div>
                                    <ul class="tree__item-nested-list">
                                          <li><a href="../../architecture/intro.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Introduction</span>
                                              </div></a></li>
                                          <li><a href="../../architecture/core-editor-architecture.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Core editor architecture</span>
                                              </div></a></li>
                                          <li><a href="../../architecture/editing-engine.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Editing engine</span>
                                              </div></a></li>
                                          <li><a href="../../architecture/ui-library.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">UI library</span>
                                              </div></a></li>
                                    </ul>
                                  </li>
                                  <li>
                                    <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Developing custom plugins</span>
                                    </div>
                                    <ul class="tree__item-nested-list">
                                          <li><a href="../../plugins/creating-simple-plugin-timestamp.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Creating a basic plugin</span>
                                              </div></a></li>
                                          <li>
                                            <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Creating an abbreviation plugin</span>
                                            </div>
                                            <ul class="tree__item-nested-list">
                                                  <li><a href="../../plugins/abbreviation-plugin/abbreviation-plugin-level-1.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Defining a model and a view</span>
                                                      </div></a></li>
                                                  <li><a href="../../plugins/abbreviation-plugin/abbreviation-plugin-level-2.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Getting user input with a custom UI</span>
                                                      </div></a></li>
                                                  <li><a href="../../plugins/abbreviation-plugin/abbreviation-plugin-level-3.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Improving accessibility and adding a command</span>
                                                      </div></a></li>
                                            </ul>
                                          </li>
                                          <li>
                                            <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Package Generator</span>
                                            </div>
                                            <ul class="tree__item-nested-list">
                                                  <li><a href="../../plugins/package-generator/using-package-generator.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Using package generator</span>
                                                      </div></a></li>
                                                  <li><a href="../../plugins/package-generator/javascript-package.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">JavaScript package</span>
                                                      </div></a></li>
                                                  <li><a href="../../plugins/package-generator/typescript-package.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">TypeScript package</span>
                                                      </div></a></li>
                                            </ul>
                                          </li>
                                    </ul>
                                  </li>
                                  <li>
                                    <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Advanced tutorials</span>
                                    </div>
                                    <ul class="tree__item-nested-list">
                                          <li><a href="../../tutorials/implementing-a-block-widget.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Implementing a block widget</span>
                                              </div></a></li>
                                          <li><a href="../../tutorials/implementing-an-inline-widget.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Implementing an inline widget</span>
                                              </div></a></li>
                                          <li><a href="../../tutorials/data-from-external-source.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Data from an external source</span>
                                              </div></a></li>
                                          <li><a href="../../tutorials/using-react-in-a-widget.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Using a React component in a widget</span>
                                              </div></a></li>
                                    </ul>
                                  </li>
                                  <li>
                                    <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Deep dive</span>
                                    </div>
                                    <ul class="tree__item-nested-list">
                                          <li><a href="../clipboard.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Clipboard</span>
                                              </div></a></li>
                                          <li><a href="../upload-adapter.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Custom upload adapter</span>
                                              </div></a></li>
                                          <li><a href="../event-system.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Event system</span>
                                              </div></a></li>
                                          <li><a href="../observables.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Observables</span>
                                              </div></a></li>
                                          <li><a href="../schema.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Schema</span>
                                              </div></a></li>
                                          <li>
                                            <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Conversion</span>
                                            </div>
                                            <ul class="tree__item-nested-list">
                                                  <li><a href="../conversion/intro.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Introduction</span>
                                                      </div></a></li>
                                                  <li><a href="../conversion/downcast.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Model to view (downcast)</span>
                                                      </div></a></li>
                                                  <li><a href="../conversion/upcast.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">View to model (upcast)</span>
                                                      </div></a></li>
                                                  <li>
                                                    <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Conversion helpers</span>
                                                    </div>
                                                    <ul class="tree__item-nested-list">
                                                          <li><a href="../conversion/helpers/intro.html">
                                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Introduction</span>
                                                              </div></a></li>
                                                          <li><a href="../conversion/helpers/downcast.html">
                                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Downcast helpers</span>
                                                              </div></a></li>
                                                          <li><a href="../conversion/helpers/upcast.html">
                                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Upcast helpers</span>
                                                              </div></a></li>
                                                    </ul>
                                                  </li>
                                            </ul>
                                          </li>
                                          <li>
                                            <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">User interface</span>
                                            </div>
                                            <ul class="tree__item-nested-list">
                                                  <li><a href="">
                                                      <div class="tree__item__wrapper tree__item__wrapper--active"><span class="tree__item--guide tree__item__text">Focus tracking</span>
                                                      </div></a></li>
                                                  <li><a href="widget-internals.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Widget internals</span>
                                                      </div></a></li>
                                                  <li><a href="theme-customization.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Theme customization</span>
                                                      </div></a></li>
                                                  <li><a href="external-ui.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Third–party UI</span>
                                                      </div></a></li>
                                                  <li><a href="document-editor.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Document editor</span>
                                                      </div></a></li>
                                                  <li><a href="custom-editor-creator.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Creating custom editor</span>
                                                      </div></a></li>
                                                  <li><a href="localization.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Localization</span>
                                                      </div></a></li>
                                            </ul>
                                          </li>
                                    </ul>
                                  </li>
                                  <li>
                                    <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Contributing</span>
                                    </div>
                                    <ul class="tree__item-nested-list">
                                          <li><a href="../../contributing/contributing.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Contributing</span>
                                              </div></a></li>
                                          <li><a href="../../contributing/development-environment.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Development environment</span>
                                              </div></a></li>
                                          <li><a href="../../contributing/testing-environment.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Testing environment</span>
                                              </div></a></li>
                                          <li><a href="../../contributing/code-style.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Code style</span>
                                              </div></a></li>
                                          <li><a href="../../contributing/package-metadata.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Package metadata</span>
                                              </div></a></li>
                                          <li><a href="../../contributing/git-commit-message-convention.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Git commit message convention</span>
                                              </div></a></li>
                                    </ul>
                                  </li>
                            </ul>
                          </li>
                </ul>
              </li>
              <li data-group="api-reference"><a href="../../../../api/index.html">API</a>
              </li>
            </ul>
          </li>
        </ul>
      </div>
    </header>
    <main class="main">
      <section class="main__content formatted focus-tracking">
        <div class="main__content-inner">
          <div class="github-contrib"><a href="https://github.com/ckeditor/ckeditor5/blob/master/packages/ckeditor5-ui/docs/framework/guides/deep-dive/focus-tracking.md" title="Contribute to this guide"><img src="../../../../../../assets/2.4.0/img/edit.svg" alt="Contribute to this guide"></a>
          </div>
          <div class="rwd-breadcrumbs"><a href="../../../../../../index.html">Home</a><span class="rwd-breadcrumbs__separator">/</span><a href="../../../../index.html">CKEditor 5</a><span class="rwd-breadcrumbs__separator">/</span><a href="../../../index.html">Framework</a>
          </div>
          <h1 class="main__content-title"><img src="../../../../../../assets/2.4.0/img/book.svg" alt="guide">Deep dive into focus tracking
          </h1><nav class="secondary-navigation"><h3>Table of contents</h3><ol><li><a href="#what-is-focus-and-why-it-matters-for-ckeditor">What is focus and why it matters for CKEditor?</a><ol><li><a href="#what-is-focus">What is focus?</a></li><li><a href="#focus-in-ckeditor">Focus in CKEditor</a></li></ol></li><li><a href="#focus-in-the-editor-engine">Focus in the editor engine</a><ol><li><a href="#checking-if-the-view-document-is-focused">Checking if the view document is focused</a></li><li><a href="#how-to-focus-the-editor">How to focus the editor?</a></li></ol></li><li><a href="#focus-in-the-editor-ui">Focus in the editor UI</a><ol><li><a href="#tools-and-architecture">Tools and architecture</a></li><li><a href="#implementing-focusable-ui-components">Implementing focusable UI components</a></li><li><a href="#using-the-focustracker-class">Using the FocusTracker class</a><ol><li><a href="#a-note-about-the-global-focus-tracker">A note about the global focus tracker</a></li><li><a href="#a-practical-example">A practical example</a></li></ol></li><li><a href="#using-the-keystrokehandler-class">Using the KeystrokeHandler class</a></li><li><a href="#using-the-focuscycler-class">Using the FocusCycler class</a></li><li><a href="#using-all-focus-helpers-together">Using all focus helpers together</a></li></ol></li><li><a href="#focus-state-analysis">Focus state analysis</a><ol><li><a href="#scenario">Scenario</a></li><li><a href="#conclusions">Conclusions</a></li></ol></li></ol></nav>
<p><strong>Focus is where all the keyboard interactions (events) take place.</strong> It is an essential concept for any piece of a web page operated with a keyboard, be it a physical keyboard of your laptop or a software keyboard of your smartphone. And CKEditor 5 being a rich text editor is no exception here.</p>
<h2 id="what-is-focus-and-why-it-matters-for-ckeditor"><a class="headerlink" href="#what-is-focus-and-why-it-matters-for-ckeditor">#</a> What is focus and why it matters for CKEditor?</h2>
<h3 id="what-is-focus"><a class="headerlink" href="#what-is-focus">#</a> What is focus?</h3>
<p>Every time you click a text field or an editor, it automatically prepares to accept your text. It is no longer just a static container for letters but something you can interact with using your keyboard. And you know it because you can see the familiar blinking caret somewhere inside of it. This subtle action called a <strong>focus change</strong> takes place hundreds of times every day as you navigate web pages, type your search queries, chat with your friends and fill in checkout forms when online shopping.</p>
<p><img src="../../../../assets/img/framework-deep-dive-focus-form-example.gif" data-lightbox="true" alt="The animation showing the focus moving from one field to another when filling in the form." width="578"></p>
<p>Focusing text fields feels so natural we usually do not give it much thought. But if it wasn’t for that simple action… there would be no way to type text. Where would it go if there was no focused field? Focus informs the software about your intentions and it is synonymous with the <strong>context</strong>.</p>
<h3 id="focus-in-ckeditor"><a class="headerlink" href="#focus-in-ckeditor">#</a> Focus in CKEditor</h3>
<p>But CKEditor is more than a simple text field. Yes, it has the main space where you type your text but other places also allow you to type, for instance, a link URL field or a form with plenty of inputs allowing you to configure the look of a table.</p>
<p><img src="../../../../assets/img/framework-deep-dive-focus-link-blinking-caret.gif" data-lightbox="true" alt="The animation showing the focused link URL input in CKEditor 5 with a blinking caret." width="606"></p>
<p>And when many places accept focus, there must be some systems out there to discover and manage it. These systems work, for instance, so you will not find yourself in a situation where CKEditor 5 loses focus (or gets <strong>blurred</strong>) and you cannot type your text. Or they make sure you can see and use the editor toolbar as long as you keep editing. These are just a few examples of why focus management systems are necessary. Now it should also be clear that they are essential for the editing experience.</p>
<p>In the following chapters of this guide, we will explain how these systems work, what makes CKEditor “focusable”, and how to develop new editor features so they fit into the existing focus management systems and patterns:</p>
<ul>
<li><a href="#focus-in-the-editor-engine"><strong>The first section</strong></a> explains how the editor <a href="../../architecture/editing-engine.html">engine</a> manages focus and what tools exist there to help you out when developing new features.</li>
<li>In <a href="#focus-in-the-editor-ui"><strong>the second section</strong></a>, we will show you how the <a href="../../architecture/ui-library.html">user interface</a> of the editor tracks focus and how various UI components take advantage of that, for instance, to provide accessibility.</li>
<li>In <a href="#focus-state-analysis"><strong>the last part</strong></a>, we will use the knowledge from previous sections in a real–life scenario and analyze how all these tools and systems work together.</li>
</ul>
<h2 id="focus-in-the-editor-engine"><a class="headerlink" href="#focus-in-the-editor-engine">#</a> Focus in the editor engine</h2>
<div class="info-box notice"><p>Keep in mind that information in this chapter concerns the editor <strong>engine layer only</strong>. To learn about focus in the user interface, check out the <a href="#focus-in-the-editor-ui">next section</a> of this guide.</p></div>
<p>The main editable area of CKEditor 5 WYSIWYG editor can be focused thanks to the <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Editable_content"><code>contenteditable</code></a> DOM attribute. This attribute tells the web browser that a web page element can be edited like any other text field, which also means it must be able to receive focus.</p>
<p>Each root of the editing view has the <code>contenteditable</code> attribute. The editing view uses the <a href="../../../../api/module_engine_view_observer_focusobserver-FocusObserver.html"><code>FocusObserver</code></a> (learn more about <a href="../../architecture/editing-engine.html#observers">view observers</a>) to track focus in editables by listening to native DOM <code>focus</code> and <code>blur</code> events coming from them.</p>
<div class="info-box notice"><p>Already confused? Take a look at our <a href="../../architecture/editing-engine.html#observers">editing engine guide</a> that explains what the editing view, editables and other building blocks of CKEditor 5 are.</p></div>
<h3 id="checking-if-the-view-document-is-focused"><a class="headerlink" href="#checking-if-the-view-document-is-focused">#</a> Checking if the view document is focused</h3>
<p>You can check if the view document is focused using its <a href="../observables.html">observable</a> <a href="../../../../api/module_engine_view_document-Document.html#member-isFocused"><code>isFocused</code></a> property. Create an editor instance and execute the following code:</p>
<pre class="highlight"><code class="js">console.log( editor.editing.view.document.isFocused );
</code></pre>
<p>If you run this snippet from the web browser’s developer console, it should return <code>false</code> unless you managed to keep the editor focused (e.g. by running a debugger and freezing the DOM). This happens because the editor loses focus the moment you switch to developer tools to execute the snippet.</p>
<p>So how do I know <code>isFocused</code> actually works? Since it is observable you can see how it changes live:</p>
<pre class="highlight"><code class="js">editor.editing.view.document.on( 'change:isFocused', ( evt, data, isFocused ) =&gt; {
    console.log( `View document is focused: ${ isFocused }.` );
} );
</code></pre>
<p>Click the editable area of the editor and then click somewhere else — the <code>isFocused</code> property will change its value when you do that. The same will also happen if you run an editor with <a href="custom-editor-creator.html"><strong>multiple editing roots</strong></a> and navigate across them.</p>
<p>To spice things up even more, you should also know <code>isFocused</code> will change when you focus any <a href="../../tutorials/implementing-a-block-widget.html"><strong>nested editable</strong></a> in the content (take, for example, a <a href="../../../../features/images/images-captions.html">caption of an image</a>). Sounds weird, right? This is because every nested editable in the content has the <code>contenteditable</code> attribute, too, and for the web browser moving your caret inside it means the main editable element is blurred and the nested one is focused.</p>
<h3 id="how-to-focus-the-editor"><a class="headerlink" href="#how-to-focus-the-editor">#</a> How to focus the editor?</h3>
<p>The simplest way to focus the editor is to call the <a href="../../../../api/module_core_editor_editor-Editor.html#function-focus"><code>editor.focus()</code></a> method.</p>
<p>However, you may wish to explicitly focus the editable area of CKEditor 5 when a certain action is executed (e.g. a button is clicked). To do that, use the <a href="../../../../api/module_engine_view_view-View.html#function-focus"><code>focus()</code></a> method of the editing view:</p>
<pre class="highlight"><code class="js">editor.editing.view.focus();
</code></pre>
<p>This snippet focuses the editable that has the selection. If the editor has not been focused yet, this will focus the very first editable. If an editor has multiple editing roots and the user was editing content, focus will be brought back where the user left off.</p>
<div class="info-box notice"><p>Focusing the editor does not change its selection. If you want to focus the editor and move the caret to a specific position, you should call <code>editor.editing.view.focus()</code> first and then use the <a href="../../../../api/module_engine_model_writer-Writer.html#function-setSelection"><code>setSelection()</code></a> method of the <a href="../../architecture/editing-engine.html#model">model writer</a> to change the selection.</p></div>
<h2 id="focus-in-the-editor-ui"><a class="headerlink" href="#focus-in-the-editor-ui">#</a> Focus in the editor UI</h2>
<p>If you read the <a href="#focus-in-the-editor-engine">previous section</a> of this guide you should know that there is already a layer responsible for tracking focus implemented in the <a href="../../architecture/editing-engine.html">editor engine</a>. But because the <a href="../../architecture/intro.html">editor framework is modular</a>, this layer is only concerned by the focus in editable roots of the editor and it knows nothing of the user interface. This granularity makes it possible, for instance, to create a fully–functioning editor without the UI.</p>
<p>As for the user interface of CKEditor 5, it is a composition of multiple components <a href="../../architecture/ui-library.html#view-collections-and-the-ui-tree">organized as a tree</a>. This tree determines not only the logical structure of the UI (a toolbar has a dropdown, a dropdown has a button, a button has an icon, etc.) but also its behavior, and that includes tracking and maintaining focus as the user navigates and interacts with various pieces of the interface.</p>
<div class="info-box notice"><p>Feeling overwhelmed? Take a look at the <a href="../../architecture/ui-library.html">UI library guide</a> and learn some basics about how the UI of CKEditor 5 works and what its main building blocks are.</p></div>
<p>To sum up, there are two main reasons why focus is being tracked separately on the UI level:</p>
<ul>
<li><strong>To make sure the editor (as a whole) never loses focus unless the user wants it to.</strong><br>
For instance, take a look at the <a href="../../../../examples/builds/inline-editor.html">inline editor</a>. As long as the user edits text in the main editable area or configures its properties in any popup, dropdown, or panel, the main editor toolbar must remain visible (because the focus is somewhere in the UI). Only when the user finishes editing and moves somewhere else on a web page, the toolbar can disappear.</li>
<li><strong>To make the UI accessible to users who navigate it using screen readers and other assistive technologies.</strong><br>
These users not only write text using the keyboard but also use it to navigate across toolbar buttons, panels, dropdowns, etc. The UI of the editor must constantly keep track of which component is currently focused, for example, to allow navigation using <kbd>Tab</kbd>, <kbd>Esc</kbd> and arrow keys.</li>
</ul>
<h3 id="tools-and-architecture"><a class="headerlink" href="#tools-and-architecture">#</a> Tools and architecture</h3>
<p>Focus management lives next to the <a href="../../architecture/ui-library.html#view-collections-and-the-ui-tree">user interface element tree</a> and its architecture is also based on components that respond to user actions within its boundaries and their children. Take a look at a common keyboard navigation scenario in a <a href="../../../../examples/builds/classic-editor.html">classic editor</a> instance:</p>
<p><img src="../../../../assets/img/framework-deep-dive-focus-toolbar-nav.gif" data-lightbox="true" alt="The animation showing the focus moving as the user navigates to the heading drop–down in the toolbar." width="950"></p>
<p>Here are the focus layers that play a role in the navigation and a brief overview of what happens at each layer:</p>
<p><img src="../../../../assets/img/framework-deep-dive-focus-toolbar-nav-layers.png" data-lightbox="true" alt="The image showing the focus layers used during navigation." width="1019"></p>
<ol>
<li>The root of the focus tree is the <a href="../../../../api/module_editor-classic_classiceditorui-ClassicEditorUI.html"><code>ClassicEditorUI</code></a> class. It creates a <a href="#a-note-about-the-global-focus-tracker">global focus tracker</a> for the entire editor (you can access it via <a href="../../../../api/module_core_editor_editorui-EditorUI.html#member-focusTracker"><code>editor.ui.focusTracker</code></a>).</li>
<li>When editing text, you can hit the <kbd>Alt</kbd>+<kbd>F10</kbd> keystroke to focus the main editor toolbar, which is the second focus layer.
<ul>
<li>The <a href="../../../../api/module_ui_toolbar_toolbarview-ToolbarView.html"><code>ToolbarView</code></a> component brings a focus tracker that keeps an eye on its children so that when a user navigates across the toolbar using the keyboard arrows, it is clear which item is focused.</li>
<li>Toolbars also use a <a href="#using-the-focuscycler-class">focus cycler</a> to provide continuous navigation. For instance, navigating to the next item when the last one is focused brings the focus back to the beginning of the toolbar.</li>
</ul>
</li>
<li>When a user selects a toolbar item, its <code>focus()</code> method is executed. That brings us to the third layer.
<ul>
<li>Some components of the toolbar are simple (like <a href="../../../../api/module_ui_button_buttonview-ButtonView.html"><code>ButtonView</code></a>) and their DOM elements are leaves of the focus tree. But some components, for instance, the <a href="../../../../api/module_ui_dropdown_dropdownview-DropdownView.html"><code>DropdownView</code></a>, are containers and allow the focus to go deeper. Each dropdown has a focusable button and can host one child view in its <a href="../../../../api/module_ui_dropdown_dropdownpanelview-DropdownPanelView.html"><code>DropdownPanelView</code></a>. It does not need a focus tracker because there are only two ways a user can navigate it: down its panel or away from it.</li>
</ul>
</li>
<li>When a user enters the dropdown’s panel, they visit another (fourth) layer of focus. This time it is the <a href="../../../../api/module_ui_list_listview-ListView.html"><code>ListView</code></a> that, like the <code>ToolbarView</code>, also needs a focus tracker and a focus cycler to allow smooth keyboard navigation across its items.</li>
<li>The outermost leaf of the focus tree in this example is a <a href="../../../../api/module_ui_list_listitemview-ListItemView.html"><code>ListItemView</code></a>. It has the <a href="../../../../api/module_ui_list_listitemview-ListItemView.html#function-focus"><code>focus()</code></a> method that focuses its element in the DOM.</li>
</ol>
<p>And here is the summary of the tools used by each focus layer (UI component):</p>
<figure class="table">
	<table>
		<thead>
			<tr>
				<th colspan="2">Focus layer</th>
				<th>Needs <a href="#using-the-focustracker-class">focus tracker</a>?</th>
				<th>Needs <a href="#using-the-keystrokehandler-class">keystroke handler</a>?</th>
				<th>Needs <a href="#using-the-focuscycler-class">focus cycler</a>?</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>1</td>
				<td><a href="../../../../api/module_editor-classic_classiceditorui-ClassicEditorUI.html"><code>ClassicEditorUI</code></a></td>
				<td>✅</td>
				<td>✅</td>
				<td>❌</td>
			</tr>
			<tr>
				<td>2</td>
				<td><a href="../../../../api/module_ui_toolbar_toolbarview-ToolbarView.html"><code>ToolbarView</code></a></td>
				<td>✅</td>
				<td>✅</td>
				<td>✅</td>
			</tr>
			<tr>
				<td>3</td>
				<td><a href="../../../../api/module_ui_dropdown_dropdownview-DropdownView.html"><code>DropdownView</code></a></td>
				<td>❌</td>
				<td>✅</td>
				<td>❌</td>
			</tr>
			<tr>
				<td>4</td>
				<td><a href="../../../../api/module_ui_list_listview-ListView.html"><code>ListView</code></a></td>
				<td>✅</td>
				<td>✅</td>
				<td>✅</td>
			</tr>
			<tr>
				<td>5</td>
				<td><a href="../../../../api/module_ui_list_listitemview-ListItemView.html"><code>ListItemView</code></a></td>
				<td>❌</td>
				<td>❌</td>
				<td>❌</td>
			</tr>
		</tbody>
	</table>
</figure>
<p>Most components have <a href="#using-the-focustracker-class">focus trackers</a> to keep up with the focus inside of them. Some components that host more children also use <a href="#using-the-focuscycler-class">focus cyclers</a> and <a href="#using-the-keystrokehandler-class">keystroke handlers</a> to help the user navigate across them. You can learn how to use them in the later sections of this guide:</p>
<ul>
<li><a href="#implementing-focusable-ui-components">Implementing focusable UI components</a>,</li>
<li><a href="#using-the-focustracker-class">Using the <code>FocusTracker</code> class</a>,</li>
<li><a href="#using-the-keystrokehandler-class">Using the <code>KeystrokeHandler</code> class</a>,</li>
<li><a href="#using-the-focuscycler-class">Using the <code>FocusCycler</code> class</a>.</li>
</ul>
<h3 id="implementing-focusable-ui-components"><a class="headerlink" href="#implementing-focusable-ui-components">#</a> Implementing focusable UI components</h3>
<p>Any UI <a href="../../architecture/ui-library.html#views">view</a> can be focusable. To become one, a view must implement the <code>focus()</code> method that focuses the DOM <a href="../../../../api/module_ui_view-View.html#member-element">element</a> and the <code>tabindex="-1"</code> attribute set on the element that prevents the native navigation using the keyboard (which should be handled by the <a href="#using-the-focuscycler-class">focus cycler</a> on the parent–level):</p>
<div class="info-box notice"><p>The <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex"><code>tabindex="-1"</code></a> is a native DOM attribute that controls whether a DOM element can be focused (and in which order). Setting its value to <code>"-1"</code> tells the web browser that it should exclude it from the native keyboard navigation and allow it only to be focused using JavaScript. Because your component will belong to the editor focus management system, you should do that if you want to avoid collisions with the web browser.</p></div>
<pre class="highlight"><code class="js">import View from '@ckeditor/ckeditor5-ui/src/view';

class MyListItemView extends View {
    constructor( locale, text ) {
        super( locale );

        // More initializations.
        // ...

        this.setTemplate( {
            tag: 'li',
            attributes: {
                tabindex: -1
            },
            children: [ text ]
        } );
    }

    // More methods.
    // ...

    focus() {
        this.element.focus();
    }
}
</code></pre>
<p>If a view has many focusable children (e.g. a list), the <code>focus()</code> method should focus the first child:</p>
<pre class="highlight"><code class="js">import View from '@ckeditor/ckeditor5-ui/src/view';

class MyListView extends View {
    constructor( locale ) {
        super( locale );

        // More initializations.
        // ...

        this.items = this.createCollection();

        this.setTemplate( {
            tag: 'ul',
            children: this.items
        } );
    }

    // More methods.
    // ...

    focus() {
        if ( this.items.length ) {
            // This will call MyListItemView#focus().
            this.items.first.focus();
        }
    }
}
</code></pre>
<p>Focusable views are what make it possible to navigate the interface of CKEditor using the keyboard. In the <a href="#using-the-focustracker-class">next section</a>, you will learn how parent views keep track of focus among their children using the <code>FocusTracker</code> class.</p>
<h3 id="using-the-focustracker-class"><a class="headerlink" href="#using-the-focustracker-class">#</a> Using the <code>FocusTracker</code> class</h3>
<p>One of the key focus management helpers in the CKEditor 5 UI is the <a href="../../../../api/module_utils_focustracker-FocusTracker.html"><code>FocusTracker</code></a> class and its instances. They work at the DOM level and offer a fairly simple API:</p>
<ul>
<li>Methods to <a href="../../../../api/module_utils_focustracker-FocusTracker.html#function-add"><code>add()</code></a> and <a href="../../../../api/module_utils_focustracker-FocusTracker.html#function-remove"><code>remove()</code></a> tracked DOM elements.</li>
<li>An observable <a href="../../../../api/module_utils_focustracker-FocusTracker.html#member-isFocused"><code>isFocused</code></a> property telling the world that one of the tracked elements has focus in the DOM.</li>
<li>An observable <a href="../../../../api/module_utils_focustracker-FocusTracker.html#member-focusedElement"><code>focusedElement</code></a> property that precisely says which DOM element is focused.</li>
</ul>
<p>Focus trackers listen to DOM <code>focus</code> and <code>blur</code> events coming from elements they track and they determine if any is currently focused. As a rule of thumb, a <a href="../../architecture/ui-library.html#view-collections-and-the-ui-tree">parent</a> to more than one focusable element should have a focus tracker.</p>
<div class="info-box notice"><p>Keep in mind that simple components that have no focusable children or just a single focusable child may not need a focus tracker.</p></div>
<h4 id="a-note-about-the-global-focus-tracker"><a class="headerlink" href="#a-note-about-the-global-focus-tracker">#</a> A note about the global focus tracker</h4>
<p>Each editor instance has a <strong>global focus tracker</strong> that can be accessed via <a href="../../../../api/module_core_editor_editorui-EditorUI.html#member-focusTracker"><code>editor.ui.focusTracker</code></a>. It is a special instance that glues all the pieces of the user interface together (including the editing root) and stores the focus state of the <strong>entire editor instance</strong>.</p>
<p>You can <strong>always</strong> listen to the global focus tracker and tell if the user is using the UI:</p>
<pre class="highlight"><code class="js">editor.ui.focusTracker.on( 'change:isFocused', ( evt, data, isFocused ) =&gt; {
    console.log( `The editor is focused: ${ isFocused }.` );
} );
</code></pre>
<p>The class responsible for the UI of the editor (<a href="../../../../api/module_editor-classic_classiceditorui-ClassicEditorUI.html"><code>ClassicEditorUI</code></a>, <a href="../../../../api/module_editor-inline_inlineeditorui-InlineEditorUI.html"><code>InlineEditorUI</code></a>, etc.) <strong>must</strong> inform the global focus tracker about the focusable building blocks of the interface, for instance, editable roots of the editor (where the editing takes place) or toolbars.</p>
<p>The same applies to plugins bringing any focusable UI. For instance, the <a href="../../../../api/module_ui_panel_balloon_contextualballoon-ContextualBalloon.html">contextual balloon</a> plugin that offers a shared floating balloon used by many features across the project (link editing, image tools, widget toolbars, etc.) also registers the balloon in the global focus tracker. Please keep this in mind when developing your custom editor plugins.</p>
<p>The continuity of editor focus is maintained <strong>only</strong> when the global focus tracker is aware of <strong>all</strong> focusable blocks of the UI. Their location in DOM is irrelevant: next to the editable root, in the <a href="../../../../api/module_ui_editorui_bodycollection-BodyCollection.html">“body” collection</a> or even somewhere else. To the global focus tracker they are all pieces of the same editor.</p>
<div class="info-box notice"><p>Check out the <a href="#focus-state-analysis">Focus state analysis section </a> to see the global focus tracker working in a real–life scenario.</p></div>
<h4 id="a-practical-example"><a class="headerlink" href="#a-practical-example">#</a> A practical example</h4>
<p>Take a look at the following example of a list that has multiple items, a classic use case for a focus tracker:</p>
<pre class="highlight"><code class="js">import View from '@ckeditor/ckeditor5-ui/src/view';
import FocusTracker from '@ckeditor/ckeditor5-utils/src/focustracker';

class MyListView extends View {
    constructor( locale ) {
        super( locale );

        // More initializations.
        // ...

        // A view collection containing items of the list.
        this.items = this.createCollection();

        // Setting the template.
        // ...

        // The instance of the focus tracker that tracks focus in #items.
        this.focusTracker = new FocusTracker();
    }

    // More methods.
    // ...
}
</code></pre>
<p>To make sure your focus tracker instance and the <code>items</code> view collection stay synchronized, create  listeners that will update the tracker when a new child view is added or some are removed (<a href="../../../../api/module_ui_viewcollection-ViewCollection.html">view collections fire events</a>). The best way to do that is inside the <a href="../../../../api/module_ui_view-View.html#function-render"><code>render()</code></a> method:</p>
<pre class="highlight"><code class="js">// Previously imported packages.
// ...

class MyListView extends View {
    constructor( locale ) {
        // More initializations.
        // ...
    }

    // More methods.
    // ...

    render() {
        super.render();

        // Children added before rendering should be known to the #focusTracker.
        for ( const item of this.items ) {
            this.focusTracker.add( item.element );
        }

        // Make sure items added to the collection are recognized by the #focusTracker.
        this.items.on( 'add', ( evt, item ) =&gt; {
            this.focusTracker.add( item.element );
        } );

        // Make sure items removed from the collection are ignored by the #focusTracker.
        this.items.on( 'remove', ( evt, item ) =&gt; {
            this.focusTracker.remove( item.element );
        } );
    }

    // More methods.
    // ...
}
</code></pre>
<p>The <code>MyListView</code> can now track focused children, and it is time to help the user navigate them using the keyboard. In the next section, you will create a <a href="#using-the-keystrokehandler-class">keystroke handler</a> that will bring you closer to the goal.</p>
<h3 id="using-the-keystrokehandler-class"><a class="headerlink" href="#using-the-keystrokehandler-class">#</a> Using the <code>KeystrokeHandler</code> class</h3>
<p>The <a href="../../../../api/module_utils_keystrokehandler-KeystrokeHandler.html"><code>KeystrokeHandler</code></a> helper class allows registering callbacks for the keystrokes. It is used in many views across the UI of the editor for many purposes. For instance, it is responsible for focusing the toolbar on the <kbd>Alt</kbd>+<kbd>F10</kbd> keypress or it opens the link popup form when you hit <kbd>Ctrl</kbd>+<kbd>L</kbd> on a selected text.</p>
<p>But in the context of focus management, it is used by the <a href="#using-the-focuscycler-class">focus cycler</a> you will get familiar with in the next section. You can learn more about the <a href="../../../../api/module_utils_keystrokehandler-KeystrokeHandler.html"><code>KeystrokeHandler</code></a> class in the API documentation but for now, you should only know how to create and initialize it before moving forward:</p>
<pre class="highlight"><code class="js">import View from '@ckeditor/ckeditor5-ui/src/view';
import FocusTracker from '@ckeditor/ckeditor5-utils/src/focustracker';
import FocusCycler from '@ckeditor/ckeditor5-ui/src/focuscycler';
import KeystrokeHandler from '@ckeditor/ckeditor5-utils/src/keystrokehandler';

export default class MyListView extends View {
    constructor( locale ) {
        super( locale );

        // More initializations.
        // ...

        // The keystroke handler that will help the focus cycler respond to the keystrokes.
        this.keystrokes = new KeystrokeHandler();
    }

    render() {
        super.render();

        // Setting the focus tracker.
        // ...

        // Start listening for the keystrokes coming from #element, which will allow
        // the focus cycler to handle the keyboard navigation.
        this.keystrokes.listenTo( this.element );
    }

    destroy() {
        // Stop listening to all keystrokes when the view is destroyed.
        this.keystrokes.destroy();
    }

    // More methods.
    // ...
}
</code></pre>
<h3 id="using-the-focuscycler-class"><a class="headerlink" href="#using-the-focuscycler-class">#</a> Using the <code>FocusCycler</code> class</h3>
<p><a href="../../../../api/module_ui_focuscycler-FocusCycler.html"><code>FocusCycler</code></a> helps the user navigate the user interface using the keystrokes (arrow keys, <kbd>Tab</kbd>, <kbd>Return</kbd>, <kbd>Esc</kbd>, etc.). This helper class was created with components hosting multiple children in mind, for instance, lists, toolbars or forms. It <em>cycles</em> over their children so, for instance, if the last child is focused and the user wants to move forward, the focus is moved back to the first child. It also supports components that have a variable (dynamic) number of focusable children.</p>
<p>Each focus cycler instance works together with a <a href="#using-the-focustracker-class">focus tracker</a> and a <a href="#using-the-keystrokehandler-class">keystroke handler</a>. The former delivers the current state of the focus, while the latter helps the cycler integrate with keystrokes, for instance, to focus the next item in the list on the down arrow key press.</p>
<p>Take a look at the example list class using focus cycler, keystroke handler and focus tracker instances together to enable the keyboard navigation. First, all the helpers must be created:</p>
<pre class="highlight"><code class="js">import View from '@ckeditor/ckeditor5-ui/src/view';
import FocusTracker from '@ckeditor/ckeditor5-utils/src/focustracker';
import FocusCycler from '@ckeditor/ckeditor5-ui/src/focuscycler';
import KeystrokeHandler from '@ckeditor/ckeditor5-utils/src/keystrokehandler';

class MyListView extends View {
    constructor( locale ) {
        super( locale );

        // More initializations.
        // ...

        // The view collection containing items of the list.
        this.items = this.createCollection();

        // The instance of the focus tracker that tracks focus in #items.
        this.focusTracker = new FocusTracker();

        // The keystroke handler that will help the focus cycler respond to the keystrokes.
        this.keystrokes = new KeystrokeHandler();

        // The focus cycler that glues it all together.
        this.focusCycler = new FocusCycler( {
            focusables: this.items,
            focusTracker: this.focusTracker,
            keystrokeHandler: this.keystrokes,
            actions: {
                // Navigate list items backward using the arrow up key.
                focusPrevious: 'arrowup',

                // Navigate toolbar items forward using the arrow down key.
                focusNext: 'arrowdown'
            }
        } );
    }

    // More methods.
    // ...
}
</code></pre>
<p>Similarly to the previous sections of this guide, feed the focus tracker and synchronize it with the list items collection in the <code>render()</code> method. Since the <a href="../../../../api/module_ui_view-View.html#member-element"><code>MyListView#element</code></a> has already been rendered at that stage, this is also the right moment to start listening to the keyboard events:</p>
<pre class="highlight"><code class="js">// Previously imported packages.
// ...

class MyListView extends View {
    constructor( locale ) {
        // More initializations.
        // ...
    }

    render() {
        super.render();

        // Items added before rendering should be known to the #focusTracker.
        for ( const item of this.items ) {
            this.focusTracker.add( item.element );
        }

        // Make sure items added to the collection are recognized by the #focusTracker.
        this.items.on( 'add', ( evt, item ) =&gt; {
            this.focusTracker.add( item.element );
        } );

        // Make sure items removed from the collection are ignored by the #focusTracker.
        this.items.on( 'remove', ( evt, item ) =&gt; {
            this.focusTracker.remove( item.element );
        } );

        // Start listening for the keystrokes coming from #element, which will allow
        // the #focusCycler to handle the keyboard navigation.
        this.keystrokes.listenTo( this.element );
    }

    focus() {
        if ( this.items.length ) {
            // This will call MyListItemView#focus().
            this.items.first.focus();
        }
    }

    destroy() {
        // Stop listening to all keystrokes when the view is destroyed.
        this.keystrokes.destroy();
    }

    // More methods.
    // ...
}
</code></pre>
<h3 id="using-all-focus-helpers-together"><a class="headerlink" href="#using-all-focus-helpers-together">#</a> Using all focus helpers together</h3>
<p>The complete code of a list class that hosts multiple item views and supports the keyboard navigation across them (when it gets focused) looks as follows:</p>
<pre class="highlight"><code class="js">import View from '@ckeditor/ckeditor5-ui/src/view';
import FocusTracker from '@ckeditor/ckeditor5-utils/src/focustracker';
import FocusCycler from '@ckeditor/ckeditor5-ui/src/focuscycler';
import KeystrokeHandler from '@ckeditor/ckeditor5-utils/src/keystrokehandler';

class MyListView extends View {
    constructor( locale ) {
        super( locale );

        // The view collection containing items of the list.
        this.items = this.createCollection();

        // The instance of the focus tracker that tracks focus in #items.
        this.focusTracker = new FocusTracker();

        // The keystroke handler that will help the focus cycler respond to the keystrokes.
        this.keystrokes = new KeystrokeHandler();

        // The focus cycler that glues it all together.
        this.focusCycler = new FocusCycler( {
            focusables: this.items,
            focusTracker: this.focusTracker,
            keystrokeHandler: this.keystrokes,
            actions: {
                // Navigate list items backward using the arrow up key.
                focusPrevious: 'arrowup',

                // Navigate toolbar items forward using the arrow down key.
                focusNext: 'arrowdown'
            }
        } );

        // More intializations.
        // ...

        this.setTemplate( {
                tag: 'ul',
                children: this.items
        } );
    }

    render() {
        super.render();

        // Items added before rendering should be known to the #focusTracker.
        for ( const item of this.items ) {
            this.focusTracker.add( item.element );
        }

        // Make sure items added to the collection are recognized by the #focusTracker.
        this.items.on( 'add', ( evt, item ) =&gt; {
            this.focusTracker.add( item.element );
        } );

        // Make sure items removed from the collection are ignored by the #focusTracker.
        this.items.on( 'remove', ( evt, item ) =&gt; {
            this.focusTracker.remove( item.element );
        } );

        // Start listening for the keystrokes coming from #element, which will allow
        // the #focusCycler to handle the keyboard navigation.
        this.keystrokes.listenTo( this.element );
    }

    focus() {
        if ( this.items.length ) {
            // This will call MyListItemView#focus().
            this.items.first.focus();
        }
    }

    destroy() {
        // Stop listening to all keystrokes when the view is destroyed.
        this.keystrokes.destroy();
    }
}

class MyListItemView extends View {
    constructor( locale, text ) {
        super( locale );

        // More initializations.
        // ...

        this.setTemplate( {
            tag: 'li',
            attributes: {
                tabindex: -1
            },
            children: [ text ]
        } );
    }

    // More methods.
    // ...

    focus() {
        this.element.focus();
    }
}
</code></pre>
<p>You can quickly run it in the context of an existing editor in the following way:</p>
<pre class="highlight"><code class="js">ClassicEditor
    .create( document.querySelector( '#editor' ), {
        // The editor's configuration.
        // ...
    } )
    .then( editor =&gt; {
        const list = new MyListView( editor.locale );

        // Create two example children.
        const firstChild = new MyListItemView( editor.locale, 'First child' );
        const secondChild = new MyListItemView( editor.locale, 'Second child' );

        // Add children to the list.
        list.items.add( firstChild );
        list.items.add( secondChild );

        // Render the list and put it in the DOM.
        list.render();
        editor.ui.view.body.add( list );

        // Focus the list. This should focus the first child.
        // Use up and down keyboard arrows to cycle across the list items.
        list.focus();
    } )
    .catch( err =&gt; {
        console.error( err.stack );
    } );
</code></pre>
<p>Now you can use the keyboard arrows to cycle the focused list items:</p>
<p><img src="../../../../assets/img/framework-deep-dive-focus-focus-cycling.gif" data-lightbox="true" alt="The animation showing the focus cycling across the list items." width="950"></p>
<h2 id="focus-state-analysis"><a class="headerlink" href="#focus-state-analysis">#</a> Focus state analysis</h2>
<p>This section contains an analysis of a common focus navigation scenario in an <a href="../../../../examples/builds/inline-editor.html">inline editor</a>. While the <a href="#focus-in-the-editor-ui">previous section</a> was focused on tools that make up the focus management system, this time we will focus on their state. This should help you better understand how all little pieces work in a bigger picture.</p>
<h3 id="scenario"><a class="headerlink" href="#scenario">#</a> Scenario</h3>
<p>Take a look at the following scenario where both mouse and keyboard are used to navigate the interface of the editor:</p>
<p><img src="../../../../assets/img/framework-deep-dive-focus-inline-scenario.gif" data-lightbox="true" alt="The animation showing the focus navigation across the inline editor UI." width="758"></p>
<p>And here are the steps of the scenario:</p>
<ol>
<li>The editor is not focused (the focus is somewhere else on the web page).</li>
<li>The <a href="../../../../api/module_ui_editableui_inline_inlineeditableuiview-InlineEditableUIView.html">editable area</a> gets focused using the mouse. The main toolbar shows up and because the link was clicked, the <a href="../../../../api/module_link_ui_linkactionsview-LinkActionsView.html">link actions view</a> also pops up.</li>
<li>The <kbd>Tab</kbd> key is used to focus the <a href="../../../../api/module_link_ui_linkactionsview-LinkActionsView.html#member-previewButtonView">link preview</a> in the balloon (a child of <a href="../../../../api/module_link_ui_linkactionsview-LinkActionsView.html"><code>LinkActionsView</code></a>).</li>
<li>The <kbd>Tab</kbd> key is used to focus the <a href="../../../../api/module_link_ui_linkactionsview-LinkActionsView.html#member-editButtonView">“Edit link” button</a>.</li>
<li>The <kbd>Space</kbd> key is used to execute the “Edit link” button. The focus moves to the <a href="../../../../api/module_link_ui_linkformview-LinkFormView.html#member-urlInputView">input</a> in the <a href="../../../../api/module_link_ui_linkformview-LinkFormView.html"><code>LinkFormView</code></a>.</li>
<li>The <kbd>Tab</kbd> key is used to move from the link URL field to the <a href="../../../../api/module_link_ui_linkformview-LinkFormView.html#member-saveButtonView">“Save” button</a>.</li>
<li>The <kbd>Tab</kbd> key is used to move from the “Save” button to the <a href="../../../../api/module_link_ui_linkformview-LinkFormView.html#member-cancelButtonView">“Cancel” button</a>.</li>
<li>The <kbd>Space</kbd> key is used to execute the “Cancel” button and close the editing form.</li>
<li>The <kbd>Esc</kbd> key is used to close the link balloon and go back to the editable.</li>
</ol>
<p>There are 3 focus tracker instances at play in the scenario:</p>
<ol>
<li>The <a href="../../../../api/module_core_editor_editorui-EditorUI.html#member-focusTracker"><code>EditorUI#focusTracker</code></a> (the <a href="#a-note-about-the-global-focus-tracker">“global” focus tracker</a>),</li>
<li>The <a href="../../../../api/module_link_ui_linkactionsview-LinkActionsView.html#member-focusTracker"><code>LinkActionsView#focusTracker</code></a>,</li>
<li>The <a href="../../../../api/module_link_ui_linkformview-LinkFormView.html#member-focusTracker"><code>LinkFormView#focusTracker</code></a>.</li>
</ol>
<p>Let’s see how they react to the user actions (states were recorded <strong>after</strong> each step):</p>
<table>
	<thead>
		<tr>
			<th rowspan="2">Step</th>
			<th colspan="2"><a href="../../../../api/module_core_editor_editorui-EditorUI.html#member-focusTracker"><code>EditorUI#focusTracker</code></a></th>
			<th colspan="2"><a href="../../../../api/module_link_ui_linkactionsview-LinkActionsView.html#member-focusTracker"><code>LinkActionsView#focusTracker</code></a></th>
			<th colspan="2"><a href="../../../../api/module_link_ui_linkformview-LinkFormView.html#member-focusTracker"><code>LinkFormView#focusTracker</code></a></th>
		</tr>
		<tr>
			<th><code>isFocused</code></th>
			<th><code>focusedElement</code></th>
			<th><code>isFocused</code></th>
			<th><code>focusedElement</code></th>
			<th><code>isFocused</code></th>
			<th><code>focusedElement</code></th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>1</td>
			<td>❌</td>
			<td><code>null</code></td>
			<td>❌</td>
			<td><code>null</code></td>
			<td>❌</td>
			<td> <code>null</code></td>
		</tr>
		<tr>
			<td>2</td>
			<td>✅</td>
			<td>editable</td>
			<td>❌</td>
			<td><code>null</code></td>
			<td>❌</td>
			<td> <code>null</code></td>
		</tr>
		<tr>
			<td>3</td>
			<td>✅</td>
			<td>balloon panel</td>
			<td rowspan="2">
				<p>✅</p>
				<p>✅</p>
			</td>
			<td>URL preview</td>
			<td>❌</td>
			<td><code>null</code></td>
		</tr>
		<tr>
			<td>4</td>
			<td>✅</td>
			<td>balloon panel</td>
			<td>"Edit link" button</td>
			<td>❌</td>
			<td><code>null</code></td>
		</tr>
		<tr>
			<td>5</td>
			<td>✅</td>
			<td>balloon panel</td>
			<td>❌</td>
			<td><code>null</code></td>
			<td>✅</td>
			<td>URL input</td>
		</tr>
		<tr>
			<td>6</td>
			<td>✅</td>
			<td>balloon panel</td>
			<td>❌</td>
			<td><code>null</code></td>
			<td>✅</td>
			<td>"Save" button</td>
		</tr>
		<tr>
			<td>7</td>
			<td>✅</td>
			<td>balloon panel</td>
			<td>❌</td>
			<td><code>null</code></td>
			<td>✅</td>
			<td>"Cancel" button</td>
		</tr>
		<tr>
			<td>8</td>
			<td>✅</td>
			<td>editable</td>
			<td>❌</td>
			<td><code>null</code></td>
			<td>❌</td>
			<td><code>null</code></td>
		</tr>
		<tr>
			<td>9</td>
			<td>✅</td>
			<td>editable</td>
			<td>❌</td>
			<td><code>null</code></td>
			<td>❌</td>
			<td><code>null</code></td>
		</tr>
	</tbody>
</table>
<h3 id="conclusions"><a class="headerlink" href="#conclusions">#</a> Conclusions</h3>
<ul>
<li>The <a href="#a-note-about-the-global-focus-tracker">global focus tracker</a> (the one you can access via <code>editor.ui.focusTracker</code>) is always aware of the focus state, even when the focus is in the farthest regions of the UI.
<ul>
<li>It does not know which element is focused on deeper layers (for instance the “Edit link” button), though. All it knows is where the focus went (e.g. from the editable to the balloon panel).</li>
<li>It lacks precise information about the focus in the link UI because this is the responsibility of the focus tracker of the link UI layer.</li>
<li>All editor features <strong>can always depend on the global focus tracker</strong> when necessary. For instance, the main editor toolbar is displayed as long as the global focus tracker knows the focus is somewhere in the editor.</li>
</ul>
</li>
<li>You can see that the focus management is modular: <code>LinkActionsView</code> and <code>LinkFormView</code> only know about the focus as long as one of their children has it.</li>
<li>Focus trackers belonging to <code>LinkActionsView</code> and <code>LinkFormView</code> know precisely which element has focus. This is their region of interest and, unlike the global focus tracker of the editor, they need that information to allow navigation using the keyboard.</li>
</ul>
<style>
.focus-tracking table {
	text-align: center;
}

.focus-tracking table thead th code {
	white-space: nowrap;
}
</style>

          <div class="info-box notice notice__feedback">
            <p>
              Every day, we work hard to keep our documentation complete. Have you spotted outdated information? Is something missing?
              Please report it via our <a href="https://github.com/ckeditor/ckeditor5/issues/new?labels=squad%3Accx%2Ctype%3Adocs&amp;template=7-docs-issue-community.yml&amp;title=Docs+issue+report+from+%22framework%2Fguides%2Fdeep-dive%2Fui%2Ffocus-tracking.html%22&amp;project-version=36.0.1" id="report-widget-issue-tracker">issue tracker</a>.
            </p>
          </div>
          <script>
            ( () => {
                const issueTracker = document.getElementById( 'report-widget-issue-tracker' );
                const hrefUrl = new URL( issueTracker.href );
                hrefUrl.searchParams.set( 'user-agent', navigator.userAgent )
                hrefUrl.searchParams.set( 'origin-url', location.href )
                issueTracker.href = hrefUrl.toString();
            } )();
          </script>
        </div>
      </section>
      <div class="side-navigation">
        <div class="side-navigation__wrapper">
          <nav class="side-navigation__inner">
            <ul class="tree guide-tree">
                          <li><a href="../../../index.html">
                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Overview</span>
                              </div></a></li>
                          <li>
                            <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Guides</span>
                            </div>
                            <ul class="tree__item-nested-list">
                                    <li><a href="../../quick-start.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Quick start</span>
                                        </div></a></li>
                                    <li><a href="../../development-tools.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Development tools</span>
                                        </div></a></li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Architecture</span>
                                      </div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="../../architecture/intro.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Introduction</span>
                                                  </div></a></li>
                                              <li><a href="../../architecture/core-editor-architecture.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Core editor architecture</span>
                                                  </div></a></li>
                                              <li><a href="../../architecture/editing-engine.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Editing engine</span>
                                                  </div></a></li>
                                              <li><a href="../../architecture/ui-library.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">UI library</span>
                                                  </div></a></li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Developing custom plugins</span>
                                      </div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="../../plugins/creating-simple-plugin-timestamp.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Creating a basic plugin</span>
                                                  </div></a></li>
                                              <li>
                                                <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Creating an abbreviation plugin</span>
                                                </div>
                                                <ul class="tree__item-nested-list">
                                                        <li><a href="../../plugins/abbreviation-plugin/abbreviation-plugin-level-1.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Defining a model and a view</span>
                                                            </div></a></li>
                                                        <li><a href="../../plugins/abbreviation-plugin/abbreviation-plugin-level-2.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Getting user input with a custom UI</span>
                                                            </div></a></li>
                                                        <li><a href="../../plugins/abbreviation-plugin/abbreviation-plugin-level-3.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Improving accessibility and adding a command</span>
                                                            </div></a></li>
                                                </ul>
                                              </li>
                                              <li>
                                                <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Package Generator</span>
                                                </div>
                                                <ul class="tree__item-nested-list">
                                                        <li><a href="../../plugins/package-generator/using-package-generator.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Using package generator</span>
                                                            </div></a></li>
                                                        <li><a href="../../plugins/package-generator/javascript-package.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">JavaScript package</span>
                                                            </div></a></li>
                                                        <li><a href="../../plugins/package-generator/typescript-package.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">TypeScript package</span>
                                                            </div></a></li>
                                                </ul>
                                              </li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Advanced tutorials</span>
                                      </div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="../../tutorials/implementing-a-block-widget.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Implementing a block widget</span>
                                                  </div></a></li>
                                              <li><a href="../../tutorials/implementing-an-inline-widget.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Implementing an inline widget</span>
                                                  </div></a></li>
                                              <li><a href="../../tutorials/data-from-external-source.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Data from an external source</span>
                                                  </div></a></li>
                                              <li><a href="../../tutorials/using-react-in-a-widget.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Using a React component in a widget</span>
                                                  </div></a></li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Deep dive</span>
                                      </div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="../clipboard.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Clipboard</span>
                                                  </div></a></li>
                                              <li><a href="../upload-adapter.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Custom upload adapter</span>
                                                  </div></a></li>
                                              <li><a href="../event-system.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Event system</span>
                                                  </div></a></li>
                                              <li><a href="../observables.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Observables</span>
                                                  </div></a></li>
                                              <li><a href="../schema.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Schema</span>
                                                  </div></a></li>
                                              <li>
                                                <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Conversion</span>
                                                </div>
                                                <ul class="tree__item-nested-list">
                                                        <li><a href="../conversion/intro.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Introduction</span>
                                                            </div></a></li>
                                                        <li><a href="../conversion/downcast.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Model to view (downcast)</span>
                                                            </div></a></li>
                                                        <li><a href="../conversion/upcast.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">View to model (upcast)</span>
                                                            </div></a></li>
                                                        <li>
                                                          <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Conversion helpers</span>
                                                          </div>
                                                          <ul class="tree__item-nested-list">
                                                                  <li><a href="../conversion/helpers/intro.html">
                                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Introduction</span>
                                                                      </div></a></li>
                                                                  <li><a href="../conversion/helpers/downcast.html">
                                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Downcast helpers</span>
                                                                      </div></a></li>
                                                                  <li><a href="../conversion/helpers/upcast.html">
                                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Upcast helpers</span>
                                                                      </div></a></li>
                                                          </ul>
                                                        </li>
                                                </ul>
                                              </li>
                                              <li>
                                                <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">User interface</span>
                                                </div>
                                                <ul class="tree__item-nested-list">
                                                        <li><a href="">
                                                            <div class="tree__item__wrapper tree__item__wrapper--active"><span class="tree__item--guide tree__item__text">Focus tracking</span>
                                                            </div></a></li>
                                                        <li><a href="widget-internals.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Widget internals</span>
                                                            </div></a></li>
                                                        <li><a href="theme-customization.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Theme customization</span>
                                                            </div></a></li>
                                                        <li><a href="external-ui.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Third–party UI</span>
                                                            </div></a></li>
                                                        <li><a href="document-editor.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Document editor</span>
                                                            </div></a></li>
                                                        <li><a href="custom-editor-creator.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Creating custom editor</span>
                                                            </div></a></li>
                                                        <li><a href="localization.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Localization</span>
                                                            </div></a></li>
                                                </ul>
                                              </li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Contributing</span>
                                      </div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="../../contributing/contributing.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Contributing</span>
                                                  </div></a></li>
                                              <li><a href="../../contributing/development-environment.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Development environment</span>
                                                  </div></a></li>
                                              <li><a href="../../contributing/testing-environment.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Testing environment</span>
                                                  </div></a></li>
                                              <li><a href="../../contributing/code-style.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Code style</span>
                                                  </div></a></li>
                                              <li><a href="../../contributing/package-metadata.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Package metadata</span>
                                                  </div></a></li>
                                              <li><a href="../../contributing/git-commit-message-convention.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Git commit message convention</span>
                                                  </div></a></li>
                                      </ul>
                                    </li>
                            </ul>
                          </li>
            </ul>
          </nav>
        </div>
      </div>
    </main>
    <footer class="footer footer--bordered">
      <p>&copy; 2003-2023 <a href="http://cksource.com">CKSource</a>. All rights reserved.</p>
    </footer>
    <script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript">
docsearch({
apiKey:'fc463c26455365ad403d5ec51796cd73',indexName:'ckeditor_nightly',inputSelector:'#docsearch_input',algoliaOptions:{hitsPerPage:250,attributesToRetrieve:'*'},
transformData: function( hits ) {var sortingFn = function( a, b ) {a.custom_ranking = a.custom_ranking || 0;b.custom_ranking = b.custom_ranking || 0;if ( a.custom_ranking === b.custom_ranking ) return a.index - b.index;if ( a.custom_ranking > b.custom_ranking ) return -1;if ( a.custom_ranking < b.custom_ranking ) return 1;};var result = [];var tags = [ 'installation', 'features', 'examples', 'updating', 'support', 'framework', 'api' ];var hitsGrouped = { api: [] };hitsGrouped[ 'framework' ] = hits.filter( function( h ) {return h.tags.includes( 'ckeditor5' ) && h.tags.includes( 'framework' );} ).slice( 0, 7 ).map( function( item, idx ) {item.index = idx;return item;} ).sort( sortingFn );tags.forEach( function( tag ) {if ( tag !== 'framework' ) {hitsGrouped[ tag ] = hits.filter( function( h ) {return h.tags.includes( 'ckeditor5' ) && h.tags.includes( tag );} ).slice( 0, 10 ).map( function( item, idx ) {item.index = idx;return item;} ).sort( sortingFn ).slice( 0, 3 );}} );var apiSearchHits = [];if ( window.apiSearch ) apiSearchHits = window.apiSearch();hitsGrouped.api = hitsGrouped.api.filter( function( h ) {var isDuplicated = false;for ( var i = 0; i < apiSearchHits.length; i++ ) {if ( h.url.includes( apiSearchHits[ i ].urlShort ) ) {isDuplicated = true;break;}}return !isDuplicated;} );hitsGrouped.api = ( apiSearchHits || [] ).concat( hitsGrouped.api );result = result.concat( hitsGrouped[ 'framework' ] );tags.forEach( function( tag ) {if ( tag !== 'framework' ) result = result.concat( hitsGrouped[ tag ].slice( 0, 4 ) );} );return result;}
});
</script>
    <script src="../../../../../../assets/2.4.0/scripts/app.js"></script>
    <script src="../../../../assets/buildwarningbanner.js" async></script>
  </body>
</html>