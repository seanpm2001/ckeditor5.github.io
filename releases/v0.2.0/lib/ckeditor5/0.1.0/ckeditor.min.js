var ClassicEditor=function(){"use strict";function t(){return function t(){t.called=!0}}function e(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function n(){return{callbacks:[],childEvents:[]}}function r(t,r){var i=e(t);if(!i[r]){for(var o=r,a=null,s=[];""!==o&&!i[o];)i[o]=n(),s.push(i[o]),a&&i[o].childEvents.push(a),a=o,o=o.substr(0,o.lastIndexOf(":"));if(""!==o){var u=!0,l=!1,c=void 0;try{for(var f,h=s[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var d=f.value;d.callbacks=i[o].callbacks.slice()}}catch(v){l=!0,c=v}finally{try{!u&&h["return"]&&h["return"]()}finally{if(l)throw c}}i[o].childEvents.push(a)}}}function i(t,n){var r=e(t)[n];if(!r)return[];for(var o=[r.callbacks],a=0;a<r.childEvents.length;a++){var s=i(t,r.childEvents[a]);o=o.concat(s)}return o}function o(t,e){var n=void 0;return t._events&&(n=t._events[e])&&n.callbacks.length?n.callbacks:e.indexOf(":")>-1?o(t,e.substr(0,e.lastIndexOf(":"))):null}function a(t){return Ro(Object(t))}function s(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(n){}return e}function u(t){return!!t&&"object"==("undefined"==typeof t?"undefined":bo(t))}function l(t){if(!u(t)||Do.call(t)!=jo||s(t))return!1;var e=a(t);if(null===e)return!0;var n=Vo.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Fo.call(n)==No}function c(t,e){return t===e||t!==t&&e!==e}function f(t,e,n){var r=t[e];zo.call(t,e)&&c(r,n)&&(void 0!==n||e in t)||(t[e]=n)}function h(t,e,n,r){n||(n={});for(var i=-1,o=e.length;++i<o;){var a=e[i],s=r?r(n[a],t[a],a,n,t):t[a];f(n,a,s)}return n}function d(t){return function(e){return null==e?void 0:e[t]}}function v(t){var e="undefined"==typeof t?"undefined":bo(t);return!!t&&("object"==e||"function"==e)}function y(t){var e=v(t)?$o.call(t):"";return e==Ho||e==Wo}function g(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Jo}function p(t){return null!=t&&g(qo(t))&&!y(t)}function m(t,e){return e=null==e?Uo:e,!!e&&("number"==typeof t||Xo.test(t))&&t>-1&&t%1==0&&t<e}function b(t,e,n){if(!v(n))return!1;var r="undefined"==typeof e?"undefined":bo(e);return!!("number"==r?p(n)&&m(e,n.length):"string"==r&&e in n)&&c(n[e],t)}function w(t,e,n){var r=n.length;switch(r){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function _(t){return"symbol"==("undefined"==typeof t?"undefined":bo(t))||u(t)&&Qo.call(t)==Yo}function k(t){if("number"==typeof t)return t;if(_(t))return Zo;if(v(t)){var e=y(t.valueOf)?t.valueOf():t;t=v(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(ta,"");var n=na.test(t);return n||ra.test(t)?ia(t.slice(2),n?2:8):ea.test(t)?Zo:+t}function x(t){if(!t)return 0===t?t:0;if(t=k(t),t===oa||t===-oa){var e=t<0?-1:1;return e*aa}return t===t?t:0}function O(t){var e=x(t),n=e%1;return e===e?n?e-n:e:0}function P(t,e){if("function"!=typeof t)throw new TypeError(sa);return e=ua(void 0===e?t.length-1:O(e),0),function(){for(var n=arguments,r=-1,i=ua(n.length-e,0),o=Array(i);++r<i;)o[r]=n[e+r];switch(e){case 0:return t.call(this,o);case 1:return t.call(this,n[0],o);case 2:return t.call(this,n[0],n[1],o)}var a=Array(e+1);for(r=-1;++r<e;)a[r]=n[r];return a[e]=o,w(t,this,a)}}function S(t){return P(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,a&&b(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),e=Object(e);++r<i;){var s=n[r];s&&t(e,s,r,o)}return e})}function A(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||la;return t===n}function C(t){return t&&t.Object===Object?t:null}function E(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function T(t){t=null==t?t:Object(t);var e=[];for(var n in t)e.push(n);return e}function R(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function j(t){return u(t)&&p(t)}function M(t){return j(t)&&Pa.call(t,"callee")&&(!Aa.call(t,"callee")||Sa.call(t)==xa)}function F(t){return"string"==typeof t||!Ca(t)&&u(t)&&Ra.call(t)==Ea}function V(t){var e=t?t.length:void 0;return g(e)&&(Ca(t)||F(t)||M(t))?R(e,String):null}function N(t){for(var e=-1,n=A(t),r=ka(t),i=r.length,o=V(t),a=!!o,s=o||[],u=s.length;++e<i;){var l=r[e];a&&("length"==l||m(l,u))||"constructor"==l&&(n||!Ma.call(t,l))||s.push(l)}return s}function D(t){Ia in t||(Object.defineProperty(t,Ia,{value:new Map}),Object.defineProperty(t,Ba,{value:new Map}),Object.defineProperty(t,La,{value:new Map}))}function I(){var t=this,e=L.apply(void 0,arguments),n=Array.from(this._bindings.keys()),r=n.length;if(!e.callback&&e.to.length>1)throw new Bo("observable-bind-to-no-callback: Binding multiple observables only possible with callback.");if(r>1&&e.callback)throw new Bo("observable-bind-to-extra-callback: Cannot bind multiple attributes and use a callback in one binding.");e.to.forEach(function(e){if(e.attrs.length&&e.attrs.length!==r)throw new Bo("observable-bind-to-attrs-length: The number of attributes must match.");e.attrs.length||(e.attrs=t._bindAttrs)}),this._to=e.to,e.callback&&(this._bindings.get(n[0]).callback=e.callback),W(this._observable,this._to),q(this),this._bindAttrs.forEach(function(e){H(t._observable,e)})}function B(t){return t.every(function(t){return"string"==typeof t})}function L(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(!e.length)throw new Bo("observable-bind-to-parse-error: Invalid argument syntax in `to()`.");var r={to:[]},i=void 0;return"function"==typeof e[e.length-1]&&(r.callback=e.pop()),e.forEach(function(t){if("string"==typeof t)i.attrs.push(t);else{if("object"!=("undefined"==typeof t?"undefined":bo(t)))throw new Bo("observable-bind-to-parse-error: Invalid argument syntax in `to()`.");i={observable:t,attrs:[]},r.to.push(i)}}),r}function z(t,e,n,r){var i=t[Ba],o=i.get(n),a=o||{};a[r]||(a[r]=new Set),a[r].add(e),o||i.set(n,a)}function q(t){var e=void 0;t._bindings.forEach(function(n,r){t._to.forEach(function(i){e=i.attrs[n.callback?0:t._bindAttrs.indexOf(r)],n.to.push([i.observable,e]),z(t._observable,n,i.observable,e)})})}function H(t,e){var n=t[La],r=n.get(e),i=void 0;r.callback?i=r.callback.apply(t,r.to.map(function(t){return t[0][t[1]]})):(i=r.to[0],i=i[0][i[1]]),t.hasOwnProperty(e)?t[e]=i:t.set(e,i)}function W(t,e){e.forEach(function(e){var n=t[Ba],r=void 0;n.get(e.observable)||t.listenTo(e.observable,"change",function(i,o){r=n.get(e.observable)[o],r&&r.forEach(function(e){H(t,e.attr)})})})}function K(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];n.forEach(function(e){Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(function(n){if(!(n in t.prototype)){var r=Object.getOwnPropertyDescriptor(e,n);r.enumerable=!1,Object.defineProperty(t.prototype,n,r)}})})}function $(t){return t="../"+t,System["import"](t).then(function(t){return t})}function J(t){var e=new Map;for(var n in t)e.set(n,t[n]);return e}function U(t){return l(t)?J(t):new Map(t)}function X(t,e,n,r,i){return{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:r,length:i}}}function Y(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++)if(t[r]!=e[r])return r;return t.length==e.length?"SAME":t.length<e.length?"PREFIX":"EXTENSION"}function G(t,e){if(t.size!=e.size)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=t.entries()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=JSON.stringify(s[1]),l=JSON.stringify(e.get(s[0]));if(u!==l)return!1}}catch(c){r=!0,i=c}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return!0}function Q(t){return!(!t||!t[Symbol.iterator])}function Z(t){var e,n,r,i,o,a;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e=!0,n=!1,r=void 0,s.prev=3,i=t[Symbol.iterator]();case 5:if(e=(o=i.next()).done){s.next=16;break}if(a=o.value,!(a instanceof ns)){s.next=11;break}return s.delegateYield(a,"t0",9);case 9:s.next=13;break;case 11:return s.next=13,a;case 13:e=!0,s.next=5;break;case 16:s.next=22;break;case 18:s.prev=18,s.t1=s["catch"](3),n=!0,r=s.t1;case 22:s.prev=22,s.prev=23,!e&&i["return"]&&i["return"]();case 25:if(s.prev=25,!n){s.next=28;break}throw r;case 28:return s.finish(25);case 29:return s.finish(22);case 30:case"end":return s.stop()}},Za[0],this,[[3,18,22,30],[23,,25,29]])}function tt(t){var e=t?t.length:0;return e?t[e-1]:void 0}function et(t,e){var n=/\s*([^:;\s]+)\s*:\s*([^;]+)\s*(?=;|$)/g,r=void 0;for(t.clear();null!==(r=n.exec(e));)t.set(r[1],r[2].trim())}function nt(t,e){var n=e.split(/\s+/);t.clear(),n.forEach(function(e){return t.add(e)})}function rt(t){return function(e,n,r,i){r.consume(n.item,"insert");var o=i.mapper.toViewPosition(n.range.start),a=t instanceof ss?t.clone(!0):t(n,r,i);i.mapper.bindElements(n.item,a),i.writer.insert(o,a),e.stop()}}function it(){return function(t,e,n,r){n.consume(e.item,"insert");var i=r.mapper.toViewPosition(e.range.start),o=new os(e.item.text);r.writer.insert(i,o),t.stop()}}function ot(t){return t=t||function(t,e){return{value:t,key:e}},function(e,n,r,i){var o=t(n.attributeNewValue,n.attributeKey,n,r,i),a=o.key,s=o.value;r.consume(n.item,ft(e.name)),i.mapper.toViewElement(n.item).setAttribute(a,s),e.stop()}}function at(t){return t=t||function(t,e){return{key:e}},function(e,n,r,i){var o=t(n.attributeOldValue,n.attributeKey,n,r,i),a=o.key;r.consume(n.item,ft(e.name)),i.mapper.toViewElement(n.item).removeAttribute(a),e.stop()}}function st(t){return function(e,n,r,i){r.consume(n.item,ft(e.name));var o=i.mapper.toViewRange(n.range),a=t instanceof ss?t.clone(!0):t(n.attributeNewValue,n,r,i);if(null!==n.attributeOldValue&&!(t instanceof ss)){var s=t(n.attributeOldValue,n,r,i);o=i.writer.unwrap(o,s,e.priority)}i.writer.wrap(o,a,e.priority),e.stop()}}function ut(t){return function(e,n,r,i){r.consume(n.item,ft(e.name));var o=i.mapper.toViewRange(n.range),a=t instanceof ss?t.clone(!0):t(n.attributeOldValue,n,r,i);i.writer.unwrap(o,a),e.stop()}}function lt(){return function(t,e,n){var r=new Ya({boundaries:e.range,shallow:!0}),i=0,o=!0,a=!1,s=void 0;try{for(var u,l=r[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;i+=c.length}}catch(f){a=!0,s=f}finally{try{!o&&l["return"]&&l["return"]()}finally{if(a)throw s}}var h=Ga.createFromPositionAndShift(e.sourcePosition,i),d=n.mapper.toViewRange(h),v=n.mapper.toViewPosition(e.range.start);n.writer.move(d,v)}}function ct(){return function(t,e,n){var r=new Ya({boundaries:e.range,shallow:!0}),i=0,o=!0,a=!1,s=void 0;try{for(var u,l=r[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;i+=c.length}}catch(f){a=!0,s=f}finally{try{!o&&l["return"]&&l["return"]()}finally{if(a)throw s}}var h=Ga.createFromPositionAndShift(e.sourcePosition,i),d=n.mapper.toViewRange(h);n.writer.remove(d)}}function ft(t){var e=t.split(":");return e[0]+":"+e[1]}function ht(){return function(t,e,n,r){if(!e.output&&n.test(e.input,{name:!0})){var i=r.convertChildren(e.input,n,e);e.output=new ns(i)}}}function dt(){return function(t,e,n,r){var i={name:"$text",inside:e.context};r.schema.check(i)&&n.consume(e.input)&&(e.output=new Ua(e.input.data))}}function vt(t,e,n,r,i){for(var o=n,a=[];o<r;){var s=e.getChild(o);if(s.isSimilar(i)){var u=s.getChildren(),l=s.getChildCount();s.remove(),e.insertChildren(o,u),a.push(new cs(e,o),new cs(e,o+l)),o+=l,r+=l-1}else s instanceof ws&&vt(t,s,0,s.getChildCount(),i),o++}var c=0,f=!0,h=!1,d=void 0;try{for(var v,y=a[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value;if(g.offset-=c,g.offset!=n&&g.offset!=r){var p=t.mergeAttributes(g);p.isEqual(g)||(c++,r--)}}}catch(m){h=!0,d=m}finally{try{!f&&y["return"]&&y["return"]()}finally{if(h)throw d}}return fs.createFromParentsAndOffsets(e,n,e,r)}function yt(t,e,n,r,i){for(var o=n,a=[];o<r;){var s=e.getChild(o),u=s instanceof os,l=s instanceof ws;if(u||l&&i.priority<=s.priority){var c=i.clone();s.remove(),c.appendChildren(s),e.insertChildren(o,c),a.push(new cs(e,o))}else s instanceof ws&&yt(t,s,0,s.getChildCount(),i);o++}var f=0,h=!0,d=!1,v=void 0;try{for(var y,g=a[Symbol.iterator]();!(h=(y=g.next()).done);h=!0){var p=y.value;if(p.offset!=n){var m=t.mergeAttributes(p);m.isEqual(p)||(f++,r--)}}}catch(b){d=!0,v=b}finally{try{!h&&g["return"]&&g["return"]()}finally{if(d)throw v}}return fs.createFromParentsAndOffsets(e,n,e,r)}function gt(t){var e=t.nodeBefore;if(e&&e instanceof os)return new cs(e,e.data.length);var n=t.nodeAfter;return n&&n instanceof os?new cs(n,0):t}function pt(t){if(t.offset==t.parent.data.length)return new cs(t.parent.parent,t.parent.getIndex()+1);if(0===t.offset)return new cs(t.parent.parent,t.parent.getIndex());var e=t.parent.data.slice(t.offset);return t.parent.data=t.parent.data.slice(0,t.offset),t.parent.parent.insertChildren(t.parent.getIndex()+1,new os(e)),new cs(t.parent.parent,t.parent.getIndex()+1)}function mt(t,e){var n=t.data.length;return t.data+=e.data,e.remove(),new cs(t,n)}function bt(t,e){if(t.name!==e.name||t.priority!==e.priority)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=t.getAttributeKeys()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if("class"!==s&&"style"!==s&&e.hasAttribute(s)&&e.getAttribute(s)!==t.getAttribute(s))return!1}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}var l=!0,c=!1,f=void 0;try{for(var h,d=t.getStyleNames()[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var v=h.value;if(e.hasStyle(v)&&e.getStyle(v)!==t.getStyle(v))return!1}}catch(u){c=!0,f=u}finally{try{!l&&d["return"]&&d["return"]()}finally{if(c)throw f}}var y=!0,g=!1,p=void 0;try{for(var m,b=t.getAttributeKeys()[Symbol.iterator]();!(y=(m=b.next()).done);y=!0){var w=m.value;"class"!==w&&"style"!==w&&(e.hasAttribute(w)||e.setAttribute(w,t.getAttribute(w)))}}catch(u){g=!0,p=u}finally{try{!y&&b["return"]&&b["return"]()}finally{if(g)throw p}}var _=!0,k=!1,x=void 0;try{for(var O,P=t.getStyleNames()[Symbol.iterator]();!(_=(O=P.next()).done);_=!0){var S=O.value;e.hasStyle(S)||e.setStyle(S,t.getStyle(S))}}catch(u){k=!0,x=u}finally{try{!_&&P["return"]&&P["return"]()}finally{if(k)throw x}}var A=!0,C=!1,E=void 0;try{for(var T,R=t.getClassNames()[Symbol.iterator]();!(A=(T=R.next()).done);A=!0){var j=T.value;e.hasClass(j)||e.addClass(j)}}catch(u){C=!0,E=u}finally{try{!A&&R["return"]&&R["return"]()}finally{if(C)throw E}}return!0}function wt(t,e){if(t.name!==e.name||t.priority!==e.priority)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=t.getAttributeKeys()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if("class"!==s&&"style"!==s&&(!e.hasAttribute(s)||e.getAttribute(s)!==t.getAttribute(s)))return!1}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}if(!e.hasClass.apply(e,So(t.getClassNames())))return!1;var l=!0,c=!1,f=void 0;try{for(var h,d=t.getStyleNames()[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var v=h.value;if(!e.hasStyle(v)||e.getStyle(v)!==t.getStyle(v))return!1}}catch(u){c=!0,f=u}finally{try{!l&&d["return"]&&d["return"]()}finally{if(c)throw f}}var y=!0,g=!1,p=void 0;try{for(var m,b=t.getAttributeKeys()[Symbol.iterator]();!(y=(m=b.next()).done);y=!0){var w=m.value;"class"!==w&&"style"!==w&&e.removeAttribute(w)}}catch(u){g=!0,p=u}finally{try{!y&&b["return"]&&b["return"]()}finally{if(g)throw p}}return e.removeClass.apply(e,So(t.getClassNames())),e.removeStyle.apply(e,So(t.getStyleNames())),!0}function _t(t){return t.start.parent==t.end.parent&&t.start.parent instanceof ws&&0===t.start.offset&&t.end.offset===t.start.parent.getChildCount()}function kt(t){var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;if(!(a instanceof os||a instanceof ws||a instanceof us))throw new Bo("view-writer-insert-invalid-node");a instanceof os||kt(a.getChildren())}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}}function xt(t){return t instanceof us||t instanceof ys}function Ot(t){var e=void 0;if("string"==typeof t){if(e=xs[t.toLowerCase()],!e)throw new Bo("keyboard-unknown-key: Unknown key name.",{key:t})}else e=t.keyCode+(t.altKey?xs.alt:0)+(t.ctrlKey?xs.ctrl:0)+(t.shiftKey?xs.shift:0);return e}function Pt(t){return"string"==typeof t&&(t=t.split(/\s*\+\s*/)),t.map(function(t){return"string"==typeof t?Ot(t):t}).reduce(function(t,e){return e+t},0)}function St(){for(var t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,"delete":46,enter:13,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448},e=65;e<=90;e++){var n=String.fromCharCode(e);t[n.toLowerCase()]=e}for(var r=48;r<=57;r++)t[r-48]=r;return t}function At(t){return t instanceof Text&&t.data.substr(0,Ss)===As}function Ct(t){return t.data.length==Ss&&At(t)}function Et(t){return At(t)?t.data.slice(Ss):t.data}function Tt(t,e){var n=Es.get(e);return n||(n=e(window.document),Es.set(e,n)),t.isEqualNode(n)}function Rt(t){t.on("keydown",jt)}function jt(t,e){if(e.keyCode==xs.arrowleft){var n=e.domTarget.ownerDocument.defaultView.getSelection();if(1==n.rangeCount&&n.getRangeAt(0).collapsed){var r=n.getRangeAt(0).startContainer,i=n.getRangeAt(0).startOffset;if(At(r)&&i<=Ss){var o=new Range;o.setStart(r,0),o.collapse(!0),n.removeAllRanges(),n.addRange(o)}}}}function Mt(t){for(var e=0;t.previousSibling;)t=t.previousSibling,e++;return e}function Ft(){this.__data__=[]}function Vt(t,e){for(var n=t.length;n--;)if(c(t[n][0],e))return n;return-1}function Nt(t){var e=this.__data__,n=Vt(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():Ms.call(e,n,1),!0}function Dt(t){var e=this.__data__,n=Vt(e,t);return n<0?void 0:e[n][1]}function It(t){return Vt(this.__data__,t)>-1}function Bt(t,e){var n=this.__data__,r=Vt(n,t);return r<0?n.push([t,e]):n[r][1]=e,this}function Lt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function zt(){this.__data__=new Lt}function qt(t){return this.__data__["delete"](t)}function Ht(t){return this.__data__.get(t)}function Wt(t){return this.__data__.has(t)}function Kt(t){if(null!=t){try{return Fs.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function $t(t){if(!v(t))return!1;var e=y(t)||s(t)?Ls:Ns;return e.test(Kt(t))}function Jt(t,e){var n=t[e];return $t(n)?n:void 0}function Ut(){this.__data__=zs?zs(null):{}}function Xt(t){return this.has(t)&&delete this.__data__[t]}function Yt(t){var e=this.__data__;if(zs){var n=e[t];return n===qs?void 0:n}return Ws.call(e,t)?e[t]:void 0}function Gt(t){var e=this.__data__;return zs?void 0!==e[t]:$s.call(e,t)}function Qt(t,e){var n=this.__data__;return n[t]=zs&&void 0===e?Js:e,this}function Zt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function te(){this.__data__={hash:new Zt,map:new(Us||Lt),string:new Zt}}function ee(t){var e="undefined"==typeof t?"undefined":bo(t);return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function ne(t,e){var n=t.__data__;return ee(e)?n["string"==typeof e?"string":"hash"]:n.map}function re(t){return ne(this,t)["delete"](t)}function ie(t){return ne(this,t).get(t)}function oe(t){return ne(this,t).has(t)}function ae(t,e){return ne(this,t).set(t,e),this}function se(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function ue(t,e){var n=this.__data__;return n instanceof Lt&&n.__data__.length==Xs&&(n=this.__data__=new se(n.__data__)),n.set(t,e),this}function le(t){this.__data__=new Lt(t)}function ce(t,e){for(var n=-1,r=t.length;++n<r&&e(t[n],n,t)!==!1;);return t}function fe(t,e){return Gs.call(t,e)||"object"==("undefined"==typeof t?"undefined":bo(t))&&e in t&&null===a(t)}function he(t){return Qs(Object(t))}function de(t){var e=A(t);if(!e&&!p(t))return he(t);var n=V(t),r=!!n,i=n||[],o=i.length;for(var a in t)!fe(t,a)||r&&("length"==a||m(a,o))||e&&"constructor"==a||i.push(a);return i}function ve(t,e){return t&&h(e,de(e),t)}function ye(t,e){if(e)return t.slice();var n=new t.constructor(t.length);return t.copy(n),n}function ge(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}function pe(t){return Zs(Object(t))}function me(t,e){return h(t,tu(t),e)}function be(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function we(t,e,n){var r=e(t);return Ca(t)?r:be(r,n(t))}function _e(t){return we(t,de,tu)}function ke(t){return hu.call(t)}function xe(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&wu.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Oe(t){var e=new t.constructor(t.byteLength);return new _u(e).set(new _u(t)),e}function Pe(t,e){var n=e?Oe(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}function Se(t,e){return t.set(e[0],e[1]),t}function Ae(t,e,n,r){var i=-1,o=t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function Ce(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function Ee(t,e,n){var r=e?n(Ce(t),!0):Ce(t);return Ae(r,Se,new t.constructor)}function Te(t){var e=new t.constructor(t.source,ku.exec(t));return e.lastIndex=t.lastIndex,e}function Re(t,e){return t.add(e),t}function je(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function Me(t,e,n){var r=e?n(je(t),!0):je(t);return Ae(r,Re,new t.constructor)}function Fe(t){return Pu?Object(Pu.call(t)):{}}function Ve(t,e){var n=e?Oe(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Ne(t,e,n,r){var i=t.constructor;switch(e){case Fu:return Oe(t);case Su:case Au:return new i((+t));case Vu:return Pe(t,r);case Nu:case Du:case Iu:case Bu:case Lu:case zu:case qu:case Hu:case Wu:return Ve(t,r);case Cu:return Ee(t,r,n);case Eu:case ju:return new i(t);case Tu:return Te(t);case Ru:return Me(t,r,n);case Mu:return Fe(t)}}function De(t){return v(t)?Ku(t):{}}function Ie(t){return"function"!=typeof t.constructor||A(t)?{}:De(a(t))}function Be(t){return function(){return t}}function Le(t,e,n,r,i,o,a){var u;if(r&&(u=o?r(t,i,o,a):r(t)),void 0!==u)return u;if(!v(t))return t;var l=Ca(t);if(l){if(u=xe(t),!e)return ge(t,u)}else{var c=mu(t),h=c==rl||c==il;if(Gu(t))return ye(t,e);if(c==sl||c==Qu||h&&!o){if(s(t))return o?t:{};if(u=Ie(h?{}:t),!e)return me(t,ve(u,t))}else{if(!Ol[c])return o?t:{};u=Ne(t,c,Le,e)}}a||(a=new le);var d=a.get(t);if(d)return d;if(a.set(t,u),!l)var y=n?_e(t):de(t);return ce(y||t,function(i,o){y&&(o=i,i=t[o]),f(u,o,Le(i,e,n,r,o,t,a))}),u}function ze(t){return Le(t,!1,!0)}function qe(t,e){if(Il.prototype[t])throw new Bo("batch-register-taken: This batch method name is already taken.",{name:t});Il.prototype[t]=e}function He(t,e,n,r){r instanceof Ga?Ke(t,t.doc,e,n,r):We(t,t.doc,e,n,r)}function We(t,e,n,r,i){var o=i.getAttribute(n),a=void 0,s=void 0,u=i instanceof Bl?new zl:new Ll;t.addDelta(u),o!=r&&(i instanceof Bl?s=new jl(i,n,o,r,e.version):(a=i instanceof Qa?new Ga(rs.createBefore(i),rs.createFromParentAndOffset(i,0)):new Ga(rs.createBefore(i),rs.createAfter(i)),s=new Sl(a,n,o||null,r||null,e.version)),u.addOperation(s),e.applyOperation(s))}function Ke(t,e,n,r,i){function o(){var t=new Ga(s,u),i=new Sl(t,n,l||null,r||null,e.version);a.addOperation(i),e.applyOperation(i)}var a=new Ll;t.addDelta(a);var s=i.start,u=void 0,l=void 0,c=void 0,f=!0,h=!1,d=void 0;try{for(var v,y=i[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value;c=g.item.getAttribute(n),u&&l!=c&&(l!=r&&o(),s=u),u=g.nextPosition,l=c}}catch(p){h=!0,d=p}finally{try{!f&&y["return"]&&y["return"]()}finally{if(h)throw d}}u instanceof rs&&u!=s&&l!=r&&o()}function $e(t,e,n,r,i){var o=new Al(n,r,i,t.doc.version);e.addOperation(o),t.doc.applyOperation(o)}function Je(t,e,n,r){var i=new El(n,r,t.doc.version);e.addOperation(i),t.doc.applyOperation(i)}function Ue(t,e,n){t.addDelta(e),e.addOperation(n),t.doc.applyOperation(n)}function Xe(t){return this.__data__.set(t,Gl),this}function Ye(t){return this.__data__.has(t)}function Ge(t){var e=-1,n=t?t.length:0;for(this.__data__=new se;++e<n;)this.add(t[e])}function Qe(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function Ze(t,e,n,r,i,o){var a=i&Zl,s=t.length,u=e.length;if(s!=u&&!(a&&u>s))return!1;var l=o.get(t);if(l)return l==e;var c=-1,f=!0,h=i&Ql?new Ge:void 0;for(o.set(t,e);++c<s;){var d=t[c],v=e[c];if(r)var y=a?r(v,d,c,e,t,o):r(d,v,c,t,e,o);if(void 0!==y){if(y)continue;f=!1;break}if(h){if(!Qe(e,function(t,e){if(!h.has(e)&&(d===t||n(d,t,r,i,o)))return h.add(e)})){f=!1;break}}else if(d!==v&&!n(d,v,r,i,o)){f=!1;break}}return o["delete"](t),f}function tn(t,e,n,r,i,o,a){switch(n){case hc:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case fc:return!(t.byteLength!=e.byteLength||!r(new _u(t),new _u(e)));case nc:case rc:return+t==+e;case ic:return t.name==e.name&&t.message==e.message;case ac:return t!=+t?e!=+e:t==+e;case sc:case lc:return t==e+"";case oc:var s=Ce;case uc:var u=o&ec;if(s||(s=je),t.size!=e.size&&!u)return!1;var l=a.get(t);return l?l==e:(o|=tc,a.set(t,e),Ze(s(t),s(e),r,i,o,a));case cc:if(vc)return vc.call(t)==vc.call(e)}return!1}function en(t,e,n,r,i,o){var a=i&yc,s=de(t),u=s.length,l=de(e),c=l.length;if(u!=c&&!a)return!1;for(var f=u;f--;){var h=s[f];if(!(a?h in e:fe(e,h)))return!1}var d=o.get(t);if(d)return d==e;var v=!0;o.set(t,e);for(var y=a;++f<u;){h=s[f];var g=t[h],p=e[h];if(r)var m=a?r(p,g,h,e,t,o):r(g,p,h,t,e,o);if(!(void 0===m?g===p||n(g,p,r,i,o):m)){v=!1;break}y||(y="constructor"==h)}if(v&&!y){var b=t.constructor,w=e.constructor;b!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(v=!1)}return o["delete"](t),v}function nn(t){return u(t)&&g(t.length)&&!!Lc[qc.call(t)]}function rn(t,e,n,r,i,o){var a=Ca(t),u=Ca(e),l=Kc,c=Kc;a||(l=mu(t),l=l==Wc?$c:l),u||(c=mu(e),c=c==Wc?$c:c);var f=l==$c&&!s(t),h=c==$c&&!s(e),d=l==c;if(d&&!f)return o||(o=new le),a||nn(t)?Ze(t,e,n,r,i,o):tn(t,e,l,n,r,i,o);if(!(i&Hc)){var v=f&&Uc.call(t,"__wrapped__"),y=h&&Uc.call(e,"__wrapped__");if(v||y){var g=v?t.value():t,p=y?e.value():e;return o||(o=new le),n(g,p,r,i,o)}}return!!d&&(o||(o=new le),en(t,e,n,r,i,o))}function on(t,e,n,r,i){return t===e||(null==t||null==e||!v(t)&&!u(e)?t!==t&&e!==e:rn(t,e,on,n,r,i))}function an(t,e){return on(t,e)}function sn(t,e,n){var r=void 0,i=void 0;t instanceof Tl?r=Xc.InsertOperation:t instanceof Sl?r=Xc.AttributeOperation:t instanceof jl?r=Xc.RootAttributeOperation:t instanceof Al?r=Xc.MoveOperation:i=un,r&&(i=e instanceof Tl?r.InsertOperation:e instanceof Sl?r.AttributeOperation:e instanceof jl?r.RootAttributeOperation:e instanceof Al?r.MoveOperation:un);var o=i(t,e,n);return ln(t.baseVersion,o)}function un(t){return[t.clone()]}function ln(t,e){for(var n=0;n<e.length;n++)e[n].baseVersion=t+n+1;return e}function cn(t,e){return null===t.targetPosition.getTransformedByDeletion(e.sourcePosition,e.howMany)}function fn(t){return 0===t.length?null:1==t.length?t[0]:(t[0].end=t[t.length-1].end,t[0])}function hn(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=Array(i);++r<i;)o[r]=t[r+e];return o}function dn(t,e,n){e=(n?b(t,e,n):void 0===e)?1:Gc(O(e),0);var r=t?t.length:0;if(!r||e<1)return[];for(var i=0,o=0,a=Array(Yc(r/e));i<r;)a[o++]=hn(t,i,i+=e);return a}function vn(t){for(var e=-1,n=t?t.length:0,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i}function yn(t){return Ca(t)||M(t)}function gn(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=yn),i||(i=[]);++o<a;){var s=t[o];e>0&&n(s)?e>1?gn(s,e-1,n,r,i):be(i,s):r||(i[i.length]=s)}return i}function pn(){for(var t=arguments.length,e=Array(t?t-1:0),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return t?be(Ca(n)?ge(n):[n],gn(e,1)):[]}function mn(t,e,n){for(var r=t.length,i=e+(n?0:-1);n?i--:++i<r;){var o=t[i];if(o!==o)return i}return-1}function bn(t,e,n){if(e!==e)return mn(t,n);for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function wn(t,e){return!!t.length&&bn(t,e,0)>-1}function _n(t,e,n){for(var r=-1,i=t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function kn(t,e){for(var n=-1,r=t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function xn(t){return function(e){return t(e)}}function On(t,e){return t.has(e)}function Pn(t,e,n,r){var i=-1,o=wn,a=!0,s=t.length,u=[],l=e.length;if(!s)return u;n&&(e=kn(e,xn(n))),r?(o=_n,a=!1):e.length>=Qc&&(o=On,a=!1,e=new Ge(e));t:for(;++i<s;){var c=t[i],f=n?n(c):c;if(c=r||0!==c?c:0,a&&f===f){for(var h=l;h--;)if(e[h]===f)continue t;u.push(c)}else o(e,f,r)||u.push(c)}return u}function Sn(t,e,n,r){var i=n.length,o=i,a=!r;if(null==t)return!o;for(t=Object(t);i--;){var s=n[i];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<o;){s=n[i];var u=s[0],l=t[u],c=s[1];if(a&&s[2]){if(void 0===l&&!(u in t))return!1}else{var f=new le;if(r)var h=r(l,c,u,t,e,f);if(!(void 0===h?on(c,l,r,tf|ef,f):h))return!1}}return!0}function An(t){return t===t&&!v(t)}function Cn(t,e){return kn(e,function(e){return[e,t[e]]})}function En(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function Tn(t){return function(e){var n=mu(e);return n==nf?Ce(e):n==rf?En(e):Cn(e,t(e))}}function Rn(t){for(var e=of(t),n=e.length;n--;)e[n][2]=An(e[n][1]);return e}function jn(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}function Mn(t){var e=Rn(t);return 1==e.length&&e[0][2]?jn(e[0][0],e[0][1]):function(n){return n===t||Sn(n,t,e)}}function Fn(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(af);var n=function r(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=t.apply(this,n);return r.cache=o.set(i,a),a};return n.cache=new(Fn.Cache||se),n}function Vn(t){if("string"==typeof t)return t;if(_(t))return lf?lf.call(t):"";var e=t+"";return"0"==e&&1/t==-sf?"-0":e}function Nn(t){return null==t?"":Vn(t)}function Dn(t){return Ca(t)?t:hf(t)}function In(t,e){if(Ca(t))return!1;var n="undefined"==typeof t?"undefined":bo(t);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!_(t))||(vf.test(t)||!df.test(t)||null!=e&&t in Object(e))}function Bn(t){if("string"==typeof t||_(t))return t;var e=t+"";return"0"==e&&1/t==-yf?"-0":e}function Ln(t,e){e=In(e,t)?[e]:Dn(e);for(var n=0,r=e.length;null!=t&&n<r;)t=t[Bn(e[n++])];return n&&n==r?t:void 0}function zn(t,e,n){var r=null==t?void 0:Ln(t,e);return void 0===r?n:r}function qn(t,e){return e in Object(t)}function Hn(t,e,n){e=In(e,t)?[e]:Dn(e);for(var r,i=-1,o=e.length;++i<o;){var a=Bn(e[i]);if(!(r=null!=t&&n(t,a)))break;t=t[a]}if(r)return r;var o=t?t.length:0;return!!o&&g(o)&&m(a,o)&&(Ca(t)||F(t)||M(t))}function Wn(t,e){return null!=t&&Hn(t,e,qn)}function Kn(t,e){return In(t)&&An(e)?jn(Bn(t),e):function(n){var r=zn(n,t);return void 0===r&&r===e?Wn(n,t):on(e,r,void 0,gf|pf)}}function $n(t){return t}function Jn(t){return function(e){return Ln(e,t)}}function Un(t){return In(t)?d(Bn(t)):Jn(t)}function Xn(t){return"function"==typeof t?t:null==t?$n:"object"==("undefined"==typeof t?"undefined":bo(t))?Ca(t)?Kn(t[0],t[1]):Mn(t):Un(t)}function Yn(t,e,n){var r=t?t.length:0;return r?(e=n||void 0===e?1:O(e),hn(t,e<0?0:e,r)):[]}function Gn(t,e,n){var r=t?t.length:0;return r?(e=n||void 0===e?1:O(e),e=r-e,hn(t,0,e<0?0:e)):[]}function Qn(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?hn(t,r?0:o,r?o+1:i):hn(t,r?o+1:0,r?i:o)}function Zn(t,e){return t&&t.length?Qn(t,Xn(e,3),!0,!0):[]}function tr(t,e){return t&&t.length?Qn(t,Xn(e,3),!0):[]}function er(t,e,n){return t===t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}function nr(t){return t?er(O(t),0,wf):0}function rr(t,e,n,r){var i=t.length;for(n=O(n),n<0&&(n=-n>i?0:i+n),r=void 0===r||r>i?i:O(r),r<0&&(r+=i),r=n>r?0:nr(r);n<r;)t[n++]=e;return t}function ir(t,e,n,r){var i=t?t.length:0;return i?(n&&"number"!=typeof n&&b(t,e,n)&&(n=0,r=i),rr(t,e,n,r)):[]}function or(t,e,n){for(var r=t.length,i=n?r:-1;n?i--:++i<r;)if(e(t[i],i,t))return i;return-1}function ar(t,e){return t&&t.length?or(t,Xn(e,3)):-1}function sr(t,e){return t&&t.length?or(t,Xn(e,3),!0):-1}function ur(t){return t&&t.length?t[0]:void 0}function lr(t){var e=t?t.length:0;return e?gn(t,1):[]}function cr(t){var e=t?t.length:0;return e?gn(t,_f):[]}function fr(t,e){var n=t?t.length:0;return n?(e=void 0===e?1:O(e),
gn(t,e)):[]}function hr(t){for(var e=-1,n=t?t.length:0,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r}function dr(t,e,n){var r=t?t.length:0;return r?(n=O(n),n<0&&(n=kf(r+n,0)),bn(t,e,n)):-1}function vr(t){return Gn(t,1)}function yr(t,e,n){for(var r=n?_n:wn,i=t[0].length,o=t.length,a=o,s=Array(o),u=1/0,l=[];a--;){var c=t[a];a&&e&&(c=kn(c,xn(e))),u=xf(c.length,u),s[a]=!n&&(e||i>=120&&c.length>=120)?new Ge(a&&c):void 0}c=t[0];var f=-1,h=s[0];t:for(;++f<i&&l.length<u;){var d=c[f],v=e?e(d):d;if(d=n||0!==d?d:0,!(h?On(h,v):r(l,v,n))){for(a=o;--a;){var y=s[a];if(!(y?On(y,v):r(t[a],v,n)))continue t}h&&h.push(v),l.push(d)}}return l}function gr(t){return j(t)?t:[]}function pr(t,e){return t?Cf.call(t,e):""}function mr(t,e,n){var r=t?t.length:0;if(!r)return-1;var i=r;if(void 0!==n&&(i=O(n),i=(i<0?Ef(r+i,0):Tf(i,r-1))+1),e!==e)return mn(t,i,!0);for(;i--;)if(t[i]===e)return i;return-1}function br(t,e){var n=t.length;if(n)return e+=e<0?n:0,m(e,n)?t[e]:void 0}function wr(t,e){return t&&t.length?br(t,O(e)):void 0}function _r(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function kr(t,e,n,r){var i=r?_r:bn,o=-1,a=e.length,s=t;for(n&&(s=kn(t,xn(n)));++o<a;)for(var u=0,l=e[o],c=n?n(l):l;(u=i(s,c,u,r))>-1;)s!==t&&jf.call(s,u,1),jf.call(t,u,1);return t}function xr(t,e){return t&&t.length&&e&&e.length?kr(t,e):t}function Or(t,e,n){return t&&t.length&&e&&e.length?kr(t,e,Xn(n)):t}function Pr(t,e,n){return t&&t.length&&e&&e.length?kr(t,e,void 0,n):t}function Sr(t,e){for(var n=-1,r=null==t,i=e.length,o=Array(i);++n<i;)o[n]=r?void 0:zn(t,e[n]);return o}function Ar(t,e){return 1==e.length?t:Ln(t,hn(e,0,-1))}function Cr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;if(m(i))Vf.call(t,i,1);else if(In(i,t))delete t[Bn(i)];else{var a=Dn(i),s=Ar(t,a);null!=s&&delete s[Bn(tt(a))]}}}return t}function Er(t,e){if(t!==e){var n=void 0!==t,r=null===t,i=t===t,o=_(t),a=void 0!==e,s=null===e,u=e===e,l=_(e);if(!s&&!l&&!o&&t>e||o&&a&&u&&!s&&!l||r&&a&&u||!n&&u||!i)return 1;if(!r&&!o&&!l&&t<e||l&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!u)return-1}return 0}function Tr(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=Xn(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return Cr(t,i),n}function Rr(t){return t?If.call(t):t}function jr(t,e,n){var r=t?t.length:0;return r?(n&&"number"!=typeof n&&b(t,e,n)?(e=0,n=r):(e=null==e?0:O(e),n=void 0===n?r:O(n)),hn(t,e,n)):[]}function Mr(t,e,n,r){e=n(e);for(var i=0,o=t?t.length:0,a=e!==e,s=null===e,u=_(e),l=void 0===e;i<o;){var c=zf((i+o)/2),f=n(t[c]),h=void 0!==f,d=null===f,v=f===f,y=_(f);if(a)var g=r||v;else g=l?v&&(r||h):s?v&&h&&(r||!d):u?v&&h&&!d&&(r||!y):!d&&!y&&(r?f<=e:f<e);g?i=c+1:o=c}return qf(o,Lf)}function Fr(t,e,n){var r=0,i=t?t.length:r;if("number"==typeof e&&e===e&&i<=Wf){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!_(a)&&(n?a<=e:a<e)?r=o+1:i=o}return i}return Mr(t,e,$n,n)}function Vr(t,e){return Fr(t,e)}function Nr(t,e,n){return Mr(t,e,Xn(n))}function Dr(t,e){var n=t?t.length:0;if(n){var r=Fr(t,e);if(r<n&&c(t[r],e))return r}return-1}function Ir(t,e){return Fr(t,e,!0)}function Br(t,e,n){return Mr(t,e,Xn(n),!0)}function Lr(t,e){var n=t?t.length:0;if(n){var r=Fr(t,e,!0)-1;if(c(t[r],e))return r}return-1}function zr(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],s=e?e(a):a;if(!n||!c(s,u)){var u=s;o[i++]=0===a?0:a}}return o}function qr(t){return t&&t.length?zr(t):[]}function Hr(t,e){return t&&t.length?zr(t,Xn(e)):[]}function Wr(t){return Yn(t,1)}function Kr(t,e,n){return t&&t.length?(e=n||void 0===e?1:O(e),hn(t,0,e<0?0:e)):[]}function $r(t,e,n){var r=t?t.length:0;return r?(e=n||void 0===e?1:O(e),e=r-e,hn(t,e<0?0:e,r)):[]}function Jr(t,e){return t&&t.length?Qn(t,Xn(e,3),!1,!0):[]}function Ur(t,e){return t&&t.length?Qn(t,Xn(e,3)):[]}function Xr(){}function Yr(t,e,n){var r=-1,i=wn,o=t.length,a=!0,s=[],u=s;if(n)a=!1,i=_n;else if(o>=Jf){var l=e?null:$f(t);if(l)return je(l);a=!1,i=On,u=new Ge}else u=e?[]:s;t:for(;++r<o;){var c=t[r],f=e?e(c):c;if(c=n||0!==c?c:0,a&&f===f){for(var h=u.length;h--;)if(u[h]===f)continue t;e&&u.push(f),s.push(c)}else i(u,f,n)||(u!==s&&u.push(f),s.push(c))}return s}function Gr(t){return t&&t.length?Yr(t):[]}function Qr(t,e){return t&&t.length?Yr(t,Xn(e)):[]}function Zr(t,e){return t&&t.length?Yr(t,void 0,e):[]}function ti(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function ei(t){if(!t||!t.length)return[];var e=0;return t=ti(t,function(t){if(j(t))return e=Gf(t.length,e),!0}),R(e,function(e){return kn(t,d(e))})}function ni(t,e){if(!t||!t.length)return[];var n=ei(t);return null==e?n:kn(n,function(t){return w(e,void 0,t)})}function ri(t,e,n){for(var r=-1,i=t.length;++r<i;)var o=o?be(Pn(o,t[r],e,n),Pn(t[r],o,e,n)):t[r];return o&&o.length?Yr(o,e,n):[]}function ii(t,e,n){for(var r=-1,i=t.length,o=e.length,a={};++r<i;){var s=r<o?e[r]:void 0;n(a,t[r],s)}return a}function oi(t,e){return ii(t||[],e||[],f)}function ai(t,e,n,r){e=In(e,t)?[e]:Dn(e);for(var i=-1,o=e.length,a=o-1,s=t;null!=s&&++i<o;){var u=Bn(e[i]);if(v(s)){var l=n;if(i!=a){var c=s[u];l=r?r(c,u,s):void 0,void 0===l&&(l=null==c?m(e[i+1])?[]:{}:c)}f(s,u,l)}s=s[u]}return t}function si(t,e){return ii(t||[],e||[],ai)}function ui(t,e,n){var r=hi(t,e)||ci,i=r(t,e,n),o=ih.last(e.operations).baseVersion;return li(o,i)}function li(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=!0,l=!1,c=void 0;try{for(var f,h=s.operations[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var d=f.value;d.baseVersion=++t}}catch(v){l=!0,c=v}finally{try{!u&&h["return"]&&h["return"]()}finally{if(l)throw c}}}}catch(v){r=!0,i=v}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return e}function ci(t,e,n){n=di(t.constructor,e.constructor,n);var r=new t.constructor,i=e.operations,o=[],a=!0,s=!1,u=void 0;try{for(var l,c=t.operations[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value,h=[f],d=!0,v=!1,y=void 0;try{for(var g,p=i[Symbol.iterator]();!(d=(g=p.next()).done);d=!0)for(var m=g.value,b=0;b<h.length;b++){var w=h[b];Array.prototype.push.apply(o,sn(m,w,!n));var _=sn(w,m,n);Array.prototype.splice.apply(h,[b,1].concat(_)),b+=_.length-1}}catch(k){v=!0,y=k}finally{try{!d&&p["return"]&&p["return"]()}finally{if(v)throw y}}i=o,o=[];var x=!0,O=!1,P=void 0;try{for(var S,A=h[Symbol.iterator]();!(x=(S=A.next()).done);x=!0){var C=S.value;r.addOperation(C)}}catch(k){O=!0,P=k}finally{try{!x&&A["return"]&&A["return"]()}finally{if(O)throw P}}}}catch(k){s=!0,u=k}finally{try{!a&&c["return"]&&c["return"]()}finally{if(s)throw u}}return[r]}function fi(t,e,n){var r=oh.get(t);r||(r=new Map,oh.set(t,r)),r.set(e,n)}function hi(t,e){var n=oh.get(t.constructor);if(!n||!n.get(e.constructor)){var r=oh.keys(),i=!0,o=!1,a=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;t instanceof l&&(n=oh.get(l))}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}}if(n)return n.get(e.constructor)}function di(t,e,n){return t._priority>e._priority||!(t._priority<e._priority)&&n}function vi(t,e){for(var n=new Ll,r=t.nodeList.get(0).getAttribute(e.key),i=0,o=0;o<t.nodeList.length;o++){var a=t.nodeList.get(o),s=a.getAttribute(e.key);if(s!=r){if(r!=e.value){var u=new Ga(t.position.getShiftedBy(i),t.position.getShiftedBy(o)),l=new Sl(u,e.key,r,e.value,0);n.addOperation(l)}r=s,i=o}}var c=new Ga(t.position.getShiftedBy(i),t.position.getShiftedBy(t.nodeList.length));return n.addOperation(new Sl(c,e.key,r,e.value,0)),n}function yi(){var t=new Dl;return t.addOperation(new Rl(0)),t}function gi(){var t=this;this.listenTo(this.root.document,"change",function(e,n,r){pi.call(t,n,r.range,r.sourcePosition)},this)}function pi(t,e,n){var r=void 0,i=e.end.offset-e.start.offset;switch(t){case"insert":r=this.getTransformedByInsertion(e.start,i,!1,!0)[0];break;case"move":case"remove":case"reinsert":var o=n,a=e.start.getTransformedByInsertion(o,i),s=this.getTransformedByMove(o,a,i,!1,!0);if(r=s[0],s.length>1){var u=s[1];r.start.isTouching(u.end)?r.start=u.start:r.end.isTouching(u.start)&&(r.end=u.end)}}r&&(this.start=r.start,this.end=r.end)}function mi(){var t=this;this.listenTo(this.root.document,"change",function(e,n,r){bi.call(t,n,r.range,r.sourcePosition)},this)}function bi(t,e,n){var r=e.end.offset-e.start.offset,i=void 0;switch(t){case"insert":var o="STICKS_TO_NEXT"==this.stickiness;i=this.getTransformedByInsertion(e.start,r,o);break;case"move":case"remove":case"reinsert":var a=Ga.createFromPositionAndShift(n,r),s=a.containsPosition(this)||a.start.isEqual(this)&&"STICKS_TO_NEXT"==this.stickiness||a.end.isEqual(this)&&"STICKS_TO_PREVIOUS"==this.stickiness;if(s)i=this._getCombined(n,e.start);else{var u="STICKS_TO_NEXT"==this.stickiness;i=this.getTransformedByMove(n,e.start,r,u)}break;default:return}this.path=i.path,this.root=i.root}function wi(t,e){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(!e.isCollapsed){var r=e.getFirstRange(),i=r.start,o=dh.createFromPosition(r.end);if(r.isEmpty||t.remove(r),n.merge){var a=o.path,s=Math.min(i.path.length-1,a.length-1),u=Y(i.path,a);if("number"==typeof u)for(;u<s;u++){var l=i.path.slice(0,u);l.push(i.path[u]+1),t.merge(new rs(o.root,l))}}e.collapse(i),o.detach()}}function _i(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n="BACKWARD"!=e.direction,r=t.focus,i=new Ya({boundaries:ki(r,n),singleCharacters:!0,direction:n?"FORWARD":"BACKWARD"}),o=i.next();if(!o.done){var a=o.value;if("CHARACTER"==a.type)return void t.setFocus(a.nextPosition);if(a.type==(n?"ELEMENT_START":"ELEMENT_END"))return void t.setFocus(a.item,n?"AFTER":"BEFORE");o=i.next(),o.done||(a=o.value,"CHARACTER"==a.type?t.setFocus(a.previousPosition):t.setFocus(a.item,n?0:"END"))}}function ki(t,e){var n=t.root,r=rs.createAt(n,e?"END":0);return e?new Ga(t,r):new Ga(r,t)}function xi(t,e,n){function r(r){var a=(void 0!==f[r-1]?f[r-1]:-1)+1,l=void 0!==f[r+1]?f[r+1]:-1,h=a>l?-1:1;c[r+h]&&(c[r]=c[r+h].slice(0)),c[r]||(c[r]=[]),c[r].push(a>l?i:o);for(var d=Math.max(a,l),v=d-r;v<s&&d<u&&n(t[v],e[d]);)v++,d++,c[r].push("EQUAL");return d}n=n||function(t,e){return t===e};var i=void 0,o=void 0;if(e.length<t.length){var a=t;t=e,e=a,i="DELETE",o="INSERT"}else i="INSERT",o="DELETE";var s=t.length,u=e.length,l=u-s,c={},f={},h=0,d=void 0;do{for(d=-h;d<l;d++)f[d]=r(d);for(d=l+h;d>l;d--)f[d]=r(d);f[l]=r(l),h++}while(f[l]!==u);return c[l].slice(1)}function Oi(t,e,n){t.insertBefore(n,t.childNodes[e]||null)}function Pi(t){var e=t.parentNode;e&&e.removeChild(t)}function Si(t,e){return function(n,r){t.enqueueChanges(function(){var n=r.newSelection;t.selection.removeAllRanges();var i=!0,o=!1,a=void 0;try{for(var s,u=n.getRanges()[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value,c=e.toModelRange(l);t.selection.addRange(c,n.isBackward)}}catch(f){o=!0,a=f}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}})}}function Ai(){return function(t,e,n,r){var i=e.selection;if(!i.isCollapsed&&n.consume(i,"selection")){r.viewSelection.removeAllRanges();var o=!0,a=!1,s=void 0;try{for(var u,l=i.getRanges()[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value,f=r.mapper.toViewRange(c);r.viewSelection.addRange(f,i.isBackward)}}catch(h){a=!0,s=h}finally{try{!o&&l["return"]&&l["return"]()}finally{if(a)throw s}}}}}function Ci(){return function(t,e,n,r){var i=e.selection;if(i.isCollapsed&&n.consume(i,"selection")){var o=i.getFirstPosition(),a=r.mapper.toViewPosition(o),s=r.writer.breakAttributes(a);r.viewSelection.removeAllRanges(),r.viewSelection.addRange(new fs(s,s))}}}function Ei(t){return function(e,n,r,i){var o=n.selection;if(o.isCollapsed&&r.consume(o,"selectionAttribute:"+n.key)){var a=i.viewSelection.getFirstPosition();i.viewSelection.removeAllRanges();var s=t instanceof ss?t.clone(!0):t(n.value,o,r,i);a=i.writer.wrapPosition(a,s),i.viewSelection.addRange(new fs(a,a))}}}function Ti(){return function(t,e,n,r){var i=!0,o=!1,a=void 0;try{for(var s,u=r.viewSelection.getRanges()[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;l.isCollapsed&&l.end.parent.getDocument()&&r.writer.mergeAttributes(l.start)}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}r.viewSelection.removeAllRanges()}}function Ri(t){return t instanceof HTMLTextAreaElement?t.value:t.innerHTML}function ji(t,e){t instanceof HTMLTextAreaElement&&(t.value=e),t.innerHTML=e}function Mi(t,e){return Le(t,!0,!0,e)}function Fi(t){return!!t&&(t.value&&(t=t.value),Array.isArray(t)?t.some(Fi):!!t.observable)}function Vi(t,e){return t.map(function(t){var n=t.observable,r=t.callback,i=t.type;if(n){var o=n[t.attribute];return r&&(o=r(o,e)),i===zh?o?t.valueIfTrue||!0:"":o}return t})}function Ni(t,e,n){var r=Vi(t,e),i=void 0;1==t.length&&t[0].type==zh?(r=r[0],i=""!==r,i&&(r=r===!0?"":r)):(r=r.reduce(Ji,""),i=r),i?n.set(r):n.remove()}function Di(t){return{set:function(e){t.textContent=e},remove:function(){t.textContent=""}}}function Ii(t,e){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];return{set:function(r){t.setAttributeNS(n,e,r)},remove:function(){t.removeAttributeNS(n,e)}}}function Bi(t,e){return{set:function(n){t.style[e]=n},remove:function(){t.style[e]=null}}}function Li(t){var e=Mi(t,function(t){if(t&&t.type)return t});return e}function zi(t){if(t.text&&Ki(t),t.attributes&&qi(t.attributes),t.on&&Hi(t.on),t.children)for(var e=t.children.length;e--;)Wi(t.children,t.children[e],e),zi(t.children[e])}function qi(t){for(var e in t)t[e].value&&(t[e].value=[].concat(t[e].value)),$i(t,e)}function Hi(t){for(var e in t)$i(t,e)}function Wi(t,e,n){"string"==typeof e&&t.splice(n,1,{text:[e]})}function Ki(t){Array.isArray(t.text)||(t.text=[t.text])}function $i(t,e){Array.isArray(t[e])||(t[e]=[t[e]])}function Ji(t,e){return""===t?""+e:""===e?""+t:t+" "+e}function Ui(t,e){for(var n in e)if(t[n]){var r;(r=t[n]).push.apply(r,So(e[n]))}else t[n]=e[n]}function Xi(t,e){if(e.attributes&&(t.attributes||(t.attributes={}),Ui(t.attributes,e.attributes)),e.on&&(t.on||(t.on={}),Ui(t.on,e.on)),e.text){var n;(n=t.text).push.apply(n,So(e.text))}if(e.children){if(!t.children||t.children.length!=e.children.length)throw new Bo("ui-template-extend-children-mismatch: The number of children in extended definition does not match.");e.children.forEach(function(e,n){Xi(t.children[n],e)})}}function Yi(t){return t["data-ck-expando"]||(t["data-ck-expando"]=Co())}function Gi(t){return t&&$t(t.addEventListener)}function Qi(t){return $h.has("undefined"==typeof t?"undefined":bo(t))&&t!==!1}function Zi(t,e){e.isEnabled=!1}function to(t){var e=0,n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){o.value;e++}}catch(s){r=!0,i=s}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return e}function eo(t,e){function n(){a&&(i.push(a),a=null)}function r(t){return a&&a.type==t}var i=[],o=0,a=void 0;return t.forEach(function(t){"EQUAL"==t?(n(),o++):"INSERT"==t?(r("INSERT")?a.values.push(e[o]):(n(),a={type:"INSERT",index:o,values:[e[o]]}),o++):r("DELETE")?a.howMany++:(n(),a={type:"DELETE",index:o,howMany:1})}),n(),i}function no(t){return!!t.ctrlKey||_d.includes(t.keyCode)}function ro(t,e){var n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],r=[],i=!0,o=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){for(var l=s.value,c=[l],f=0;f<c.length;f++){var h=!0,d=!1,v=void 0;try{for(var y,g=e[Symbol.iterator]();!(h=(y=g.next()).done);h=!0){var p=y.value,m=ui(c[f],p,n);c.splice.apply(c,[f,1].concat(So(m))),f=f-1+m.length}}catch(b){d=!0,v=b}finally{try{!h&&g["return"]&&g["return"]()}finally{if(d)throw v}}}r=r.concat(c)}}catch(b){o=!0,a=b}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return r}function io(t,e,n){var r=n.history,i=[t];i=oo(i,r.getDeltas(e)),i.sort(function(t,e){return t.start.isBefore(e.start)?-1:1});for(var o=1;o<i.length;o++){var a=i[o-1],s=i[o];a.end.isTouching(s.start)&&(a.end=s.end,i.splice(o,1),o--)}return i}function oo(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=!0,l=!1,c=void 0;try{for(var f,h=s.operations[Symbol.iterator]();!(u=(f=h.next()).done);u=!0)for(var d=f.value,v=0;v<t.length;v++){var y=void 0;switch(d.type){case"insert":y=t[v].getTransformedByInsertion(d.position,d.nodeList.length,!0);break;case"move":case"remove":case"reinsert":y=t[v].getTransformedByMove(d.sourcePosition,d.targetPosition,d.howMany,!0)}y&&(t.splice.apply(t,[v,1].concat(So(y))),v=v+y.length-1)}}catch(g){l=!0,c=g}finally{try{!u&&h["return"]&&h["return"]()}finally{if(l)throw c}}}}catch(g){r=!0,i=g}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return t}function ao(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new jd(e)}function so(t,e){if("function"==typeof e)return e(t);var n={};return e.name&&(n.name=uo(e.name,t.name),!n.name)?null:e.attribute&&(n.attribute=lo(e.attribute,t),!n.attribute)?null:!(e["class"]&&(n["class"]=co(e["class"],t),!n["class"]))&&(!(e.style&&(n.style=fo(e.style,t),!n.style))&&n)}function uo(t,e){return t instanceof RegExp?t.test(e):t===e}function lo(t,e){var n=[];for(var r in t){var i=t[r];if(!e.hasAttribute(r))return null;var o=e.getAttribute(r);if(i instanceof RegExp){if(!i.test(o))return null;n.push(r)}else{if(o!==i)return null;n.push(r)}}return n}function co(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u instanceof RegExp){var l=e.getClassNames(),c=!0,f=!1,h=void 0;try{for(var d,v=l[Symbol.iterator]();!(c=(d=v.next()).done);c=!0){var y=d.value;u.test(y)&&n.push(y)}}catch(g){f=!0,h=g}finally{try{!c&&v["return"]&&v["return"]()}finally{if(f)throw h}}if(0===n.length)return null}else{if(!e.hasClass(u))return null;n.push(u)}}}catch(g){i=!0,o=g}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}function fo(t,e){var n=[];for(var r in t){var i=t[r];if(!e.hasStyle(r))return null;var o=e.getStyle(r);if(i instanceof RegExp){if(!i.test(o))return null;n.push(r)}else{if(o!==i)return null;n.push(r)}}return n}function ho(t,e,n,r){if(Q(t)){var i=!0,o=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;ho(l,e,n,r)}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}}else{var f=Array.from(t.getAttributes()).map(function(t){return t[0]}).concat(e.key),h={name:t.name||"$text",attributes:f,inside:n.context};r.schema.check(h)&&t.setAttribute(e.key,e.value)}}function vo(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new Fd(e)}function yo(t){var e=arguments.length<=1||void 0===arguments[1]||arguments[1],n=t.parent;if(n instanceof Bl)return e?t.nodeAfter:t.nodeBefore;for(;!(n.parent instanceof Bl);)n=n.parent;return n}function go(t,e){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=n.defaultBlockName,i=t.doc,o=e.isCollapsed,a=e.getFirstRange(),s=a.start.parent,u=a.end.parent;if(s.root==s)return void(o||i.composer.deleteContents(t,e));if(o)po(t,e,a.start,r);else{var l=a.start.isAtStart()&&a.end.isAtEnd(),c=s==u;if(i.composer.deleteContents(t,e,{merge:l}),l){var f=rs.createFromPosition(e.focus),h=mo(i,s,r);s.name!=h&&t.rename(h,s),e.collapse(f)}else c?po(t,e,e.focus,r):e.collapse(u)}}function po(t,e,n,r){var i=t.doc,o=n.parent;if(n.isAtEnd()){var a=new Qa(mo(i,o,r));t.insert(rs.createAfter(o),a),e.collapse(a)}else{var s=dh.createFromPosition(n);s.stickiness="STICKS_TO_NEXT",t.split(n),e.collapse(s),s.detach()}}function mo(t,e,n){return t.schema.check({name:n,inside:e.parent.name})?n:e.name}var bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},wo=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},_o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),ko=function uv(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:uv(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},xo=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},Oo=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},Po=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),So=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)};!function(t){function e(t,e,n,i){var o=Object.create((e||r).prototype),a=new h(i||[]);return o._invoke=l(t,n,a),o}function n(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(r){return{type:"throw",arg:r}}}function r(){}function i(){}function o(){}function a(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function s(t){this.arg=t}function u(t){function e(r,i,o,a){var u=n(t[r],t,i);if("throw"!==u.type){var l=u.arg,c=l.value;return c instanceof s?Promise.resolve(c.arg).then(function(t){e("next",t,o,a)},function(t){e("throw",t,o,a)}):Promise.resolve(c).then(function(t){l.value=t,o(l)},a)}a(u.arg)}function r(t,n){function r(){return new Promise(function(r,i){e(t,n,r,i)})}return i=i?i.then(r,r):r()}"object"===("undefined"==typeof process?"undefined":bo(process))&&process.domain&&(e=process.domain.bind(e));var i;this._invoke=r}function l(t,e,r){var i=k;return function(o,a){if(i===O)throw new Error("Generator is already running");if(i===P){if("throw"===o)throw a;return v()}for(;;){var s=r.delegate;if(s){if("return"===o||"throw"===o&&s.iterator[o]===y){r.delegate=null;var u=s.iterator["return"];if(u){var l=n(u,s.iterator,a);if("throw"===l.type){o="throw",a=l.arg;continue}}if("return"===o)continue}var l=n(s.iterator[o],s.iterator,a);if("throw"===l.type){r.delegate=null,o="throw",a=l.arg;continue}o="next",a=y;var c=l.arg;if(!c.done)return i=x,c;r[s.resultName]=c.value,r.next=s.nextLoc,r.delegate=null}if("next"===o)r.sent=r._sent=a;else if("throw"===o){if(i===k)throw i=P,a;r.dispatchException(a)&&(o="next",a=y)}else"return"===o&&r.abrupt("return",a);i=O;var l=n(t,e,r);if("normal"===l.type){i=r.done?P:x;var c={value:l.arg,done:r.done};if(l.arg!==S)return c;r.delegate&&"next"===o&&(a=y)}else"throw"===l.type&&(i=P,o="throw",a=l.arg)}}}function c(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function f(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function h(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(c,this),this.reset(!0)}function d(t){if(t){var e=t[m];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function i(){for(;++n<t.length;)if(g.call(t,n))return i.value=t[n],i.done=!1,i;return i.value=y,i.done=!0,i};return r.next=r}}return{next:v}}function v(){return{value:y,done:!0}}var y,g=Object.prototype.hasOwnProperty,p="function"==typeof Symbol?Symbol:{},m=p.iterator||"@@iterator",b=p.toStringTag||"@@toStringTag",w="object"===("undefined"==typeof module?"undefined":bo(module)),_=t.regeneratorRuntime;if(_)return void(w&&(module.exports=_));_=t.regeneratorRuntime=w?module.exports:{},_.wrap=e;var k="suspendedStart",x="suspendedYield",O="executing",P="completed",S={},A=o.prototype=r.prototype;i.prototype=A.constructor=o,o.constructor=i,o[b]=i.displayName="GeneratorFunction",_.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===i||"GeneratorFunction"===(e.displayName||e.name))},_.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,o):(t.__proto__=o,b in t||(t[b]="GeneratorFunction")),t.prototype=Object.create(A),t},_.awrap=function(t){return new s(t)},a(u.prototype),_.async=function(t,n,r,i){var o=new u(e(t,n,r,i));return _.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},a(A),A[m]=function(){return this},A[b]="Generator",A.toString=function(){return"[object Generator]"},_.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},_.values=d,h.prototype={constructor:h,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=y,this.done=!1,this.delegate=null,this.tryEntries.forEach(f),!t)for(var e in this)"t"===e.charAt(0)&&g.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=y)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,r){return o.type="throw",o.arg=t,n.next=e,!!r}if(this.done)throw t;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=g.call(i,"catchLoc"),s=g.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&g.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?this.next=i.finallyLoc:this.complete(o),S},complete:function(t,e){if("throw"===t.type)throw t.arg;"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=t.arg,this.next="end"):"normal"===t.type&&e&&(this.next=e)},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),f(n),S}},"catch":function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;f(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:d(t),resultName:e,nextLoc:n},S}}}("object"===("undefined"==typeof global?"undefined":bo(global))?global:"object"===("undefined"==typeof window?"undefined":bo(window))?window:"object"===("undefined"==typeof self?"undefined":bo(self))?self:void 0);var Ao=function lv(e,n){wo(this,lv),this.source=e,this.name=n,this.stop=t(),this.off=t()},Co=function(){var t=1;return function(){return t++}}(),Eo=0,To={on:function(t,e,n,o){r(this,t);var a=i(this,t);"number"!=typeof o&&(o=10),e={callback:e,ctx:n||this,priority:o};var s=!0,u=!1,l=void 0;try{for(var c,f=a[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var h=c.value;e.counter=++Eo;for(var d=!1,v=h.length-1;v>=0;v--)if(h[v].priority<=o){h.splice(v+1,0,e),d=!0;break}d||h.unshift(e)}}catch(y){u=!0,l=y}finally{try{!s&&f["return"]&&f["return"]()}finally{if(u)throw l}}},once:function(t,e,n,r){var i=function(t){t.off(),e.apply(this,arguments)};this.on(t,i,n,r)},off:function(t,e,n){var r=i(this,t),o=!0,a=!1,s=void 0;try{for(var u,l=r[Symbol.iterator]();!(o=(u=l.next()).done);o=!0)for(var c=u.value,f=0;f<c.length;f++)c[f].callback==e&&(n&&n!=c[f].ctx||(c.splice(f,1),f--))}catch(h){a=!0,s=h}finally{try{!o&&l["return"]&&l["return"]()}finally{if(a)throw s}}},listenTo:function(t,e,n,r,i){var o=void 0,a=void 0,s=void 0,u=void 0;(o=this._listeningTo)||(o=this._listeningTo={}),(a=t._emitterId)||(a=t._emitterId=Co()),(s=o[a])||(s=o[a]={emitter:t,callbacks:{}}),(u=s.callbacks[e])||(u=s.callbacks[e]=[]),u.push(n),t.on(e,n,r,i)},stopListening:function(t,e,n){var r=this._listeningTo,i=t&&t._emitterId,o=r&&i&&r[i],a=o&&e&&o.callbacks[e];if(!(!r||t&&!o||e&&!a))if(n)t.off(e,n);else if(a){for(;n=a.pop();)t.off(e,n);delete o.callbacks[e]}else if(o){for(e in o.callbacks)this.stopListening(t,e);delete r[i]}else{for(i in r)this.stopListening(r[i].emitter);delete this._listeningTo}},fire:function(t,e){var n=o(this,t);if(n){var r=new Ao(this,t);e=Array.prototype.slice.call(arguments,1),e.unshift(r);for(var i=Eo,a=0;a<n.length&&(n[a].counter>i||(n[a].callback.apply(n[a].ctx,e),r.off.called&&(delete r.off.called,n.splice(a,1),a--),!r.stop.called));a++);}}},Ro=Object.getPrototypeOf,jo="[object Object]",Mo=Object.prototype,Fo=Function.prototype.toString,Vo=Mo.hasOwnProperty,No=Fo.call(Object),Do=Mo.toString,Io=function(){function t(e){wo(this,t),this._config={},e&&this._setObjectToTarget(this._config,e)}return _o(t,[{key:"set",value:function(t,e){this._setToTarget(this._config,t,e)}},{key:"define",value:function(t,e){var n=!0;this._setToTarget(this._config,t,e,n)}},{key:"get",value:function(t){return this._getFromSource(this._config,t)}},{key:"_setToTarget",value:function(t,e,n){var r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];if(l(e))return void this._setObjectToTarget(t,e,r);var i=e.split(".");e=i.pop();var o=!0,a=!1,s=void 0;try{for(var u,c=i[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var f=u.value;l(t[f])||(t[f]={}),t=t[f]}}catch(h){a=!0,s=h}finally{try{!o&&c["return"]&&c["return"]()}finally{if(a)throw s}}return l(n)?(l(t[e])||(t[e]={}),t=t[e],void this._setObjectToTarget(t,n,r)):void(r&&"undefined"!=typeof t[e]||(t[e]=n))}},{key:"_getFromSource",value:function(t,e){var n=e.split(".");e=n.pop();var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(!l(t[u])){t=null;break}t=t[u]}}catch(c){i=!0,o=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return t?t[e]:void 0}},{key:"_setObjectToTarget",value:function(t,e,n){var r=this;Object.keys(e).forEach(function(i){r._setToTarget(t,i,e[i],n)})}}]),t}(),Bo=function(t){function e(t,n){wo(this,e),n&&(t+=" "+JSON.stringify(n));var r=Oo(this,Object.getPrototypeOf(e).call(this,t));return r.name="CKEditorError",r.data=n,r}return xo(e,t),e}(Error),Lo=Object.prototype,zo=Lo.hasOwnProperty,qo=d("length"),Ho="[object Function]",Wo="[object GeneratorFunction]",Ko=Object.prototype,$o=Ko.toString,Jo=9007199254740991,Uo=9007199254740991,Xo=/^(?:0|[1-9]\d*)$/,Yo="[object Symbol]",Go=Object.prototype,Qo=Go.toString,Zo=NaN,ta=/^\s+|\s+$/g,ea=/^[-+]0x[0-9a-f]+$/i,na=/^0b[01]+$/i,ra=/^0o[0-7]+$/i,ia=parseInt,oa=1/0,aa=1.7976931348623157e308,sa="Expected a function",ua=Math.max,la=Object.prototype,ca={"function":!0,object:!0},fa=ca["undefined"==typeof exports?"undefined":bo(exports)]&&exports&&!exports.nodeType?exports:void 0,ha=ca["undefined"==typeof module?"undefined":bo(module)]&&module&&!module.nodeType?module:void 0,da=C(fa&&ha&&"object"==("undefined"==typeof global?"undefined":bo(global))&&global),va=C(ca["undefined"==typeof self?"undefined":bo(self)]&&self),ya=C(ca["undefined"==typeof window?"undefined":bo(window)]&&window),ga=C(ca[bo(void 0)]&&void 0),pa=da||ya!==(ga&&ga.window)&&ya||va||ga||Function("return this")(),ma=pa.Reflect,ba=Object.prototype,wa=ma?ma.enumerate:void 0,_a=ba.propertyIsEnumerable;wa&&!_a.call({valueOf:1},"valueOf")&&(T=function(t){return E(wa(t))});var ka=T,xa="[object Arguments]",Oa=Object.prototype,Pa=Oa.hasOwnProperty,Sa=Oa.toString,Aa=Oa.propertyIsEnumerable,Ca=Array.isArray,Ea="[object String]",Ta=Object.prototype,Ra=Ta.toString,ja=Object.prototype,Ma=ja.hasOwnProperty,Fa=Object.prototype,Va=Fa.propertyIsEnumerable,Na=!Va.call({
valueOf:1},"valueOf"),Da=S(function(t,e){if(Na||A(e)||p(e))return void h(e,N(e),t);for(var n in e)f(t,n,e[n])}),Ia=Symbol("attributes"),Ba=Symbol("boundObservables"),La=Symbol("boundAttributes"),za={set:function(t,e){var n=this;if(v(t))return void Object.keys(t).forEach(function(e){n.set(e,t[e])},this);D(this);var r=this[Ia];if(t in this&&!r.has(t))throw new Bo("observable-set-cannot-override: Cannot override an existing property.");Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:function(){return r.get(t)},set:function(e){var n=r.get(t);n===e&&r.has(t)||(r.set(t,e),this.fire("change:"+t,t,e,n))}}),this[t]=e},bind:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(!e.length||!B(e))throw new Bo("observable-bind-wrong-attrs: All attributes must be strings.");if(new Set(e).size!==e.length)throw new Bo("observable-bind-duplicate-attrs: Attributes must be unique.");D(this);var r=this[La];e.forEach(function(t){if(r.has(t))throw new Bo("observable-bind-rebind: Cannot bind the same attribute more that once.")});var i=new Map;return e.forEach(function(t){var e={attr:t,to:[]};r.set(t,e),i.set(t,e)}),{to:I,_observable:this,_bindAttrs:e,_to:[],_bindings:i}},unbind:function(){var t=this;if(Ia in this){for(var e=this[La],n=this[Ba],r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];if(i.length){if(!B(i))throw new Bo("observable-unbind-wrong-attrs: Attributes must be strings.");i.forEach(function(r){var i=e.get(r),o=void 0,a=void 0,s=void 0,u=void 0;i.to.forEach(function(e){o=e[0],a=e[1],s=n.get(o),u=s[a],u["delete"](i),u.size||delete s[a],Object.keys(s).length||(n["delete"](o),t.stopListening(o,"change"))}),e["delete"](r)})}else n.forEach(function(e,n){t.stopListening(n,"change")}),n.clear(),e.clear()}}};Da(za,To);var qa=function(){function t(e){wo(this,t),this.editor=e}return _o(t,[{key:"init",value:function(){}},{key:"destroy",value:function(){}}]),t}();K(qa,za);var Ha={error:function(t,e){console.error(t,e)},warn:function(t,e){console.warn(t,e)}},Wa=function(){function t(e){wo(this,t),this._editor=e,this._plugins=new Map}return _o(t,[{key:Symbol.iterator,value:function(){return this._plugins[Symbol.iterator]()}},{key:"get",value:function(t){return this._plugins.get(t)}},{key:"load",value:function(e){function n(t){if(!a.get(t)&&!u.has(t)){var e="string"==typeof t?r(t):i(t);return e["catch"](function(e){throw Ha.error("plugincollection-load: It was not possible to load the plugin.",{plugin:t}),e})}}function r(e){return $(t.getPluginPath(e)).then(function(t){return i(t["default"],e)})}function i(t,e){return new Promise(function(r){u.add(t),o(t),t.requires&&t.requires.forEach(n);var i=new t(s);a._add(t,i),l.push(i),e&&a._add(e,i),r()})}function o(t){if(!(t.prototype instanceof qa))throw new Bo("plugincollection-instance: The loaded plugin module is not an instance of Plugin.",{plugin:t})}var a=this,s=this._editor,u=new Set,l=[];return Promise.all(e.map(n)).then(function(){return l})}},{key:"_add",value:function(t,e){this._plugins.set(t,e)}}],[{key:"getPluginPath",value:function(t){return t.indexOf("/")<0&&(t=t+"/"+t),"ckeditor5/"+t+".js"}}]),t}(),Ka=function(){function t(e){var n=this;wo(this,t),this.lang=e||"en",this.t=function(){return n._t.apply(n,arguments)}}return _o(t,[{key:"_t",value:function(t,e){return e&&(t=t.replace(/\%(\d+)/g,function(t,n){return n<e.length?e[n]:t})),t}}]),t}(),$a=function(){function t(e){wo(this,t),this.parent=null,this._attrs=U(e)}return _o(t,[{key:"getIndex",value:function(){var t=void 0;if(!this.parent)return null;if((t=this.parent.getChildIndex(this))==-1)throw new Bo("node-not-found-in-parent: The node's parent does not contain this node.");return t}},{key:"getPath",value:function(){for(var t=[],e=this;e.parent;)t.unshift(e.getIndex()),e=e.parent;return t}},{key:"hasAttribute",value:function(t){return this._attrs.has(t)}},{key:"getAttribute",value:function(t){return this._attrs.get(t)}},{key:"getAttributes",value:function(){return this._attrs[Symbol.iterator]()}},{key:"toJSON",value:function(){var t={};return this._attrs.size&&(t.attributes=[].concat(So(this._attrs))),t}},{key:"depth",get:function(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t}},{key:"nextSibling",get:function(){var t=this.getIndex();return null!==t&&this.parent.getChild(t+1)||null}},{key:"previousSibling",get:function(){var t=this.getIndex();return null!==t&&this.parent.getChild(t-1)||null}},{key:"root",get:function(){for(var t=this;t.parent;)t=t.parent;return t}}]),t}(),Ja=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t._attrs));return r.character=t.text.substr(n,1),r.parent=t.parent,r._nodeListText=t,r._index=n,r}return xo(e,t),_o(e,[{key:"setAttribute",value:function(t,e){var n=this.getIndex();this.parent._children.setAttribute(n,1,t,e),this._attrs.set(t,e)}},{key:"setAttributesTo",value:function(t){var e=U(t);this.clearAttributes();var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.setAttribute(s[0],s[1])}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null)}},{key:"clearAttributes",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.getAttributes()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;this.removeAttribute(o[0])}}catch(a){e=!0,n=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}}}]),e}($a),Ua=function(){function t(e,n){wo(this,t),this.text=e||"",this._attrs=U(n)}return _o(t,[{key:"hasAttribute",value:function(t){return this._attrs.has(t)}},{key:"getAttribute",value:function(t){return this._attrs.get(t)}},{key:"getAttributes",value:function(){return this._attrs[Symbol.iterator]()}},{key:"setAttribute",value:function(t,e){this._attrs.set(t,e)}},{key:"setAttributesTo",value:function(t){this._attrs=U(t)}},{key:"removeAttribute",value:function(t){return this._attrs["delete"](t)}},{key:"clearAttributes",value:function(){this._attrs.clear()}},{key:"toJSON",value:function(){var t={text:this.text};return this._attrs.size&&(t.attributes=[].concat(So(this._attrs))),t}}]),t}(),Xa=function(){function t(e,n){wo(this,t),this.first=e,this.text=e._nodeListText.text.substr(this.first._index,n),this.last=this.getCharAt(this.text.length-1)}return _o(t,[{key:"getCharAt",value:function(t){return t<0||t>=this.text.length?null:new Ja(this.first._nodeListText,this.first._index+t)}},{key:"hasAttribute",value:function(t){return this.first.hasAttribute(t)}},{key:"getAttribute",value:function(t){return this.first.getAttribute(t)}},{key:"getAttributes",value:function(){return this.first.getAttributes()}},{key:"setAttribute",value:function(t,e){var n=this.first.getIndex();this.commonParent._children.setAttribute(this.first.getIndex(),this.text.length,t,e),this.first=this.commonParent.getChild(n),this.last=this.getCharAt(this.text.length-1)}},{key:"setAttributesTo",value:function(t){var e=U(t);this.clearAttributes();var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this.setAttribute(s[0],s[1])}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null)}},{key:"clearAttributes",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.getAttributes()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;this.removeAttribute(o[0])}}catch(a){e=!0,n=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}}},{key:"commonParent",get:function(){return this.first.parent}}]),t}(),Ya=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(wo(this,t),!e.boundaries&&!e.startPosition)throw new Bo("tree-walker-no-start-position: Neither boundaries nor starting position have been defined.");var n=e.direction||"FORWARD";if("FORWARD"!=n&&"BACKWARD"!=n)throw new Bo("tree-walker-unknown-direction: Only `BACKWARD` and `FORWARD` direction allowed.",{direction:n});this.direction=n,this.boundaries=e.boundaries||null,e.startPosition?this.position=rs.createFromPosition(e.startPosition):this.position=rs.createFromPosition(this.boundaries["BACKWARD"==this.direction?"end":"start"]),this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}return _o(t,[{key:Symbol.iterator,value:function(){return this}},{key:"next",value:function(){return"FORWARD"==this.direction?this._next():this._previous()}},{key:"_next",value:function(){var t=this.position,e=rs.createFromPosition(this.position),n=this._visitedParent;if(null===n.parent&&e.offset===n.getChildCount())return{done:!0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};var r=n.getChild(e.offset);if(r instanceof Qa)return this.shallow?e.offset++:(e.path.push(0),this._visitedParent=r),this.position=e,X("ELEMENT_START",r,t,e,1);if(r instanceof Ja){if(this.singleCharacters)return e.offset++,this.position=e,X("CHARACTER",r,t,e,1);var i=r._nodeListText.text.length-r._index,o=e.offset+i;this._boundaryEndParent==n&&this.boundaries.end.offset<o&&(o=this.boundaries.end.offset,i=o-e.offset);var a=new Xa(r,i);return e.offset=o,this.position=e,X("TEXT",a,t,e,i)}return e.path.pop(),e.offset++,this.position=e,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():X("ELEMENT_END",n,t,e)}},{key:"_previous",value:function(){var t=this.position,e=rs.createFromPosition(this.position),n=this._visitedParent;if(null===n.parent&&0===e.offset)return{done:!0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};var r=n.getChild(e.offset-1);if(r instanceof Qa)return e.offset--,this.shallow?(this.position=e,X("ELEMENT_START",r,t,e,1)):(e.path.push(r.getChildCount()),this.position=e,this._visitedParent=r,this.ignoreElementEnd?this._previous():X("ELEMENT_END",r,t,e));if(r instanceof Ja){if(this.singleCharacters)return e.offset--,this.position=e,X("CHARACTER",r,t,e,1);var i=r._index+1,o=e.offset-i;this._boundaryStartParent==n&&this.boundaries.start.offset>o&&(o=this.boundaries.start.offset,i=e.offset-o);var a=new Xa(n.getChild(o),i);return e.offset=o,this.position=e,X("TEXT",a,t,e,i)}return e.path.pop(),this.position=e,this._visitedParent=n.parent,X("ELEMENT_START",n,t,e,1)}}]),t}(),Ga=function(){function t(e,n){wo(this,t),this.start=rs.createFromPosition(e),this.end=rs.createFromPosition(n)}return _o(t,[{key:Symbol.iterator,value:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(new Ya({boundaries:this,ignoreElementEnd:!0}),"t0",1);case 1:case"end":return t.stop()}},e,this)})},{key:"containsPosition",value:function(t){return t.isAfter(this.start)&&t.isBefore(this.end)}},{key:"containsRange",value:function(t){return this.containsPosition(t.start)&&this.containsPosition(t.end)}},{key:"getDifference",value:function(e){var n=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&n.push(new t(this.start,e.start)),this.containsPosition(e.end)&&n.push(new t(e.end,this.end))):n.push(t.createFromRange(this)),n}},{key:"getIntersection",value:function(e){if(this.isIntersecting(e)){var n=this.start,r=this.end;return this.containsPosition(e.start)&&(n=e.start),this.containsPosition(e.end)&&(r=e.end),new t(n,r)}return null}},{key:"getMinimalFlatRanges",value:function(){for(var e=[],n=Y(this.start.path,this.end.path),r="string"==typeof n?Math.min(this.start.path.length,this.end.path.length):n,i=rs.createFromPosition(this.start),o=i.parent;i.path.length>r+1;){var a=o.getChildCount()-i.offset;0!==a&&e.push(new t(i,i.getShiftedBy(a))),i.path=i.path.slice(0,-1),i.offset++,o=o.parent}for(;i.path.length<=this.end.path.length;){var s=this.end.path[i.path.length-1],u=s-i.offset;0!==u&&e.push(new t(i,i.getShiftedBy(u))),i.offset=s,i.path.push(0)}return e}},{key:"getWalker",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return t.boundaries=this,new Ya(t)}},{key:"getItems",value:regeneratorRuntime.mark(function n(){var t,e,r,i,o,a,s,u=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:u.boundaries=this,u.ignoreElementEnd=!0,t=new Ya(u),e=!0,r=!1,i=void 0,n.prev=6,o=t[Symbol.iterator]();case 8:if(e=(a=o.next()).done){n.next=15;break}return s=a.value,n.next=12,s.item;case 12:e=!0,n.next=8;break;case 15:n.next=21;break;case 17:n.prev=17,n.t0=n["catch"](6),r=!0,i=n.t0;case 21:n.prev=21,n.prev=22,!e&&o["return"]&&o["return"]();case 24:if(n.prev=24,!r){n.next=27;break}throw i;case 27:return n.finish(24);case 28:return n.finish(21);case 29:case"end":return n.stop()}},n,this,[[6,17,21,29],[22,,24,28]])})},{key:"getPositions",value:regeneratorRuntime.mark(function r(){var t,e,n,i,o,a,s,u=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return u.boundaries=this,t=new Ya(u),r.next=4,t.position;case 4:e=!0,n=!1,i=void 0,r.prev=7,o=t[Symbol.iterator]();case 9:if(e=(a=o.next()).done){r.next=16;break}return s=a.value,r.next=13,s.nextPosition;case 13:e=!0,r.next=9;break;case 16:r.next=22;break;case 18:r.prev=18,r.t0=r["catch"](7),n=!0,i=r.t0;case 22:r.prev=22,r.prev=23,!e&&o["return"]&&o["return"]();case 25:if(r.prev=25,!n){r.next=28;break}throw i;case 28:return r.finish(25);case 29:return r.finish(22);case 30:case"end":return r.stop()}},r,this,[[7,18,22,30],[23,,25,29]])})},{key:"getTransformedByInsertion",value:function(e,n){var r=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],i=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];if(r&&this.containsPosition(e))return[new t(this.start,e),new t(e.getTransformedByInsertion(e,n,!0),this.end.getTransformedByInsertion(e,n,this.isCollapsed))];var o=t.createFromRange(this),a=o.isCollapsed?i:!i,s=i;return o.start=o.start.getTransformedByInsertion(e,n,a),o.end=o.end.getTransformedByInsertion(e,n,s),[o]}},{key:"getTransformedByMove",value:function(e,n,r,i){var o=!(arguments.length<=4||void 0===arguments[4])&&arguments[4],a=void 0,s=new t(e,e.getShiftedBy(r)),u=this.getDifference(s),l=void 0;l=1==u.length?new t(u[0].start.getTransformedByDeletion(e,r),u[0].end.getTransformedByDeletion(e,r)):2==u.length?new t(this.start,this.end.getTransformedByDeletion(e,r)):null;var c=n.getTransformedByDeletion(e,r);a=l?l.getTransformedByInsertion(c,r,i,o):[];var f=this.getIntersection(s);return!f||!i&&null!==l&&l.containsPosition(c)||a.push(new t(f.start._getCombined(s.start,c),f.end._getCombined(s.start,c))),a}},{key:"isEqual",value:function(t){return this.start.isEqual(t.start)&&this.end.isEqual(t.end)}},{key:"isIntersecting",value:function(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}},{key:"isCollapsed",get:function(){return this.start.isEqual(this.end)}},{key:"isFlat",get:function(){return this.start.parent===this.end.parent}},{key:"isEmpty",get:function(){return this.start.isTouching(this.end)}},{key:"root",get:function(){return this.start.root}}],[{key:"createFromElement",value:function(t){return this.createFromParentsAndOffsets(t,0,t,t.getChildCount())}},{key:"createOnElement",value:function(t){return this.createFromParentsAndOffsets(t.parent,t.getIndex(),t,0)}},{key:"createFromPositionAndShift",value:function(t,e){return new this(t,t.getShiftedBy(e))}},{key:"createFromParentsAndOffsets",value:function(t,e,n,r){return new this(rs.createFromParentAndOffset(t,e),rs.createFromParentAndOffset(n,r))}},{key:"createFromRange",value:function(t){return new this(t.start,t.end)}},{key:"fromJSON",value:function(t,e){return new this(rs.fromJSON(t.start,e),rs.fromJSON(t.end,e))}}]),t}(),Qa=function(t){function e(t,n,r){wo(this,e);var i=Oo(this,Object.getPrototypeOf(e).call(this,n));return i.name=t,i._children=new es,r&&i.insertChildren(0,r),i}return xo(e,t),_o(e,[{key:"getChild",value:function(t){return this._children.get(t)}},{key:"getChildCount",value:function(){return this._children.length}},{key:"getChildIndex",value:function(t){return this._children.indexOf(t)}},{key:"appendChildren",value:function(t){this.insertChildren(this.getChildCount(),t)}},{key:"insertChildren",value:function(t,e){var n=new es(e),r=!0,i=!1,o=void 0;try{for(var a,s=n._nodes[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u.parent=this}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}e instanceof ns&&(e._children=new es),this._children.insert(t,n)}},{key:"removeChildren",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?1:arguments[1],n=this._children.remove(t,e),r=!0,i=!1,o=void 0;try{for(var a,s=n._nodes[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u.parent=null}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}},{key:"setAttribute",value:function(t,e){this._attrs.set(t,e)}},{key:"setAttributesTo",value:function(t){this._attrs=U(t)}},{key:"removeAttribute",value:function(t){return this._attrs["delete"](t)}},{key:"clearAttributes",value:function(){this._attrs.clear()}},{key:"isEmpty",value:function(){return 0===this.getChildCount()}},{key:"getText",value:function(){var t="",e=!0,n=!1,r=void 0;try{for(var i,o=Ga.createFromElement(this)[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;"TEXT"==a.type&&(t+=a.item.text)}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}return t}},{key:"toJSON",value:function(){var t=ko(Object.getPrototypeOf(e.prototype),"toJSON",this).call(this);return this._children.length&&(t.children=this._children.toJSON()),t.name=this.name,t}}],[{key:"fromJSON",value:function(t){return t.children?new e(t.name,t.attributes,es.fromJSON(t.children)):new e(t.name,t.attributes)}}]),e}($a),Za=[Z].map(regeneratorRuntime.mark),ts=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return r.parent=null,r}return xo(e,t),_o(e,[{key:"getCharAt",value:function(t){return t=t&&t>=0?t:0,new Ja(this,t)}}]),e}(Ua),es=function(){function t(e){if(wo(this,t),e instanceof t)return e;if(e instanceof ns)return e._children;if(this._nodes=[],this._indexMap=[],e){"string"!=typeof e&&Q(e)||(e=[e]);var n=!0,r=!1,i=void 0;try{for(var o,a=Z(e)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=this._nodes.length,l=!1,c=1;if(s instanceof Ja?s=new ts(s.character,s._attrs):s instanceof Ua?s=new ts(s.text,s._attrs):"string"==typeof s&&(s=new ts(s,[])),s instanceof ts){c=s.text.length;var f=this._nodes[this._nodes.length-1];if(f instanceof ts&&G(f._attrs,s._attrs))f.text+=s.text,l=!0,u--;else if(0===s.text.length)continue}l||this._nodes.push(s);for(var h=0;h<c;h++)this._indexMap.push(u)}}catch(d){r=!0,i=d}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}}}return _o(t,[{key:Symbol.iterator,value:regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.length)){e.next=7;break}return e.next=4,this.get(t);case 4:t++,e.next=1;break;case 7:case"end":return e.stop()}},e,this)})},{key:"get",value:function(t){var e=this._indexMap[t],n=this._nodes[e];return n instanceof ts?n.getCharAt(this._getCharIndex(t)):n}},{key:"indexOf",value:function(t){if(t instanceof Ja){var e=this.indexOf(t._nodeListText);return e==-1?-1:e+t._index}var n=this._nodes.indexOf(t);return this._indexMap.indexOf(n)}},{key:"insert",value:function(t,e){if(0===this._nodes.length)return this._nodes=e._nodes.slice(),void(this._indexMap=e._indexMap.slice());this._splitNodeAt(t);var n=t>=this._indexMap.length?this._nodes.length:this._indexMap[t];this._indexMap.splice.apply(this._indexMap,[t,0].concat(e._indexMap)),this._nodes.splice.apply(this._nodes,[n,0].concat(e._nodes));for(var r=t;r<t+e._indexMap.length;r++)this._indexMap[r]+=n;for(var i=t+e._indexMap.length;i<this._indexMap.length;i++)this._indexMap[i]+=e._nodes.length;this._mergeNodeAt(t),this._mergeNodeAt(t+e.length)}},{key:"remove",value:function(e,n){if(0===this._nodes.length)return new t;this._splitNodeAt(e),this._splitNodeAt(e+n);var r=e+n>=this._indexMap.length?this._nodes.length:this._indexMap[e+n],i=this._indexMap[e],o=this._nodes.splice(i,r-i);this._indexMap.splice(e,n);for(var a=e;a<this._indexMap.length;a++)this._indexMap[a]-=o.length;return this._mergeNodeAt(e),new t(o)}},{key:"setAttribute",value:function(t,e,n,r){if(t<0||t+e>this.length)throw new Bo("nodelist-setattribute-out-of-bounds: Trying to set attribute on non-existing node list items.");this._splitNodeAt(t),this._splitNodeAt(t+e);for(var i=t;i<t+e;){var o=this._nodes[this._indexMap[i]];o instanceof ts?(null!==r?o._attrs.set(n,r):o._attrs["delete"](n),this._mergeNodeAt(i),i+=o.text.length):(null!==r?o.setAttribute(n,r):o.removeAttribute(n),i++)}this._mergeNodeAt(t+e)}},{key:"toJSON",value:function(){if(!this._nodes.length)return{};var t={nodes:[]},e=!0,n=!1,r=void 0;try{for(var i,o=this._nodes[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;t.nodes.push(a.toJSON())}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}return t}},{key:"_splitNodeAt",value:function(t){if(this._indexMap[t]==this._indexMap[t-1]&&0!==this._indexMap.length){var e=this._indexMap[t],n=this._nodes[e],r=this._getCharIndex(t),i=n.text.substr(0,r),o=n.text.substr(r);n.text=i;var a=new ts(o,n._attrs);a.parent=n.parent,this._nodes.splice.call(this._nodes,e+1,0,a);for(var s=t;s<this._indexMap.length;s++)this._indexMap[s]++}}},{key:"_mergeNodeAt",value:function(t){if(this._indexMap[t]!=this._indexMap[t-1]&&0!==this._indexMap.length){var e=this._indexMap[t-1],n=this._indexMap[t],r=this._nodes[e],i=this._nodes[n];if(r instanceof ts&&i instanceof ts&&G(r._attrs,i._attrs)){r.text+=i.text,this._nodes.splice(n,1);for(var o=t;o<this._indexMap.length;o++)this._indexMap[o]--}}}},{key:"_getCharIndex",value:function(t){return t-this._indexMap.indexOf(this._indexMap[t])}},{key:"length",get:function(){return this._indexMap.length}}],[{key:"fromJSON",value:function(e){var n=[];if(e.nodes){var r=!0,i=!1,o=void 0;try{for(var a,s=e.nodes[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u.text?n.push(new Ua(u.text,u.attributes)):n.push(Qa.fromJSON(u))}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}return new t(n)}}]),t}(),ns=function(){function t(e){wo(this,t),this._children=new es,e&&this.insertChildren(0,e)}return _o(t,[{key:Symbol.iterator,value:function(){return this._children[Symbol.iterator]()}},{key:"getPath",value:function(){return[]}},{key:"getChild",value:function(t){return this._children.get(t)}},{key:"getChildCount",value:function(){return this._children.length}},{key:"getChildIndex",value:function(t){return this._children.indexOf(t)}},{key:"appendChildren",value:function(t){this.insertChildren(this.getChildCount(),t)}},{key:"insertChildren",value:function(e,n){var r=new es(n),i=!0,o=!1,a=void 0;try{for(var s,u=r._nodes[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;l.parent=this}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}n instanceof t&&(n._children=new es),this._children.insert(e,r)}},{key:"removeChildren",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?1:arguments[1],n=this._children.remove(t,e),r=!0,i=!1,o=void 0;try{for(var a,s=n._nodes[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u.parent=null}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}},{key:"root",get:function(){return this}}]),t}(),rs=function(){function t(e,n){if(wo(this,t),!(e instanceof Qa||e instanceof ns))throw new Bo("position-root-invalid: Position root invalid.");if(!(n instanceof Array)||0===n.length)throw new Bo("position-path-incorrect: Position path must be an Array with at least one item.",{path:n});n=e.getPath().concat(n),e=e.root,this.root=e,this.path=n}return _o(t,[{key:"compareWith",value:function(t){if(this.root!=t.root)return"DIFFERENT";var e=Y(this.path,t.path);switch(e){case"SAME":return"SAME";case"PREFIX":return"BEFORE";case"EXTENSION":return"AFTER";default:return this.path[e]<t.path[e]?"BEFORE":"AFTER"}}},{key:"getParentPath",value:function(){return this.path.slice(0,-1)}},{key:"getShiftedBy",value:function(e){var n=t.createFromPosition(this),r=n.offset+e;return n.offset=r<0?0:r,n}},{key:"getTransformedByDeletion",value:function(e,n){var r=t.createFromPosition(this);if(this.root!=e.root)return r;if("SAME"==Y(e.getParentPath(),this.getParentPath())){if(e.offset<this.offset){if(e.offset+n>this.offset)return null;r.offset-=n}}else if("PREFIX"==Y(e.getParentPath(),this.getParentPath())){var i=e.path.length-1;if(e.offset<=this.path[i]){if(e.offset+n>this.path[i])return null;r.path[i]-=n}}return r}},{key:"getTransformedByInsertion",value:function(e,n,r){var i=t.createFromPosition(this);if(this.root!=e.root)return i;if("SAME"==Y(e.getParentPath(),this.getParentPath()))(e.offset<this.offset||e.offset==this.offset&&r)&&(i.offset+=n);else if("PREFIX"==Y(e.getParentPath(),this.getParentPath())){var o=e.path.length-1;e.offset<=this.path[o]&&(i.path[o]+=n)}return i}},{key:"getTransformedByMove",value:function(t,e,n,r,i){var o=this.getTransformedByDeletion(t,n);return e=e.getTransformedByDeletion(t,n),o=null===o||i&&o.isEqual(t)?this._getCombined(t,e):o.getTransformedByInsertion(e,n,r)}},{key:"isAfter",value:function(t){return"AFTER"==this.compareWith(t)}},{key:"isBefore",value:function(t){return"BEFORE"==this.compareWith(t)}},{key:"isEqual",value:function(t){return"SAME"==this.compareWith(t)}},{key:"isTouching",value:function(e){var n=null,r=null,i=this.compareWith(e);switch(i){case"SAME":return!0;case"BEFORE":n=t.createFromPosition(this),r=t.createFromPosition(e);break;case"AFTER":n=t.createFromPosition(e),r=t.createFromPosition(this);break;default:return!1}for(;n.path.length+r.path.length;){if(n.isEqual(r))return!0;if(n.path.length>r.path.length){if(null!==n.nodeAfter)return!1;n.path=n.path.slice(0,-1),n.offset++}else{if(null!==r.nodeBefore)return!1;r.path=r.path.slice(0,-1)}}}},{key:"isAtStart",value:function(){return 0===this.offset}},{key:"isAtEnd",value:function(){return this.offset==this.parent.getChildCount()}},{key:"_getCombined",value:function(e,n){var r=e.path.length-1,i=t.createFromPosition(n);return i.offset=i.offset+this.path[r]-e.offset,i.path=i.path.concat(this.path.slice(r+1)),i}},{key:"nodeAfter",get:function(){return this.parent.getChild(this.offset)||null}},{key:"nodeBefore",get:function(){return this.parent.getChild(this.offset-1)||null}},{key:"offset",get:function(){return tt(this.path)},set:function(t){this.path[this.path.length-1]=t}},{key:"parent",get:function(){var t=this.root,e=void 0,n=void 0;for(e=0,n=this.path.length-1;e<n;e++)t=t.getChild(this.path[e]);return t}}],[{key:"createAt",value:function(e,n){var r=void 0;if(e instanceof t)return this.createFromPosition(e);if(r=e,"END"==n)n=r.getChildCount();else{if("BEFORE"==n)return this.createBefore(r);if("AFTER"==n)return this.createAfter(r);n||(n=0)}return this.createFromParentAndOffset(r,n)}},{key:"createAfter",value:function(t){if(!t.parent)throw new Bo("position-after-root: You can not make position after root.",{root:t});return this.createFromParentAndOffset(t.parent,t.getIndex()+1)}},{key:"createBefore",value:function(t){if(!t.parent)throw new Bo("position-before-root: You can not make position before root.",{root:t});return this.createFromParentAndOffset(t.parent,t.getIndex())}},{key:"createFromParentAndOffset",value:function(t,e){if(!(t instanceof Qa||t instanceof ns))throw new Bo("position-parent-incorrect: Position parent have to be a model element or model document fragment.");var n=t.getPath();return n.push(e),new this(t.root,n)}},{key:"createFromPosition",value:function(t){return new this(t.root,t.path.slice())}},{key:"fromJSON",value:function(e,n){if("$graveyard"===e.root)return new t(n.graveyard,e.path);if(!n.hasRoot(e.root))throw new Bo("position-fromjson-no-root: Cannot create position for document. Root with specified name does not exist.",{rootName:e.root});return new t(n.getRoot(e.root),e.path)}}]),t}(),is=function(){function t(){wo(this,t),this.parent=null}return _o(t,[{key:"getIndex",value:function(){var t=void 0;if(!this.parent)return null;if((t=this.parent.getChildIndex(this))==-1)throw new Bo("view-node-not-found-in-parent: The node's parent does not contain this node.");return t}},{key:"getNextSibling",value:function(){var t=this.getIndex();return null!==t&&this.parent.getChild(t+1)||null}},{key:"getPreviousSibling",value:function(){var t=this.getIndex();return null!==t&&this.parent.getChild(t-1)||null}},{key:"getDocument",value:function(){return this.parent instanceof t?this.parent.getDocument():null}},{key:"getRoot",value:function(){for(var t=this;t.parent;)t=t.parent;return t}},{key:"getAncestors",value:function(){for(var t=arguments.length<=0||void 0===arguments[0]?{includeNode:!1,parentFirst:!1}:arguments[0],e=[],n=t.includeNode?this:this.parent;null!==n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}},{key:"remove",value:function(){this.parent.removeChildren(this.getIndex())}},{key:"_fireChange",value:function(t,e){this.fire("change:"+t,e),this.parent&&this.parent._fireChange(t,e)}}]),t}();K(is,To);var os=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this));return n._data=t,n}return xo(e,t),_o(e,[{key:"clone",value:function(){return new e(this.data)}},{key:"isSimilar",value:function(t){return t instanceof e&&(this===t||this.data===t.data)}},{key:"data",get:function(){return this._data},set:function(t){this._fireChange("text",this),this._data=t}}]),e}(is),as=function(){function t(e,n,r){wo(this,t),this.parent=e.parent,this.textNode=e,this.index=n,this.data=e.data.substring(n,n+(r||e.data.length-n))}return _o(t,[{key:"getDocument",value:function(){return this.textNode.getDocument()}},{key:"getRoot",value:function(){return this.textNode.getRoot()}},{key:"getAncestors",value:function(){for(var t=arguments.length<=0||void 0===arguments[0]?{includeNode:!1,parentFirst:!1}:arguments[0],e=[],n=t.includeNode?this.textNode:this.parent;null!==n;)e[t.parentFirst?"push":"unshift"](n),n=n.parent;return e}}]),t}(),ss=function(t){function e(t,n,r){wo(this,e);var i=Oo(this,Object.getPrototypeOf(e).call(this));if(i.name=t,l(n)?i._attrs=J(n):i._attrs=new Map(n),i._children=[],r&&i.insertChildren(0,r),i._classes=new Set,i._attrs.has("class")){var o=i._attrs.get("class");nt(i._classes,o),i._attrs["delete"]("class")}return i._styles=new Map,i._attrs.has("style")&&(et(i._styles,i._attrs.get("style")),i._attrs["delete"]("style")),i}return xo(e,t),_o(e,[{key:"clone",value:function(t){var e=[];if(t){var n=!0,r=!1,i=void 0;try{for(var o,a=this.getChildren()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e.push(s.clone(t))}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}}var l=new this.constructor(this.name,this._attrs,e);return l._classes=new Set(this._classes),l._styles=new Map(this._styles),l}},{key:"appendChildren",value:function(t){return this.insertChildren(this.getChildCount(),t)}},{key:"getChild",value:function(t){return this._children[t]}},{key:"getChildCount",value:function(){return this._children.length}},{key:"getChildIndex",value:function(t){return this._children.indexOf(t)}},{key:"getChildren",value:function(){return this._children[Symbol.iterator]()}},{key:"getAttributeKeys",value:regeneratorRuntime.mark(function n(){var t,e,r,i,o,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(this._classes.size>0)){n.next=3;break}return n.next=3,
"class";case 3:if(!(this._styles.size>0)){n.next=6;break}return n.next=6,"style";case 6:t=!0,e=!1,r=void 0,n.prev=9,i=this._attrs.keys()[Symbol.iterator]();case 11:if(t=(o=i.next()).done){n.next=18;break}return a=o.value,n.next=15,a;case 15:t=!0,n.next=11;break;case 18:n.next=24;break;case 20:n.prev=20,n.t0=n["catch"](9),e=!0,r=n.t0;case 24:n.prev=24,n.prev=25,!t&&i["return"]&&i["return"]();case 27:if(n.prev=27,!e){n.next=30;break}throw r;case 30:return n.finish(27);case 31:return n.finish(24);case 32:case"end":return n.stop()}},n,this,[[9,20,24,32],[25,,27,31]])})},{key:"getAttribute",value:function(t){if("class"!=t){if("style"!=t)return this._attrs.get(t);if(this._styles.size>0){var e="",n=!0,r=!1,i=void 0;try{for(var o,a=this._styles[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=Po(o.value,2),u=s[0],l=s[1];e+=u+":"+l+";"}}catch(c){r=!0,i=c}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return e}}else if(this._classes.size>0)return[].concat(So(this._classes)).join(" ")}},{key:"hasAttribute",value:function(t){return"class"==t?this._classes.size>0:"style"==t?this._styles.size>0:this._attrs.has(t)}},{key:"setAttribute",value:function(t,e){this._fireChange("attributes",this),"class"==t?nt(this._classes,e):"style"==t?et(this._styles,e):this._attrs.set(t,e)}},{key:"insertChildren",value:function(t,e){this._fireChange("children",this);var n=0;Q(e)||(e=[e]);var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u.parent=this,this._children.splice(t,0,u),t++,n++}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}},{key:"removeAttribute",value:function(t){return this._fireChange("attributes",this),"class"==t?this._classes.size>0&&(this._classes.clear(),!0):"style"==t?this._styles.size>0&&(this._styles.clear(),!0):this._attrs["delete"](t)}},{key:"removeChildren",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?1:arguments[1];this._fireChange("children",this);for(var n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}},{key:"isSimilar",value:function(t){if(!(t instanceof e))return!1;if(this===t)return!0;if(this.name!=t.name)return!1;if(this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=this._attrs[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=Po(o.value,2),u=s[0],l=s[1];if(!t._attrs.has(u)||t._attrs.get(u)!==l)return!1}}catch(c){r=!0,i=c}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}var f=!0,h=!1,d=void 0;try{for(var v,y=this._classes[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value;if(!t._classes.has(g))return!1}}catch(c){h=!0,d=c}finally{try{!f&&y["return"]&&y["return"]()}finally{if(h)throw d}}var p=!0,m=!1,b=void 0;try{for(var w,_=this._styles[Symbol.iterator]();!(p=(w=_.next()).done);p=!0){var k=Po(w.value,2),x=k[0],l=k[1];if(!t._styles.has(x)||t._styles.get(x)!==l)return!1}}catch(c){m=!0,b=c}finally{try{!p&&_["return"]&&_["return"]()}finally{if(m)throw b}}return!0}},{key:"addClass",value:function(){var t=this;this._fireChange("attributes",this);for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t._classes.add(e)})}},{key:"removeClass",value:function(){var t=this;this._fireChange("attributes",this);for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t._classes["delete"](e)})}},{key:"hasClass",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(!this._classes.has(u))return!1}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return!0}},{key:"getClassNames",value:function(){return this._classes.keys()}},{key:"setStyle",value:function(t,e){if(this._fireChange("attributes",this),l(t)){var n=Object.keys(t),r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;this._styles.set(u,t[u])}}catch(c){i=!0,o=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}else this._styles.set(t,e)}},{key:"getStyle",value:function(t){return this._styles.get(t)}},{key:"getStyleNames",value:function(){return this._styles.keys()}},{key:"hasStyle",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(!this._styles.has(u))return!1}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return!0}},{key:"removeStyle",value:function(){var t=this;this._fireChange("attributes",this);for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t._styles["delete"](e)})}}]),e}(is),us=function(t){function e(t,n,r){return wo(this,e),Oo(this,Object.getPrototypeOf(e).call(this,t,n,r))}return xo(e,t),_o(e,[{key:"getFillerOffset",value:function(){return 0===this.getChildCount()?0:null}}]),e}(ss),ls=function(t){function e(t,n,r,i){wo(this,e);var o=Oo(this,Object.getPrototypeOf(e).call(this,n,r,i));return o._document=t,o.set("isReadOnly",!1),o.bind("isFocused").to(t,"isFocused",function(e){return e&&t.selection.getEditableElement()==o}),o.listenTo(t,"render",function(){o.isFocused=t.isFocused&&t.selection.getEditableElement()==o},null,11),o}return xo(e,t),_o(e,[{key:"getDocument",value:function(){return this._document}}]),e}(us);K(ls,za);var cs=function(){function t(e,n){wo(this,t),this.parent=e,this.offset=n}return _o(t,[{key:"getShiftedBy",value:function(e){var n=t.createFromPosition(this),r=n.offset+e;return n.offset=r<0?0:r,n}},{key:"isEqual",value:function(t){return this==t||this.parent==t.parent&&this.offset==t.offset}},{key:"isBefore",value:function(t){return"BEFORE"==this.compareWith(t)}},{key:"isAfter",value:function(t){return"AFTER"==this.compareWith(t)}},{key:"compareWith",value:function(t){if(this.isEqual(t))return"SAME";if(this.parent===t.parent)return this.offset-t.offset<0?"BEFORE":"AFTER";var e=this.parent.getAncestors({includeNode:!0}),n=t.parent.getAncestors({includeNode:!0}),r=Y(e,n),i=void 0;switch(r){case 0:return"DIFFERENT";case"PREFIX":i=e.length-1;break;case"EXTENSION":i=n.length-1;break;default:i=r-1}var o=e[i],a=e[i+1],s=n[i+1];if(o===this.parent){var u=this.offset-s.getIndex();return u<=0?"BEFORE":"AFTER"}if(o===t.parent){var l=a.getIndex()-t.offset;return l<0?"BEFORE":"AFTER"}var c=a.getIndex()-s.getIndex();return c<0?"BEFORE":"AFTER"}},{key:"getEditableElement",value:function(){for(var t=this.parent;!(t instanceof ls);){if(!t.parent)return null;t=t.parent}return t}},{key:"nodeAfter",get:function(){return this.parent instanceof os?null:this.parent.getChild(this.offset)||null}},{key:"nodeBefore",get:function(){return this.parent instanceof os?null:this.parent.getChild(this.offset-1)||null}}],[{key:"createAfter",value:function(e){if(e instanceof as)return new t(e.textNode,e.index+e.data.length);if(!e.parent)throw new Bo("position-after-root: You can not make position after root.",{root:e});return new t(e.parent,e.getIndex()+1)}},{key:"createBefore",value:function(e){if(e instanceof as)return new t(e.textNode,e.index);if(!e.parent)throw new Bo("position-before-root: You can not make position before root.",{root:e});return new t(e.parent,e.getIndex())}},{key:"createFromPosition",value:function(t){return new this(t.parent,t.offset)}}]),t}(),fs=function(){function t(e,n){wo(this,t),this.start=cs.createFromPosition(e),this.end=cs.createFromPosition(n)}return _o(t,[{key:"isEqual",value:function(t){return this==t||this.start.isEqual(t.start)&&this.end.isEqual(t.end)}},{key:"isIntersecting",value:function(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}},{key:"isCollapsed",get:function(){return this.start.isEqual(this.end)}}],[{key:"createFromParentsAndOffsets",value:function(t,e,n,r){return new this(new cs(t,e),new cs(n,r))}},{key:"createFromRange",value:function(t){return new this(t.start,t.end)}}]),t}(),hs=function(){function t(){wo(this,t),this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap}return _o(t,[{key:"bindElements",value:function(t,e){this._modelToViewMapping.set(t,e),this._viewToModelMapping.set(e,t)}},{key:"clearBindings",value:function(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap}},{key:"toModelElement",value:function(t){return this._viewToModelMapping.get(t)}},{key:"toViewElement",value:function(t){return this._modelToViewMapping.get(t)}},{key:"toModelRange",value:function(t){return new Ga(this.toModelPosition(t.start),this.toModelPosition(t.end))}},{key:"toViewRange",value:function(t){return new fs(this.toViewPosition(t.start),this.toViewPosition(t.end))}},{key:"toModelPosition",value:function(t){for(var e=t.parent,n=this._viewToModelMapping.get(e);!n;)e=e.parent,n=this._viewToModelMapping.get(e);var r=this._toModelOffset(t.parent,t.offset,e);return rs.createFromParentAndOffset(n,r)}},{key:"toViewPosition",value:function(t){var e=this._modelToViewMapping.get(t.parent);return this._findPositionIn(e,t.offset)}},{key:"_toModelOffset",value:function(t,e,n){if(n!=t){var r=this._toModelOffset(t.parent,t.getIndex(),n),i=this._toModelOffset(t,e,t);return r+i}if(t instanceof os)return e;for(var o=0,a=0;a<e;a++)o+=this._getModelLength(t.getChild(a));return o}},{key:"_getModelLength",value:function(t){if(this._viewToModelMapping.has(t))return 1;if(t instanceof os)return t.data.length;var e=0,n=!0,r=!1,i=void 0;try{for(var o,a=t.getChildren()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e+=this._getModelLength(s)}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return e}},{key:"_findPositionIn",value:function(t,e){var n=void 0,r=0,i=0,o=0;if(t instanceof os)return new cs(t,e);for(;i<e;)n=t.getChild(o),r=this._getModelLength(n),i+=r,o++;return i==e?this._moveViewPositionToTextNode(new cs(t,o)):this._findPositionIn(n,e-(i-r))}},{key:"_moveViewPositionToTextNode",value:function(t){var e=t.nodeBefore,n=t.nodeAfter;return e instanceof os?new cs(e,e.data.length):n instanceof os?new cs(n,0):t}}]),t}(),ds=function(){function t(){wo(this,t),this._consumable=new Map,this._textProxyRegistry=new Map}return _o(t,[{key:"add",value:function(t,e){t instanceof Xa&&(t=this._getSymbolForTextProxy(t)),this._consumable.has(t)||this._consumable.set(t,new Map),this._consumable.get(t).set(e,!0)}},{key:"consume",value:function(t,e){return t instanceof Xa&&(t=this._getSymbolForTextProxy(t)),!!this.test(t,e)&&(this._consumable.get(t).set(e,!1),!0)}},{key:"test",value:function(t,e){t instanceof Xa&&(t=this._getSymbolForTextProxy(t));var n=this._consumable.get(t);if(void 0===n)return null;var r=n.get(e);return void 0===r?null:r}},{key:"revert",value:function(t,e){t instanceof Xa&&(t=this._getSymbolForTextProxy(t));var n=this.test(t,e);return n===!1?(this._consumable.get(t).set(e,!0),!0):n!==!0&&null}},{key:"_getSymbolForTextProxy",value:function(t){var e=null,n=t.first.getIndex(),r=n+t.text.length,i=t.commonParent,o=this._textProxyRegistry.get(n);if(o){var a=o.get(r);a&&(e=a.get(i))}return e||(e=this._addSymbolForTextProxy(n,r,i)),e}},{key:"_addSymbolForTextProxy",value:function(t,e,n){var r=Symbol(),i=void 0,o=void 0;return i=this._textProxyRegistry.get(t),i||(i=new Map,this._textProxyRegistry.set(t,i)),o=i.get(e),o||(o=new Map,i.set(e,o)),o.set(n,r),r}}]),t}(),vs=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];wo(this,t),this.conversionApi=Da({},e)}return _o(t,[{key:"convertChange",value:function(t,e){"remove"!==t&&e.range&&"$graveyard"==e.range.root.rootName||("insert"==t||"reinsert"==t?this.convertInsert(e.range):"move"==t?this.convertMove(e.sourcePosition,e.range):"remove"==t?this.convertRemove(e.sourcePosition,e.range):"addAttribute"!=t&&"removeAttribute"!=t&&"changeAttribute"!=t||this.convertAttribute(t,e.range,e.key,e.oldValue,e.newValue))}},{key:"convertInsert",value:function(t){var e=this._createInsertConsumable(t),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.item,l=Ga.createFromPositionAndShift(s.previousPosition,s.length),c={item:u,range:l};this._testAndFire("insert",c,e);var f=!0,h=!1,d=void 0;try{for(var v,y=u.getAttributes()[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value;c.attributeKey=g[0],c.attributeOldValue=null,c.attributeNewValue=g[1],this._testAndFire("addAttribute:"+g[0],c,e)}}catch(p){h=!0,d=p}finally{try{!f&&y["return"]&&y["return"]()}finally{if(h)throw d}}}}catch(p){r=!0,i=p}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}}},{key:"convertMove",value:function(t,e){var n={sourcePosition:t,range:e};this.fire("move",n,this.conversionApi)}},{key:"convertRemove",value:function(t,e){var n={sourcePosition:t,range:e};this.fire("remove",n,this.conversionApi)}},{key:"convertAttribute",value:function(t,e,n,r,i){var o=this._createAttributeConsumable(t,e,n),a=!0,s=!1,u=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value,h=f.item,d=Ga.createFromPositionAndShift(f.previousPosition,f.length),v={item:h,range:d,attributeKey:n,attributeOldValue:r,attributeNewValue:i};this._testAndFire(t+":"+n,v,o,this.conversionApi)}}catch(y){s=!0,u=y}finally{try{!a&&c["return"]&&c["return"]()}finally{if(s)throw u}}}},{key:"convertSelection",value:function(t){var e=this._createSelectionConsumable(t),n={selection:t};this.fire("selection",n,e,this.conversionApi);var r=!0,i=!1,o=void 0;try{for(var a,s=t.getAttributes()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;n.key=u[0],n.value=u[1],e.test(t,"selectionAttribute:"+n.key)&&this.fire("selectionAttribute:"+n.key,n,e,this.conversionApi)}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}},{key:"_createInsertConsumable",value:function(t){var e=new ds,n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.item;e.add(u,"insert");var l=!0,c=!1,f=void 0;try{for(var h,d=u.getAttributes()[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var v=h.value;e.add(u,"addAttribute:"+v[0])}}catch(y){c=!0,f=y}finally{try{!l&&d["return"]&&d["return"]()}finally{if(c)throw f}}}}catch(y){r=!0,i=y}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return e}},{key:"_createAttributeConsumable",value:function(t,e,n){var r=new ds,i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value,c=l.item;r.add(c,t+":"+n)}}catch(f){o=!0,a=f}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return r}},{key:"_createSelectionConsumable",value:function(t){var e=new ds;e.add(t,"selection");var n=!0,r=!1,i=void 0;try{for(var o,a=t.getAttributes()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e.add(t,"selectionAttribute:"+s[0])}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return e}},{key:"_testAndFire",value:function(t,e,n){if(n.test(e.item,t))if("insert"===t)e.item instanceof Xa?this.fire(t+":$text",e,n,this.conversionApi):this.fire(t+":"+e.item.name,e,n,this.conversionApi);else{var r=e.item.name||"$text";this.fire(t+":"+r,e,n,this.conversionApi)}}}]),t}();K(vs,To);var ys=function(){function t(e){wo(this,t),this._children=[],e&&this.insertChildren(0,e)}return _o(t,[{key:Symbol.iterator,value:function(){return this._children[Symbol.iterator]()}},{key:"appendChildren",value:function(t){return this.insertChildren(this.getChildCount(),t)}},{key:"getChild",value:function(t){return this._children[t]}},{key:"getChildCount",value:function(){return this._children.length}},{key:"getChildIndex",value:function(t){return this._children.indexOf(t)}},{key:"getChildren",value:function(){return this._children[Symbol.iterator]()}},{key:"insertChildren",value:function(t,e){this._fireChange("children",this);var n=0;Q(e)||(e=[e]);var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u.parent=this,this._children.splice(t,0,u),t++,n++}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}},{key:"removeChildren",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?1:arguments[1];this._fireChange("children",this);for(var n=t;n<t+e;n++)this._children[n].parent=null;return this._children.splice(t,e)}},{key:"_fireChange",value:function(t,e){this.fire("change",t,e)}}]),t}();K(ys,To);var gs=function(){function t(){wo(this,t),this._canConsumeName=null,this._consumables={attribute:new Map,style:new Map,"class":new Map}}return _o(t,[{key:"add",value:function(t){t.name&&(this._canConsumeName=!0);for(var e in this._consumables)e in t&&this._add(e,t[e])}},{key:"test",value:function(t){if(t.name&&!this._canConsumeName)return this._canConsumeName;for(var e in this._consumables)if(e in t){var n=this._test(e,t[e]);if(n!==!0)return n}return!0}},{key:"consume",value:function(t){t.name&&(this._canConsumeName=!1);for(var e in this._consumables)e in t&&this._consume(e,t[e])}},{key:"revert",value:function(t){t.name&&(this._canConsumeName=!0);for(var e in this._consumables)e in t&&this._revert(e,t[e])}},{key:"_add",value:function(t,e){var n=Ca(e)?e:[e],r=this._consumables[t],i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;if("attribute"===t&&("class"===l||"style"===l))throw new Bo("viewconsumable-invalid-attribute: Classes and styles should be handled separately.");r.set(l,!0)}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}}},{key:"_test",value:function(t,e){var n=Ca(e)?e:[e],r=this._consumables[t],i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;if("attribute"!==t||"class"!==l&&"style"!==l){var c=r.get(l);if(void 0===c)return null;if(!c)return!1}else{var f=this._test(l,[].concat(So(this._consumables[l].keys())));if(f!==!0)return f}}}catch(h){o=!0,a=h}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return!0}},{key:"_consume",value:function(t,e){var n=Ca(e)?e:[e],r=this._consumables[t],i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;"attribute"!==t||"class"!==l&&"style"!==l?r.set(l,!1):this._consume(l,[].concat(So(this._consumables[l].keys())))}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}}},{key:"_revert",value:function(t,e){var n=Ca(e)?e:[e],r=this._consumables[t],i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;if("attribute"!==t||"class"!==l&&"style"!==l){var c=r.get(l);c===!1&&r.set(l,!0)}else this._revert(l,[].concat(So(this._consumables[l].keys())))}}catch(f){o=!0,a=f}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}}}]),t}(),ps=function(){function t(){wo(this,t),this._consumables=new Map}return _o(t,[{key:"add",value:function(t,e){var n=void 0;return t instanceof os||t instanceof ys?void this._consumables.set(t,!0):(this._consumables.has(t)?n=this._consumables.get(t):(n=new gs,this._consumables.set(t,n)),void n.add(e))}},{key:"test",value:function(t,e){var n=this._consumables.get(t);return void 0===n?null:t instanceof os||t instanceof ys?n:n.test(e)}},{key:"consume",value:function(t,e){return!!this.test(t,e)&&(t instanceof os||t instanceof ys?this._consumables.set(t,!1):this._consumables.get(t).consume(e),!0)}},{key:"revert",value:function(t,e){var n=this._consumables.get(t);void 0!==n&&(t instanceof os||t instanceof ys?this._consumables.set(t,!0):n.revert(e))}}],[{key:"consumablesFromElement",value:function(t){var e={name:!0,attribute:[],"class":[],style:[]},n=t.getAttributeKeys(),r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;"style"!=u&&"class"!=u&&e.attribute.push(u)}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}var c=t.getClassNames(),f=!0,h=!1,d=void 0;try{for(var v,y=c[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value;e["class"].push(g)}}catch(l){h=!0,d=l}finally{try{!f&&y["return"]&&y["return"]()}finally{if(h)throw d}}var p=t.getStyleNames(),m=!0,b=!1,w=void 0;try{for(var _,k=p[Symbol.iterator]();!(m=(_=k.next()).done);m=!0){var x=_.value;e.style.push(x)}}catch(l){b=!0,w=l}finally{try{!m&&k["return"]&&k["return"]()}finally{if(b)throw w}}return e}},{key:"createFrom",value:function(e,n){if(n||(n=new t),e instanceof os)return n.add(e),n;e instanceof ss&&n.add(e,t.consumablesFromElement(e)),e instanceof ys&&n.add(e);var r=!0,i=!1,o=void 0;try{for(var a,s=e.getChildren()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;n=t.createFrom(u,n)}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}}]),t}(),ms=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];wo(this,t),this.conversionApi=Da({},e),this.conversionApi.convertItem=this._convertItem.bind(this),this.conversionApi.convertChildren=this._convertChildren.bind(this)}return _o(t,[{key:"convert",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this.fire("viewCleanup",t);var n=ps.createFrom(t);return this._convertItem(t,n,e)}},{key:"_convertItem",value:function(t,e){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=Da({},n,{input:t,output:null});return t instanceof ss?this.fire("element:"+t.name,r,e,this.conversionApi):t instanceof os?this.fire("text",r,e,this.conversionApi):this.fire("documentFragment",r,e,this.conversionApi),r.output}},{key:"_convertChildren",value:function(t,e){var n=this,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],i=Array.from(t.getChildren()),o=i.map(function(t){return n._convertItem(t,e,r)});return o.reduce(function(t,e){return e?t.concat(e):t},[])}}]),t}();K(ms,To);var bs=10,ws=function(t){function e(t,n,r){wo(this,e);var i=Oo(this,Object.getPrototypeOf(e).call(this,t,n,r));return i.priority=bs,i}return xo(e,t),_o(e,[{key:"clone",value:function(t){var n=ko(Object.getPrototypeOf(e.prototype),"clone",this).call(this,t);return n.priority=this.priority,n}},{key:"isSimilar",value:function(t){return ko(Object.getPrototypeOf(e.prototype),"isSimilar",this).call(this,t)&&this.priority==t.priority}},{key:"getFillerOffset",value:function(){if(this.getChildCount())return null;for(var t=this.parent;t instanceof e;){if(t.getChildCount()>1)return null;t=t.parent}return!t||t.getChildCount()>1?null:0}}]),e}(ss);ws.DEFAULT_PRIORITY=bs;var _s=function(){function t(){wo(this,t)}return _o(t,[{key:"getParentContainer",value:function(t){for(var e=t.parent;!xt(e);){if(!e)return;e=e.parent}return e}},{key:"breakAttributes",value:function(t){return this._breakAttributes(t,!1)}},{key:"_breakAttributes",value:function(t){var e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],n=t.offset,r=t.parent;if(!e&&r instanceof os&&xt(r.parent))return cs.createFromPosition(t);if(xt(r))return cs.createFromPosition(t);if(r instanceof os)return this._breakAttributes(pt(t),e);var i=r.getChildCount();if(n==i){var o=new cs(r.parent,r.getIndex()+1);return this._breakAttributes(o,e)}if(0===n){var a=new cs(r.parent,r.getIndex());return this._breakAttributes(a,e)}var s=r.getIndex()+1,u=r.clone();r.parent.insertChildren(s,u);var l=r.getChildCount()-n,c=r.removeChildren(n,l);u.appendChildren(c);var f=new cs(r.parent,s);return this._breakAttributes(f,e)}},{key:"breakRange",value:function(t){return this._breakRange(t)}},{key:"_breakRange",value:function(t){var e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],n=t.start,r=t.end;if(this.getParentContainer(n)!==this.getParentContainer(r))throw new Bo("view-writer-invalid-range-container");if(t.isCollapsed){var i=this._breakAttributes(t.start,e);return new fs(i,i)}var o=this._breakAttributes(r,e),a=o.parent.getChildCount(),s=this._breakAttributes(n,e);return o.offset+=o.parent.getChildCount()-a,new fs(s,o)}},{key:"mergeAttributes",value:function(t){var e=t.offset,n=t.parent;if(n instanceof os)return t;if(n instanceof ws&&0===n.getChildCount()){var r=n.parent,i=n.getIndex();return n.remove(),this.mergeAttributes(new cs(r,i))}var o=n.getChild(e-1),a=n.getChild(e);if(!o||!a)return t;if(o instanceof us||a instanceof us)return t;if(o instanceof os&&a instanceof os)return mt(o,a);if(o.isSimilar(a)){var s=o.getChildCount();return o.appendChildren(a.getChildren()),a.remove(),this.mergeAttributes(new cs(o,s))}return t}},{key:"insert",value:function(t,e){e=Q(e)?[].concat(So(e)):[e],kt(e);var n=this.getParentContainer(t),r=this._breakAttributes(t,!0),i=n.insertChildren(r.offset,e),o=r.getShiftedBy(i),a=this.mergeAttributes(r);if(0===i)return new fs(a,a);a.isEqual(r)||o.offset--;var s=this.mergeAttributes(o);return new fs(a,s)}},{key:"remove",value:function(t){if(this.getParentContainer(t.start)!==this.getParentContainer(t.end))throw new Bo("view-writer-invalid-range-container");if(t.isCollapsed)return new ys;var e=this._breakRange(t,!0),n=e.start,r=e.end,i=n.parent,o=r.offset-n.offset,a=i.removeChildren(n.offset,o),s=this.mergeAttributes(n);return t.start=s,t.end=cs.createFromPosition(s),new ys(a)}},{key:"move",value:function(t,e){var n=this.remove(t);return this.insert(e,n)}},{key:"wrap",value:function(t,e){if(!(e instanceof ws))throw new Bo("view-writer-wrap-invalid-attribute");if(this.getParentContainer(t.start)!==this.getParentContainer(t.end))throw new Bo("view-writer-invalid-range-container");if(t.isCollapsed)return t;if(t.end.isEqual(t.start.getShiftedBy(1))){var n=t.start.nodeAfter;if(n instanceof ws&&bt(e,n))return t}if(_t(t)&&bt(e,t.start.parent)){var r=t.start.parent.parent,i=t.start.parent.getIndex();return fs.createFromParentsAndOffsets(r,i,r,i+1)}var o=this._breakRange(t,!0),a=o.start,s=o.end,u=a.parent,l=vt(this,u,a.offset,s.offset,e),c=yt(this,u,l.start.offset,l.end.offset,e),f=this.mergeAttributes(c.start);f.isEqual(c.start)||c.end.offset--;var h=this.mergeAttributes(c.end);return new fs(f,h)}},{key:"wrapPosition",value:function(t,e){if(!(e instanceof ws))throw new Bo("view-writer-wrap-invalid-attribute");if(e.isSimilar(t.parent))return gt(cs.createFromPosition(t));t.parent instanceof os&&(t=pt(t));var n=new ws;n.priority=Number.POSITIVE_INFINITY,n.isSimilar=function(){return!1},t.parent.insertChildren(t.offset,n);var r=new fs(t,t.getShiftedBy(1));this.wrap(r,e);var i=new cs(n.parent,n.getIndex());n.remove();var o=i.nodeBefore,a=i.nodeAfter;return o instanceof os&&a instanceof os?mt(o,a):gt(i)}},{key:"unwrap",value:function(t,e){if(!(e instanceof ws))throw new Bo("view-writer-unwrap-invalid-attribute");if(this.getParentContainer(t.start)!==this.getParentContainer(t.end))throw new Bo("view-writer-invalid-range-container");if(t.isCollapsed)return t;if(t.end.isEqual(t.start.getShiftedBy(1))){var n=t.start.nodeAfter;if(!e.isSimilar(n)&&n instanceof ws&&wt(e,n))return t}var r=this._breakRange(t,!0),i=r.start,o=r.end,a=i.parent,s=vt(this,a,i.offset,o.offset,e),u=this.mergeAttributes(s.start);u.isEqual(s.start)||s.end.offset--;var l=this.mergeAttributes(s.end);return new fs(u,l)}}]),t}(),ks=function(){function t(){wo(this,t),this._ranges=[],this._lastRangeBackward=!1}return _o(t,[{key:"addRange",value:function(t,e){this._pushRange(t),this._lastRangeBackward=!!e,this.fire("change")}},{key:"getRanges",value:regeneratorRuntime.mark(function e(){var t,n,r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,r=void 0,e.prev=3,i=this._ranges[Symbol.iterator]();case 5:if(t=(o=i.next()).done){e.next=12;break}return a=o.value,e.next=9,fs.createFromRange(a);case 9:t=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](3),n=!0,r=e.t0;case 18:e.prev=18,e.prev=19,!t&&i["return"]&&i["return"]();case 21:if(e.prev=21,!n){e.next=24;break}throw r;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25]])})},{key:"getFirstRange",value:function(){var t=null,e=!0,n=!1,r=void 0;try{for(var i,o=this._ranges[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;t&&!a.start.isBefore(t.start)||(t=a)}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}return t?fs.createFromRange(t):null}},{key:"getLastRange",value:function(){var t=null,e=!0,n=!1,r=void 0;try{for(var i,o=this._ranges[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;t&&!a.end.isAfter(t.end)||(t=a)}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}return t?fs.createFromRange(t):null}},{key:"getFirstPosition",value:function(){var t=this.getFirstRange();return t?cs.createFromPosition(t.start):null}},{key:"getLastPosition",value:function(){var t=this.getLastRange();return t?cs.createFromPosition(t.end):null}},{key:"isEqual",value:function(t){var e=this.rangeCount;if(e!=t.rangeCount)return!1;for(var n=0;n<this.rangeCount;n++)if(!this._ranges[n].isEqual(t._ranges[n]))return!1;return this._lastRangeBackward===t._lastRangeBackward}},{key:"removeAllRanges",value:function(){this._ranges.length&&(this._ranges=[],this.fire("change"))}},{key:"setRanges",value:function(t,e){this._ranges=[];var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this._pushRange(s)}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}this._lastRangeBackward=!!e,this.fire("change")}},{key:"setTo",value:function(t){this.removeAllRanges();var e=!0,n=!1,r=void 0;try{for(var i,o=t.getRanges()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this._pushRange(a)}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}this._lastRangeBackward=t._lastRangeBackward,this.fire("change")}},{key:"collapseToStart",value:function(){var t=this.getFirstPosition();null!==t&&(this.setRanges([new fs(t,t)]),this.fire("change"))}},{key:"collapseToEnd",value:function(){var t=this.getLastPosition();null!==t&&(this.setRanges([new fs(t,t)]),this.fire("change"))}},{key:"getEditableElement",value:function(){return this.rangeCount?this.getFirstPosition().getEditableElement():null}},{key:"_pushRange",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this._ranges[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;if(t.isIntersecting(a))throw new Bo("view-selection-range-intersects: Trying to add a range that intersects with another range from selection.",{addedRange:t,intersectingRange:a})}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}this._ranges.push(fs.createFromRange(t))}},{key:"anchor",get:function(){if(!this._ranges.length)return null;var t=this._ranges[this._ranges.length-1],e=this._lastRangeBackward?t.end:t.start;return cs.createFromPosition(e)}},{key:"focus",get:function(){if(!this._ranges.length)return null;var t=this._ranges[this._ranges.length-1],e=this._lastRangeBackward?t.start:t.end;return cs.createFromPosition(e)}},{key:"isCollapsed",get:function(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}},{key:"rangeCount",get:function(){return this._ranges.length}},{key:"isBackward",get:function(){return!this.isCollapsed&&this._lastRangeBackward}}]),t}();K(ks,To);for(var xs=St(),Os=function(t){var e=t.createElement("br");return e.dataset.ckeFiller=!0,e},Ps=function(t){return t.createTextNode(" ")},Ss=7,As="",Cs=0;Cs<Ss;Cs++)As+="​";var Es=new WeakMap,Ts=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];wo(this,t),this.blockFiller=e.blockFiller||Os,this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap}return _o(t,[{key:"bindElements",value:function(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}},{key:"bindDocumentFragments",value:function(t,e){this._domToViewMapping.set(t,e),
this._viewToDomMapping.set(e,t)}},{key:"viewToDom",value:function(t,e){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(t instanceof os)return e.createTextNode(t.data);if(this.getCorrespondingDom(t))return this.getCorrespondingDom(t);var r=void 0;if(t instanceof ys)r=e.createDocumentFragment(),n.bind&&this.bindDocumentFragments(r,t);else{r=e.createElement(t.name),n.bind&&this.bindElements(r,t);var i=!0,o=!1,a=void 0;try{for(var s,u=t.getAttributeKeys()[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;r.setAttribute(l,t.getAttribute(l))}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}}if(n.withChildren||void 0===n.withChildren){var f=!0,h=!1,d=void 0;try{for(var v,y=this.viewChildrenToDom(t,e,n)[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value;r.appendChild(g)}}catch(c){h=!0,d=c}finally{try{!f&&y["return"]&&y["return"]()}finally{if(h)throw d}}}return r}},{key:"viewChildrenToDom",value:regeneratorRuntime.mark(function e(t,n){var r,i,o,a,s,u,l,c,f=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.getFillerOffset&&t.getFillerOffset(),i=0,o=!0,a=!1,s=void 0,e.prev=5,u=t.getChildren()[Symbol.iterator]();case 7:if(o=(l=u.next()).done){e.next=18;break}if(c=l.value,r!==i){e.next=12;break}return e.next=12,this.blockFiller(n);case 12:return e.next=14,this.viewToDom(c,n,f);case 14:i++;case 15:o=!0,e.next=7;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e["catch"](5),a=!0,s=e.t0;case 24:e.prev=24,e.prev=25,!o&&u["return"]&&u["return"]();case 27:if(e.prev=27,!a){e.next=30;break}throw s;case 30:return e.finish(27);case 31:return e.finish(24);case 32:if(r!==i){e.next=35;break}return e.next=35,this.blockFiller(n);case 35:case"end":return e.stop()}},e,this,[[5,20,24,32],[25,,27,31]])})},{key:"viewRangeToDom",value:function(t){var e=this.viewPositionToDom(t.start),n=this.viewPositionToDom(t.end),r=new Range;return r.setStart(e.parent,e.offset),r.setEnd(n.parent,n.offset),r}},{key:"viewPositionToDom",value:function(t){var e=t.parent;if(e instanceof os){var n=this.getCorrespondingDomText(e),r=t.offset;return At(n)&&(r+=Ss),{parent:n,offset:r}}var i=void 0,o=void 0,a=void 0;if(0===t.offset?(i=this.getCorrespondingDom(t.parent),a=i.childNodes[0]):(o=this.getCorrespondingDom(t.nodeBefore),i=o.parentNode,a=o.nextSibling),this.isText(a)&&At(a))return{parent:a,offset:Ss};var s=o?Mt(o)+1:0;return{parent:i,offset:s}}},{key:"domToView",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(Tt(t,this.blockFiller))return null;if(this.isText(t))return Ct(t)?null:new os(Et(t));if(this.getCorrespondingView(t))return this.getCorrespondingView(t);var n=void 0;if(this.isDocumentFragment(t))n=new ys,e.bind&&this.bindDocumentFragments(t,n);else{n=new ss(t.tagName.toLowerCase()),e.bind&&this.bindElements(t,n);for(var r=t.attributes,i=r.length-1;i>=0;i--)n.setAttribute(r[i].name,r[i].value)}if(e.withChildren||void 0===e.withChildren){var o=!0,a=!1,s=void 0;try{for(var u,l=this.domChildrenToView(t,e)[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;n.appendChildren(c)}}catch(f){a=!0,s=f}finally{try{!o&&l["return"]&&l["return"]()}finally{if(a)throw s}}}return n}},{key:"domChildrenToView",value:regeneratorRuntime.mark(function n(t){var e,r,i,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e=0;case 1:if(!(e<t.childNodes.length)){n.next=10;break}if(r=t.childNodes[e],i=this.domToView(r,o),null===i){n.next=7;break}return n.next=7,i;case 7:e++,n.next=1;break;case 10:case"end":return n.stop()}},n,this)})},{key:"domSelectionToView",value:function(t){for(var e=new ks,n=0;n<t.rangeCount;n++){var r=t.getRangeAt(n),i=this.domRangeToView(r);i&&e.addRange(i)}return e}},{key:"domRangeToView",value:function(t){var e=this.domPositionToView(t.startContainer,t.startOffset),n=this.domPositionToView(t.endContainer,t.endOffset);return e&&n?new fs(e,n):null}},{key:"domPositionToView",value:function(t,e){if(Tt(t,this.blockFiller))return this.domPositionToView(t.parentNode,Mt(t));if(this.isText(t)){if(Ct(t))return this.domPositionToView(t.parentNode,Mt(t));var n=this.getCorrespondingViewText(t),r=e;return n?(At(t)&&(r-=Ss,r=r<0?0:r),new cs(n,r)):null}if(0===e){var i=this.getCorrespondingView(t);if(i)return new cs(i,0)}else{var o=this.getCorrespondingView(t.childNodes[e-1]);if(o)return new cs(o.parent,o.getIndex()+1)}return null}},{key:"getCorrespondingView",value:function(t){return this.isElement(t)?this.getCorrespondingViewElement(t):this.isDocumentFragment(t)?this.getCorrespondingViewDocumentFragment(t):this.isText(t)?this.getCorrespondingViewText(t):null}},{key:"getCorrespondingViewElement",value:function(t){return this._domToViewMapping.get(t)}},{key:"getCorrespondingViewDocumentFragment",value:function(t){return this._domToViewMapping.get(t)}},{key:"getCorrespondingViewText",value:function(t){if(Ct(t))return null;var e=t.previousSibling;if(e){if(!this.isElement(e))return null;var n=this.getCorrespondingViewElement(e);if(n){var r=n.getNextSibling();return r instanceof os?n.getNextSibling():null}}else{var i=this.getCorrespondingViewElement(t.parentNode);if(i){var o=i.getChild(0);return o instanceof os?o:null}}return null}},{key:"getCorrespondingDom",value:function(t){return t instanceof ss?this.getCorrespondingDomElement(t):t instanceof ys?this.getCorrespondingDomDocumentFragment(t):t instanceof os?this.getCorrespondingDomText(t):null}},{key:"getCorrespondingDomElement",value:function(t){return this._viewToDomMapping.get(t)}},{key:"getCorrespondingDomDocumentFragment",value:function(t){return this._viewToDomMapping.get(t)}},{key:"getCorrespondingDomText",value:function(t){var e=t.getPreviousSibling();return e&&this.getCorrespondingDom(e)?this.getCorrespondingDom(e).nextSibling:!e&&t.parent&&this.getCorrespondingDom(t.parent)?this.getCorrespondingDom(t.parent).childNodes[0]:null}},{key:"focus",value:function(t){var e=this.getCorrespondingDomElement(t);e&&e.ownerDocument.activeElement!==e&&e.focus()}},{key:"isText",value:function(t){return t&&t.nodeType==Node.TEXT_NODE}},{key:"isElement",value:function(t){return t&&t.nodeType==Node.ELEMENT_NODE}},{key:"isDocumentFragment",value:function(t){return t&&t.nodeType==Node.DOCUMENT_FRAGMENT_NODE}}]),t}(),Rs=function(){function t(e,n){wo(this,t),this.model=e,this.processor=n,this._mapper=new hs,this._writer=new _s,this._domConverter=new Ts({blockFiller:Ps}),this.modelToView=new vs({writer:this._writer,mapper:this._mapper}),this.modelToView.on("insert:$text",it()),this.viewToModel=new ms({schema:e.schema}),this.viewToModel.on("text",dt()),this.viewToModel.on("element",ht(),null,9999),this.viewToModel.on("documentFragment",ht(),null,9999)}return _o(t,[{key:"get",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"main":arguments[0],e=this.model.getRoot(t),n=Ga.createFromElement(e),r=new ys;this._mapper.bindElements(e,r),this.modelToView.convertInsert(n),this._mapper.clearBindings();var i=this._domConverter.viewToDom(r,document);return this.processor.toData(i)}},{key:"set",value:function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]?"main":arguments[1],r=this.model.getRoot(n);this.model.enqueueChanges(function(){e.model.batch("transparent").remove(Ga.createFromElement(r)).insert(rs.createAt(r,0),e.parse(t))})}},{key:"parse",value:function(t){var e=this.processor.toDom(t),n=this._domConverter.domToView(e),r=this.viewToModel.convert(n,{context:["$root"]});return r}},{key:"destroy",value:function(){}}]),t}(),js=Array.prototype,Ms=js.splice;Lt.prototype.clear=Ft,Lt.prototype["delete"]=Nt,Lt.prototype.get=Dt,Lt.prototype.has=It,Lt.prototype.set=Bt;var Fs=Function.prototype.toString,Vs=/[\\^$.*+?()[\]{}|]/g,Ns=/^\[object .+?Constructor\]$/,Ds=Object.prototype,Is=Function.prototype.toString,Bs=Ds.hasOwnProperty,Ls=RegExp("^"+Is.call(Bs).replace(Vs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zs=Jt(Object,"create"),qs="__lodash_hash_undefined__",Hs=Object.prototype,Ws=Hs.hasOwnProperty,Ks=Object.prototype,$s=Ks.hasOwnProperty,Js="__lodash_hash_undefined__";Zt.prototype.clear=Ut,Zt.prototype["delete"]=Xt,Zt.prototype.get=Yt,Zt.prototype.has=Gt,Zt.prototype.set=Qt;var Us=Jt(pa,"Map");se.prototype.clear=te,se.prototype["delete"]=re,se.prototype.get=ie,se.prototype.has=oe,se.prototype.set=ae;var Xs=200;le.prototype.clear=zt,le.prototype["delete"]=qt,le.prototype.get=Ht,le.prototype.has=Wt,le.prototype.set=ue;var Ys=Object.prototype,Gs=Ys.hasOwnProperty,Qs=Object.keys,Zs=Object.getOwnPropertySymbols;Zs||(pe=function(){return[]});var tu=pe,eu=Jt(pa,"DataView"),nu=Jt(pa,"Promise"),ru=Jt(pa,"Set"),iu=Jt(pa,"WeakMap"),ou="[object Map]",au="[object Object]",su="[object Promise]",uu="[object Set]",lu="[object WeakMap]",cu="[object DataView]",fu=Object.prototype,hu=fu.toString,du=Kt(eu),vu=Kt(Us),yu=Kt(nu),gu=Kt(ru),pu=Kt(iu);(eu&&ke(new eu(new ArrayBuffer(1)))!=cu||Us&&ke(new Us)!=ou||nu&&ke(nu.resolve())!=su||ru&&ke(new ru)!=uu||iu&&ke(new iu)!=lu)&&(ke=function(t){var e=hu.call(t),n=e==au?t.constructor:void 0,r=n?Kt(n):void 0;if(r)switch(r){case du:return cu;case vu:return ou;case yu:return su;case gu:return uu;case pu:return lu}return e});var mu=ke,bu=Object.prototype,wu=bu.hasOwnProperty,_u=pa.Uint8Array,ku=/\w*$/,xu=pa.Symbol,Ou=xu?xu.prototype:void 0,Pu=Ou?Ou.valueOf:void 0,Su="[object Boolean]",Au="[object Date]",Cu="[object Map]",Eu="[object Number]",Tu="[object RegExp]",Ru="[object Set]",ju="[object String]",Mu="[object Symbol]",Fu="[object ArrayBuffer]",Vu="[object DataView]",Nu="[object Float32Array]",Du="[object Float64Array]",Iu="[object Int8Array]",Bu="[object Int16Array]",Lu="[object Int32Array]",zu="[object Uint8Array]",qu="[object Uint8ClampedArray]",Hu="[object Uint16Array]",Wu="[object Uint32Array]",Ku=Object.create,$u={"function":!0,object:!0},Ju=$u["undefined"==typeof exports?"undefined":bo(exports)]&&exports&&!exports.nodeType?exports:void 0,Uu=$u["undefined"==typeof module?"undefined":bo(module)]&&module&&!module.nodeType?module:void 0,Xu=Uu&&Uu.exports===Ju?Ju:void 0,Yu=Xu?pa.Buffer:void 0,Gu=Yu?function(t){return t instanceof Yu}:Be(!1),Qu="[object Arguments]",Zu="[object Array]",tl="[object Boolean]",el="[object Date]",nl="[object Error]",rl="[object Function]",il="[object GeneratorFunction]",ol="[object Map]",al="[object Number]",sl="[object Object]",ul="[object RegExp]",ll="[object Set]",cl="[object String]",fl="[object Symbol]",hl="[object WeakMap]",dl="[object ArrayBuffer]",vl="[object DataView]",yl="[object Float32Array]",gl="[object Float64Array]",pl="[object Int8Array]",ml="[object Int16Array]",bl="[object Int32Array]",wl="[object Uint8Array]",_l="[object Uint8ClampedArray]",kl="[object Uint16Array]",xl="[object Uint32Array]",Ol={};Ol[Qu]=Ol[Zu]=Ol[dl]=Ol[vl]=Ol[tl]=Ol[el]=Ol[yl]=Ol[gl]=Ol[pl]=Ol[ml]=Ol[bl]=Ol[ol]=Ol[al]=Ol[sl]=Ol[ul]=Ol[ll]=Ol[cl]=Ol[fl]=Ol[wl]=Ol[_l]=Ol[kl]=Ol[xl]=!0,Ol[nl]=Ol[rl]=Ol[hl]=!1;var Pl=function(){function t(e){wo(this,t),this.baseVersion=e}return _o(t,[{key:"toJSON",value:function(){var t=ze(this,!0);return t.__className=this.constructor.className,delete t.delta,t}}],[{key:"fromJSON",value:function(e){return new t(e.baseVersion)}},{key:"className",get:function(){return"engine.model.operation.Operation"}}]),t}(),Sl=function(t){function e(t,n,r,i,o){wo(this,e);var a=Oo(this,Object.getPrototypeOf(e).call(this,o));return a.range=Ga.createFromRange(t),a.key=n,a.oldValue=r,a.newValue=i,a}return xo(e,t),_o(e,[{key:"clone",value:function(){return new e(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}},{key:"getReversed",value:function(){return new e(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}},{key:"_execute",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.range.getItems()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;if(null!==this.oldValue&&o.getAttribute(this.key)!==this.oldValue)throw new Bo("operation-attribute-no-attr-to-remove: The attribute which should be removed does not exists for given node.",{item:o,key:this.key});if(null===this.oldValue&&null!==this.newValue&&o.hasAttribute(this.key))throw new Bo("operation-attribute-attr-exists: The attribute with given key already exists.",{node:o,key:this.key});null!==this.newValue?o.setAttribute(this.key,this.newValue):o.removeAttribute(this.key)}}catch(a){e=!0,n=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}return{range:this.range,key:this.key,oldValue:this.oldValue,newValue:this.newValue}}},{key:"type",get:function(){return null===this.oldValue?"addAttribute":null===this.newValue?"removeAttribute":"changeAttribute"}}],[{key:"fromJSON",value:function(t,n){return new e(Ga.fromJSON(t.range,n),t.key,t.oldValue,t.newValue,t.baseVersion)}},{key:"className",get:function(){return"engine.model.operation.AttributeOperation"}}]),e}(Pl),Al=function(t){function e(t,n,r,i){wo(this,e);var o=Oo(this,Object.getPrototypeOf(e).call(this,i));return o.sourcePosition=rs.createFromPosition(t),o.howMany=n,o.targetPosition=rs.createFromPosition(r),o.movedRangeStart=o.targetPosition.getTransformedByDeletion(o.sourcePosition,o.howMany),o.isSticky=!1,o}return xo(e,t),_o(e,[{key:"clone",value:function(){var t=new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion);return t.isSticky=this.isSticky,t}},{key:"getReversed",value:function(){var t=this.sourcePosition.getTransformedByInsertion(this.targetPosition,this.howMany),e=new this.constructor(this.movedRangeStart,this.howMany,t,this.baseVersion+1);return e.isSticky=this.isSticky,e}},{key:"_execute",value:function(){var t=this.sourcePosition.parent,e=this.targetPosition.parent,n=this.sourcePosition.offset,r=this.targetPosition.offset;if(!t||!e)throw new Bo("operation-move-position-invalid: Source position or target position is invalid.");if(n+this.howMany>t.getChildCount())throw new Bo("operation-move-nodes-do-not-exist: The nodes which should be moved do not exist.");if(t===e&&n<r&&r<n+this.howMany)throw new Bo("operation-move-range-into-itself: Trying to move a range of nodes to the inside of that range.");if(this.sourcePosition.root==this.targetPosition.root&&"PREFIX"==Y(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){var i=this.sourcePosition.path.length-1;if(this.targetPosition.path[i]>=n&&this.targetPosition.path[i]<n+this.howMany)throw new Bo("operation-move-node-into-itself: Trying to move a range of nodes into one of nodes from that range.")}t===e&&n<r&&(r-=this.howMany);var o=t.removeChildren(n,this.howMany);return e.insertChildren(r,o),{sourcePosition:this.sourcePosition,range:Ga.createFromPositionAndShift(this.movedRangeStart,this.howMany)}}},{key:"type",get:function(){return"move"}}],[{key:"fromJSON",value:function(t,n){var r=rs.fromJSON(t.sourcePosition,n),i=rs.fromJSON(t.targetPosition,n);return new e(r,t.howMany,i,t.baseVersion)}},{key:"className",get:function(){return"engine.model.operation.MoveOperation"}}]),e}(Pl),Cl=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"getReversed",value:function(){return new El(this.targetPosition,this.howMany,this.baseVersion+1)}},{key:"position",get:function(){return this.targetPosition},set:function(t){this.targetPosition=t}},{key:"type",get:function(){return"reinsert"}}],[{key:"className",get:function(){return"engine.model.operation.ReinsertOperation"}}]),e}(Al),El=function(t){function e(t,n,r){wo(this,e);var i=t.root.document.graveyard;return Oo(this,Object.getPrototypeOf(e).call(this,t,n,new rs(i,[i.getChildCount(),0]),r))}return xo(e,t),_o(e,[{key:"getReversed",value:function(){return new Cl(this.targetPosition,this.howMany,this.sourcePosition,this.baseVersion+1)}},{key:"clone",value:function(){var t=new e(this.sourcePosition,this.howMany,this.baseVersion);return t.targetPosition=rs.createFromPosition(this.targetPosition),t.movedRangeStart=rs.createFromPosition(this.movedRangeStart),t}},{key:"_execute",value:function(){if(this._needsHolderElement){var t=this.targetPosition.root,n=new Qa("$graveyardHolder");t.insertChildren(this.targetPosition.path[0],n)}return ko(Object.getPrototypeOf(e.prototype),"_execute",this).call(this)}},{key:"type",get:function(){return"remove"}},{key:"_holderElementOffset",get:function(){return this.targetPosition.path[0]},set:function(t){this.targetPosition.path[0]=t}},{key:"_needsHolderElement",get:function(){if(this.delta){var t=!0,n=!1,r=void 0;try{for(var i,o=this.delta.operations[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a instanceof e){if(a==this)return!0;if(a._holderElementOffset==this._holderElementOffset)return!1}}}catch(s){n=!0,r=s}finally{try{!t&&o["return"]&&o["return"]()}finally{if(n)throw r}}}return!0}}],[{key:"className",get:function(){return"engine.model.operation.RemoveOperation"}}]),e}(Al),Tl=function(t){function e(t,n,r){wo(this,e);var i=Oo(this,Object.getPrototypeOf(e).call(this,r));return i.position=rs.createFromPosition(t),i.nodeList=new es(n),i}return xo(e,t),_o(e,[{key:"clone",value:function(){return new e(this.position,this.nodeList,this.baseVersion)}},{key:"getReversed",value:function(){return new El(this.position,this.nodeList.length,this.baseVersion+1)}},{key:"_execute",value:function(){return this.position.parent.insertChildren(this.position.offset,this.nodeList),{range:Ga.createFromPositionAndShift(this.position,this.nodeList.length)}}},{key:"type",get:function(){return"insert"}}],[{key:"fromJSON",value:function(t,n){return new e(rs.fromJSON(t.position,n),es.fromJSON(t.nodeList),t.baseVersion)}},{key:"className",get:function(){return"engine.model.operation.InsertOperation"}}]),e}(Pl),Rl=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"clone",value:function(){return new e(this.baseVersion)}},{key:"getReversed",value:function(){return new e(this.baseVersion+1)}},{key:"_execute",value:function(){}}],[{key:"className",get:function(){return"engine.model.operation.NoOperation"}}]),e}(Pl),jl=function(t){function e(t,n,r,i,o){wo(this,e);var a=Oo(this,Object.getPrototypeOf(e).call(this,o));return a.root=t,a.key=n,a.oldValue=r,a.newValue=i,a}return xo(e,t),_o(e,[{key:"clone",value:function(){return new e(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}},{key:"getReversed",value:function(){return new e(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}},{key:"_execute",value:function(){if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new Bo("operation-rootattribute-no-attr-to-remove: The attribute which should be removed does not exists for given node.",{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new Bo("operation-rootattribute-attr-exists: The attribute with given key already exists.",{root:this.root,key:this.key});return null!==this.newValue?this.root.setAttribute(this.key,this.newValue):this.root.removeAttribute(this.key),{root:this.root,key:this.key,oldValue:this.oldValue,newValue:this.newValue}}},{key:"type",get:function(){return null===this.oldValue?"addRootAttribute":null===this.newValue?"removeRootAttribute":"changeRootAttribute"}}],[{key:"fromJSON",value:function(t,n){if(!n.hasRoot(t.root))throw new Bo("rootattributeoperation-fromjson-no-root: Cannot create RootAttributeOperation. Root with specified name does not exist.",{rootName:t});return new e(n.getRoot(t.root),t.key,t.oldValue,t.newValue,t.baseVersion)}},{key:"className",get:function(){return"engine.model.operation.RootAttributeOperation"}}]),e}(Pl),Ml={};Ml[Sl.className]=Sl,Ml[Tl.className]=Tl,Ml[Al.className]=Al,Ml[Rl.className]=Rl,Ml[Pl.className]=Pl,Ml[Cl.className]=Cl,Ml[El.className]=El,Ml[jl.className]=jl;var Fl=function(){function t(){wo(this,t)}return _o(t,null,[{key:"fromJSON",value:function(t,e){return Ml[t.__className].fromJSON(t,e)}}]),t}(),Vl=new Map,Nl=function(){function t(){wo(this,t)}return _o(t,null,[{key:"fromJSON",value:function(t,e){if(!Vl.has(t.__className))throw new Bo("delta-fromjson-no-deserializer: This delta has no defined deserializer",{name:t.__className});var n=Vl.get(t.__className),r=new n,i=!0,o=!1,a=void 0;try{for(var s,u=t.operations[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;r.addOperation(Fl.fromJSON(l,e))}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return r}},{key:"register",value:function(t){Vl.set(t.className,t)}}]),t}(),Dl=function(){function t(){wo(this,t),this.batch=null,this.operations=[]}return _o(t,[{key:"addOperation",value:function(t){return t.delta=this,this.operations.push(t),t}},{key:"clone",value:function(){var t=new this.constructor,e=!0,n=!1,r=void 0;try{for(var i,o=this.operations[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;t.addOperation(a.clone())}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}return t}},{key:"getReversed",value:function(){var t=new this._reverseDeltaClass,e=!0,n=!1,r=void 0;try{for(var i,o=this.operations[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;t.addOperation(a.getReversed())}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}t.operations.reverse();for(var u=0;u<t.operations.length;u++)t.operations[u].baseVersion=this.operations[this.operations.length-1].baseVersion+u+1;return t}},{key:"toJSON",value:function(){var t=ze(this);return t.__className=this.constructor.className,delete t.batch,t}},{key:"baseVersion",get:function(){return this.operations.length>0?this.operations[0].baseVersion:null},set:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.operations[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;a.baseVersion=t++}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}}},{key:"_reverseDeltaClass",get:function(){return t}}],[{key:"className",get:function(){return"engine.model.delta.Delta"}},{key:"_priority",get:function(){return 0}}]),t}();Nl.register(Dl);var Il=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?"default":arguments[1];wo(this,t),this.doc=e,this.deltas=[],this.type=n}return _o(t,[{key:"addDelta",value:function(t){return t.batch=this,this.deltas.push(t),t}},{key:"getOperations",value:regeneratorRuntime.mark(function e(){var t,n,r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,r=void 0,e.prev=3,i=this.deltas[Symbol.iterator]();case 5:if(t=(o=i.next()).done){e.next=11;break}return a=o.value,e.delegateYield(a.operations,"t0",8);case 8:t=!0,e.next=5;break;case 11:e.next=17;break;case 13:e.prev=13,e.t1=e["catch"](3),n=!0,r=e.t1;case 17:e.prev=17,e.prev=18,!t&&i["return"]&&i["return"]();case 20:if(e.prev=20,!n){e.next=23;break}throw r;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}},e,this,[[3,13,17,25],[18,,20,24]])})},{key:"baseVersion",get:function(){return this.deltas.length>0?this.deltas[0].baseVersion:null}}]),t}(),Bl=function(t){function e(t,n){var r=arguments.length<=2||void 0===arguments[2]?"main":arguments[2];wo(this,e);var i=Oo(this,Object.getPrototypeOf(e).call(this,n));return i.document=t,i.rootName=r,i}return xo(e,t),_o(e,[{key:"toJSON",value:function(){return this.rootName}}]),e}(Qa),Ll=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"key",get:function(){return this.operations[0]?this.operations[0].key:null}},{key:"value",get:function(){return this.operations[0]?this.operations[0].newValue:null}},{key:"range",get:function(){if(this._range)return this._range;var t=this.operations[0],e=this.operations[this.operations.length-1];return t?(this._range=new Ga(t.range.start,e.range.end),this._range):null}},{key:"_reverseDeltaClass",get:function(){return e}}],[{key:"className",get:function(){return"engine.model.delta.AttributeDelta"}},{key:"_priority",get:function(){return 20}}]),e}(Dl),zl=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,null,[{key:"className",get:function(){return"engine.model.delta.RootAttributeDelta"}}]),e}(Dl);qe("setAttr",function(t,e,n){return He(this,t,e,n),this}),qe("removeAttr",function(t,e){return He(this,t,null,e),this}),Nl.register(Ll),Nl.register(zl);var ql=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"howMany",get:function(){return this._moveOperation?this._moveOperation.howMany:null}},{key:"sourcePosition",get:function(){return this._moveOperation?this._moveOperation.sourcePosition:null}},{key:"targetPosition",get:function(){return this._moveOperation?this._moveOperation.targetPosition:null}},{key:"_moveOperation",get:function(){return this.operations[0]||null}},{key:"_reverseDeltaClass",get:function(){return e}}],[{key:"className",get:function(){return"engine.model.delta.MoveDelta"}},{key:"_priority",get:function(){return 20}}]),e}(Dl);qe("move",function(t,e){var n=new ql;if(this.addDelta(n),t instanceof Ga){if(!t.isFlat)throw new Bo("batch-move-range-not-flat: Range to move is not flat.");$e(this,n,t.start,t.end.offset-t.start.offset,e)}else $e(this,n,rs.createBefore(t),1,e);return this}),Nl.register(ql);var Hl=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,null,[{key:"className",get:function(){return"engine.model.delta.RemoveDelta"}}]),e}(ql);qe("remove",function(t){var e=new Hl;if(this.addDelta(e),t instanceof Ga){var n=t.getMinimalFlatRanges().reverse(),r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;Je(this,e,u.start,u.end.offset-u.start.offset)}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}else Je(this,e,rs.createBefore(t),1);return this}),Nl.register(Hl);var Wl=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"position",get:function(){return this._insertOperation?this._insertOperation.position:null}},{key:"nodeList",get:function(){return this._insertOperation?this._insertOperation.nodeList:null}},{key:"_insertOperation",get:function(){return this.operations[0]||null}},{key:"_reverseDeltaClass",get:function(){return Hl}}],[{key:"className",get:function(){return"engine.model.delta.InsertDelta"}},{key:"_priority",get:function(){return 20}}]),e}(Dl);qe("insert",function(t,e){var n=new Wl,r=new Tl(t,e,this.doc.version);return this.addDelta(n),n.addOperation(r),this.doc.applyOperation(r),this}),Nl.register(Wl);var Kl=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"getReversed",value:function(){var t=ko(Object.getPrototypeOf(e.prototype),"getReversed",this).call(this);return t.operations.length>0&&(t.operations[0].isSticky=!0),t}},{key:"position",get:function(){return this._moveOperation?this._moveOperation.sourcePosition:null}},{key:"_cloneOperation",get:function(){return this.operations[0]||null}},{key:"_moveOperation",get:function(){return this.operations[1]||null}},{key:"_reverseDeltaClass",get:function(){return $l}}],[{key:"className",get:function(){return"engine.model.delta.SplitDelta"}},{key:"_priority",get:function(){return 5}}]),e}(Dl);qe("split",function(t){var e=new Kl;this.addDelta(e);var n=t.parent;if(!n.parent)throw new Bo("batch-split-root: Root element can not be split.");var r=new Qa(n.name,n._attrs),i=new Tl(rs.createAfter(n),r,this.doc.version);e.addOperation(i),this.doc.applyOperation(i);var o=new Al(t,n.getChildCount()-t.offset,rs.createFromParentAndOffset(r,0),this.doc.version);return o.isSticky=!0,e.addOperation(o),this.doc.applyOperation(o),this}),Nl.register(Kl);var $l=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"getReversed",value:function(){var t=ko(Object.getPrototypeOf(e.prototype),"getReversed",this).call(this);return t.operations.length>0&&(t.operations[1].isSticky=!1),t}},{key:"position",get:function(){return this._removeOperation?this._removeOperation.sourcePosition:null}},{key:"_removeOperation",get:function(){return this.operations[1]||null}},{key:"_reverseDeltaClass",get:function(){return Kl}}],[{key:"className",get:function(){return"engine.model.delta.MergeDelta"}}]),e}(Dl);qe("merge",function(t){var e=new $l;this.addDelta(e);var n=t.nodeBefore,r=t.nodeAfter;if(!(n instanceof Qa))throw new Bo("batch-merge-no-element-before: Node before merge position must be an element.");if(!(r instanceof Qa))throw new Bo("batch-merge-no-element-after: Node after merge position must be an element.");var i=rs.createFromParentAndOffset(r,0),o=rs.createFromParentAndOffset(n,n.getChildCount()),a=new Al(i,r.getChildCount(),o,this.doc.version);a.isSticky=!0,e.addOperation(a),this.doc.applyOperation(a);var s=new El(t,1,this.doc.version);return e.addOperation(s),this.doc.applyOperation(s),this}),Nl.register($l);var Jl=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"_reverseDeltaClass",get:function(){return e}}],[{key:"className",get:function(){return"engine.model.delta.RenameDelta"}}]),e}(Dl);qe("rename",function(t,e){var n=new Jl,r=new Qa(t);return Ue(this,n,new Tl(rs.createAfter(e),r,this.doc.version)),Ue(this,n,new Al(rs.createAt(e),e.getChildCount(),rs.createAt(r),this.doc.version)),Ue(this,n,new El(rs.createBefore(e),1,this.doc.version)),this}),Nl.register(Jl);var Ul=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"range",get:function(){var t=this._moveOperation;return t?Ga.createFromPositionAndShift(t.sourcePosition,t.howMany):null}},{key:"howMany",get:function(){var t=this.range;return t?t.end.offset-t.start.offset:0}},{key:"_insertOperation",get:function(){return this.operations[0]||null}},{key:"_moveOperation",get:function(){return this.operations[1]||null}},{key:"_reverseDeltaClass",get:function(){return Xl}}],[{key:"className",get:function(){return"engine.model.delta.WrapDelta"}},{key:"_priority",get:function(){return 10}}]),e}(Dl);qe("wrap",function(t,e){if(!t.isFlat)throw new Bo("batch-wrap-range-not-flat: Range to wrap is not flat.");var n=e instanceof Qa?e:new Qa(e);if(n.getChildCount()>0)throw new Bo("batch-wrap-element-not-empty: Element to wrap with is not empty.");if(null!==n.parent)throw new Bo("batch-wrap-element-attached: Element to wrap with is already attached to tree model.");var r=new Ul;this.addDelta(r);var i=new Tl(t.end,n,this.doc.version);r.addOperation(i),this.doc.applyOperation(i);var o=rs.createFromParentAndOffset(n,0),a=new Al(t.start,t.end.offset-t.start.offset,o,this.doc.version);return r.addOperation(a),this.doc.applyOperation(a),this}),Nl.register(Ul);var Xl=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"position",get:function(){return this._moveOperation?this._moveOperation.targetPosition:null}},{key:"_moveOperation",get:function(){return this.operations[0]||null}},{key:"_reverseDeltaClass",get:function(){return Ul}}],[{key:"className",get:function(){return"engine.model.delta.UnwrapDelta"}},{key:"_priority",get:function(){return 10}}]),e}(Dl);qe("unwrap",function(t){if(null===t.parent)throw new Bo("batch-unwrap-element-no-parent: Trying to unwrap an element that has no parent.");var e=new Xl;this.addDelta(e);var n=rs.createFromParentAndOffset(t,0),r=new Al(n,t.getChildCount(),rs.createBefore(t),this.doc.version);r.isSticky=!0,e.addOperation(r),this.doc.applyOperation(r);
var i=new El(rs.createBefore(t),1,this.doc.version);return e.addOperation(i),this.doc.applyOperation(i),this}),Nl.register(Xl);var Yl=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,null,[{key:"className",get:function(){return"engine.model.delta.WeakInsertDelta"}}]),e}(Wl);qe("weakInsert",function(t,e){var n=new Yl;this.addDelta(n),e=new es(e);var r=!0,i=!1,o=void 0;try{for(var a,s=e._nodes[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u._attrs=new Map(this.doc.selection.getAttributes())}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}var c=new Tl(t,e,this.doc.version);return n.addOperation(c),this.doc.applyOperation(c),this}),Nl.register(Yl);var Gl="__lodash_hash_undefined__";Ge.prototype.add=Ge.prototype.push=Xe,Ge.prototype.has=Ye;var Ql=1,Zl=2,tc=1,ec=2,nc="[object Boolean]",rc="[object Date]",ic="[object Error]",oc="[object Map]",ac="[object Number]",sc="[object RegExp]",uc="[object Set]",lc="[object String]",cc="[object Symbol]",fc="[object ArrayBuffer]",hc="[object DataView]",dc=xu?xu.prototype:void 0,vc=dc?dc.valueOf:void 0,yc=2,gc="[object Arguments]",pc="[object Array]",mc="[object Boolean]",bc="[object Date]",wc="[object Error]",_c="[object Function]",kc="[object Map]",xc="[object Number]",Oc="[object Object]",Pc="[object RegExp]",Sc="[object Set]",Ac="[object String]",Cc="[object WeakMap]",Ec="[object ArrayBuffer]",Tc="[object DataView]",Rc="[object Float32Array]",jc="[object Float64Array]",Mc="[object Int8Array]",Fc="[object Int16Array]",Vc="[object Int32Array]",Nc="[object Uint8Array]",Dc="[object Uint8ClampedArray]",Ic="[object Uint16Array]",Bc="[object Uint32Array]",Lc={};Lc[Rc]=Lc[jc]=Lc[Mc]=Lc[Fc]=Lc[Vc]=Lc[Nc]=Lc[Dc]=Lc[Ic]=Lc[Bc]=!0,Lc[gc]=Lc[pc]=Lc[Ec]=Lc[mc]=Lc[Tc]=Lc[bc]=Lc[wc]=Lc[_c]=Lc[kc]=Lc[xc]=Lc[Oc]=Lc[Pc]=Lc[Sc]=Lc[Ac]=Lc[Cc]=!1;var zc=Object.prototype,qc=zc.toString,Hc=2,Wc="[object Arguments]",Kc="[object Array]",$c="[object Object]",Jc=Object.prototype,Uc=Jc.hasOwnProperty,Xc={InsertOperation:{InsertOperation:function(t,e,n){var r=t.clone();return r.position=r.position.getTransformedByInsertion(e.position,e.nodeList.length,!n),[r]},AttributeOperation:un,RootAttributeOperation:un,MoveOperation:function(t,e,n){var r=t.clone();return r.position=t.position.getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany,!n,e.isSticky),[r]}},AttributeOperation:{InsertOperation:function(t,e){var n=t.range.getTransformedByInsertion(e.position,e.nodeList.length,!0,!1);return n.reverse().map(function(e){return new Sl(e,t.key,t.oldValue,t.newValue,t.baseVersion)})},AttributeOperation:function(t,e,n){if(t.key===e.key){var r=t.range.getDifference(e.range).map(function(e){return new Sl(e,t.key,t.oldValue,t.newValue,t.baseVersion)});if(n&&!an(t.newValue,e.newValue)){var i=t.range.getIntersection(e.range);null!==i&&r.push(new Sl(i,e.key,e.oldValue,t.newValue,t.baseVersion))}return 0===r.length&&r.push(new Rl(t.baseVersion)),r}return[t.clone()]},RootAttributeOperation:un,MoveOperation:function(t,e){var n=Ga.createFromPositionAndShift(e.sourcePosition,e.howMany),r=[];e instanceof El&&e._needsHolderElement&&t.range.root==e.targetPosition.root&&t.range.start.path[0]>=e._holderElementOffset&&(t=t.clone(),t.range.start.path[0]++,t.range.end.path[0]++);var i=fn(t.range.getDifference(n)),o=t.range.getIntersection(n);return null!==i&&(i.start=i.start.getTransformedByDeletion(e.sourcePosition,e.howMany),i.end=i.end.getTransformedByDeletion(e.sourcePosition,e.howMany),r=i.getTransformedByInsertion(e.movedRangeStart,e.howMany,!0,!1).reverse()),null!==o&&(o.start=o.start._getCombined(e.sourcePosition,e.movedRangeStart),o.end=o.end._getCombined(e.sourcePosition,e.movedRangeStart),r.push(o)),r.map(function(e){return new Sl(e,t.key,t.oldValue,t.newValue,t.baseVersion)})}},RootAttributeOperation:{InsertOperation:un,AttributeOperation:un,RootAttributeOperation:function(t,e,n){return t.root!==e.root||t.key!==e.key||(t.newValue===e.newValue||n)&&t.newValue!==e.newValue?[t.clone()]:[new Rl(t.baseVersion)]},MoveOperation:un},MoveOperation:{InsertOperation:function(t,e,n){var r=Ga.createFromPositionAndShift(t.sourcePosition,t.howMany);r=r.getTransformedByInsertion(e.position,e.nodeList.length,!1,t.isSticky)[0];var i=new t.constructor(r.start,r.end.offset-r.start.offset,t instanceof El?t.baseVersion:t.targetPosition.getTransformedByInsertion(e.position,e.nodeList.length,!n),t instanceof El?void 0:t.baseVersion);return i.isSticky=t.isSticky,[i]},AttributeOperation:un,RootAttributeOperation:un,MoveOperation:function(t,e,n){if(cn(t,e)&&cn(e,t))return[e.getReversed()];if(t instanceof El&&e instanceof El&&e._needsHolderElement){var r=t.targetPosition.path[0],i=e.targetPosition.path[0];(r>i||r==i&&n)&&(t=t.clone(),t.targetPosition.path[0]++)}t instanceof El&&!(e instanceof El)?n=!0:!(t instanceof El)&&e instanceof El&&(n=!1);var o=Ga.createFromPositionAndShift(t.sourcePosition,t.howMany),a=Ga.createFromPositionAndShift(e.sourcePosition,e.howMany),s=[],u=fn(o.getDifference(a));u&&(u.start=u.start.getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany,!t.isSticky,!1),u.end=u.end.getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany,t.isSticky,!1),s.push(u));var l=o.getIntersection(a),c=Y(t.sourcePosition.getParentPath(),e.sourcePosition.getParentPath()),f=o.containsPosition(e.targetPosition)||o.start.isEqual(e.targetPosition)&&t.isSticky||o.end.isEqual(e.targetPosition)&&t.isSticky,h=a.containsRange(o)&&(a.containsPosition(t.targetPosition)||a.start.isEqual(t.targetPosition)||a.end.isEqual(t.targetPosition));if(null!==l&&("EXTENSION"===c||"SAME"===c&&n||h)&&!f&&(l.start=l.start._getCombined(e.sourcePosition,e.movedRangeStart),l.end=l.end._getCombined(e.sourcePosition,e.movedRangeStart),u&&u.start.isBefore(l.start)?s.push(l):s.unshift(l)),0===s.length)return[new Rl(t.baseVersion)];var d=t.targetPosition.getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany,!n,e.isSticky||h);return s.reverse().map(function(e){var n=new t.constructor(e.start,e.end.offset-e.start.offset,t instanceof El?t.baseVersion:d,t instanceof El?void 0:t.baseVersion);return n.isSticky=t.isSticky,n._holderElementOffset=t._holderElementOffset,n})}}},Yc=Math.ceil,Gc=Math.max,Qc=200,Zc=P(function(t,e){return j(t)?Pn(t,gn(e,1,j,!0)):[]}),tf=1,ef=2,nf="[object Map]",rf="[object Set]",of=Tn(de),af="Expected a function";Fn.Cache=se;var sf=1/0,uf=xu?xu.prototype:void 0,lf=uf?uf.toString:void 0,cf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,ff=/\\(\\)?/g,hf=Fn(function(t){var e=[];return Nn(t).replace(cf,function(t,n,r,i){e.push(r?i.replace(ff,"$1"):n||t)}),e}),df=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vf=/^\w*$/,yf=1/0,gf=1,pf=2,mf=P(function(t,e){var n=tt(e);return j(n)&&(n=void 0),j(t)?Pn(t,gn(e,1,j,!0),Xn(n)):[]}),bf=P(function(t,e){var n=tt(e);return j(n)&&(n=void 0),j(t)?Pn(t,gn(e,1,j,!0),void 0,n):[]}),wf=4294967295,_f=1/0,kf=Math.max,xf=Math.min,Of=P(function(t){var e=kn(t,gr);return e.length&&e[0]===t[0]?yr(e):[]}),Pf=P(function(t){var e=tt(t),n=kn(t,gr);return e===tt(n)?e=void 0:n.pop(),n.length&&n[0]===t[0]?yr(n,Xn(e)):[]}),Sf=P(function(t){var e=tt(t),n=kn(t,gr);return e===tt(n)?e=void 0:n.pop(),n.length&&n[0]===t[0]?yr(n,void 0,e):[]}),Af=Array.prototype,Cf=Af.join,Ef=Math.max,Tf=Math.min,Rf=Array.prototype,jf=Rf.splice,Mf=P(xr),Ff=Array.prototype,Vf=Ff.splice,Nf=P(function(t,e){e=gn(e,1);var n=t?t.length:0,r=Sr(t,e);return Cr(t,kn(e,function(t){return m(t,n)?+t:t}).sort(Er)),r}),Df=Array.prototype,If=Df.reverse,Bf=4294967295,Lf=Bf-1,zf=Math.floor,qf=Math.min,Hf=4294967295,Wf=Hf>>>1,Kf=1/0,$f=ru&&1/je(new ru([,-0]))[1]==Kf?function(t){return new ru(t)}:Xr,Jf=200,Uf=P(function(t){return Yr(gn(t,1,j,!0))}),Xf=P(function(t){var e=tt(t);return j(e)&&(e=void 0),Yr(gn(t,1,j,!0),Xn(e))}),Yf=P(function(t){var e=tt(t);return j(e)&&(e=void 0),Yr(gn(t,1,j,!0),void 0,e)}),Gf=Math.max,Qf=P(function(t,e){return j(t)?Pn(t,e):[]}),Zf=P(function(t){return ri(ti(t,j))}),th=P(function(t){var e=tt(t);return j(e)&&(e=void 0),ri(ti(t,j),Xn(e))}),eh=P(function(t){var e=tt(t);return j(e)&&(e=void 0),ri(ti(t,j),void 0,e)}),nh=P(ei),rh=P(function(t){var e=t.length,n=e>1?t[e-1]:void 0;return n="function"==typeof n?(t.pop(),n):void 0,ni(t,n)}),ih={chunk:dn,compact:vn,concat:pn,difference:Zc,differenceBy:mf,differenceWith:bf,drop:Yn,dropRight:Gn,dropRightWhile:Zn,dropWhile:tr,fill:ir,findIndex:ar,findLastIndex:sr,first:ur,flatten:lr,flattenDeep:cr,flattenDepth:fr,fromPairs:hr,head:ur,indexOf:dr,initial:vr,intersection:Of,intersectionBy:Pf,intersectionWith:Sf,join:pr,last:tt,lastIndexOf:mr,nth:wr,pull:Mf,pullAll:xr,pullAllBy:Or,pullAllWith:Pr,pullAt:Nf,remove:Tr,reverse:Rr,slice:jr,sortedIndex:Vr,sortedIndexBy:Nr,sortedIndexOf:Dr,sortedLastIndex:Ir,sortedLastIndexBy:Br,sortedLastIndexOf:Lr,sortedUniq:qr,sortedUniqBy:Hr,tail:Wr,take:Kr,takeRight:$r,takeRightWhile:Jr,takeWhile:Ur,union:Uf,unionBy:Xf,unionWith:Yf,uniq:Gr,uniqBy:Qr,uniqWith:Zr,unzip:ei,unzipWith:ni,without:Qf,xor:Zf,xorBy:th,xorWith:eh,zip:nh,zipObject:oi,zipObjectDeep:si,zipWith:rh},oh=new Map;fi(Ll,Yl,function(t,e,n){var r=ci(t,e,n);return t.range.containsPosition(e.position)&&r.push(vi(e,t)),r}),fi(Wl,$l,function(t,e,n){return t.position.isEqual(e.position)?[e.getReversed(),t.clone()]:ci(t,e,n)}),fi(ql,$l,function(t,e,n){var r=t.sourcePosition.root==e.position.root&&"SAME"===Y(t.sourcePosition.getParentPath(),e.position.getParentPath()),i=t.sourcePosition.offset<=e.position.offset&&t.sourcePosition.offset+t.howMany>e.position.offset;return r&&i?[e.getReversed(),t.clone()]:ci(t,e,n)}),fi($l,Wl,function(t,e,n){return t.position.isEqual(e.position)?[yi()]:ci(t,e,n)}),fi($l,ql,function(t,e,n){var r=t.position.root==e.sourcePosition.root&&"SAME"===Y(t.position.getParentPath(),e.sourcePosition.getParentPath()),i=e.sourcePosition.offset<=t.position.offset&&e.sourcePosition.offset+e.howMany>t.position.offset;return r&&i?[yi()]:ci(t,e,n)}),fi(Kl,Kl,function(t,e,n){var r=t.position.getParentPath(),i=e.position.getParentPath();if("SAME"==Y(r,i)){if(t.position.offset==e.position.offset)return[yi()];if(t.position.offset<e.position.offset){var o=t.clone();return o._moveOperation.howMany=e.position.offset-t.position.offset,t._cloneOperation instanceof Cl&&e._cloneOperation instanceof Cl&&t._cloneOperation.sourcePosition.offset>e._cloneOperation.sourcePosition.offset&&o._cloneOperation.sourcePosition.offset--,[o]}var a=t.clone();return a._cloneOperation.position.offset++,a._moveOperation.sourcePosition.path[a._moveOperation.sourcePosition.path.length-2]++,a._moveOperation.targetPosition.path[a._moveOperation.targetPosition.path.length-2]++,a._moveOperation.sourcePosition.offset=t.position.offset-e.position.offset,t._cloneOperation instanceof Cl&&e._cloneOperation instanceof Cl&&t._cloneOperation.sourcePosition.offset>e._cloneOperation.sourcePosition.offset&&a._cloneOperation.sourcePosition.offset--,[a]}return ci(t,e,n)}),fi(Kl,Xl,function(t,e,n){return"SAME"===Y(e.position.path,t.position.getParentPath())?[yi()]:ci(t,e,n)}),fi(Kl,Ul,function(t,e,n){var r="SAME"===Y(t.position.getParentPath(),e.range.start.getParentPath()),i=e.range.start.offset<t.position.offset&&e.range.end.offset>=t.position.offset;if(r&&i)return[yi()];if("SAME"===Y(t.position.getParentPath(),e.range.end.getShiftedBy(-1).path)){var o=t.clone(),a=rs.createFromPosition(e.range.start);a.path.push(e.howMany-1);var s=a.getShiftedBy(1);o._cloneOperation.position=s;var u=rs.createFromPosition(a);u.path.push(t.position.offset),o._moveOperation.sourcePosition=u;var l=rs.createFromPosition(s);return l.path.push(0),o._moveOperation.targetPosition=l,[o]}return ci(t,e,n)}),fi(Xl,Kl,function(t,e,n){if("SAME"===Y(t.position.path,e.position.getParentPath())){var r=[e.getReversed(),t.clone()];return r[1].operations[1].targetPosition.path[0]++,r}return ci(t,e,n)}),fi(Yl,Ll,function(t,e,n){var r=ci(t,e,n);return e.range.containsPosition(t.position)&&r.push(vi(t,e)),r}),fi(Ul,Kl,function(t,e,n){var r="SAME"===Y(t.range.start.getParentPath(),e.position.getParentPath()),i=t.range.start.offset<e.position.offset&&t.range.end.offset>=e.position.offset;if(r&&i)return[e.getReversed(),t.clone()];if("SAME"===Y(e.position.getParentPath(),t.range.end.getShiftedBy(-1).path)){var o=t.clone();return o._insertOperation.position.offset++,o._moveOperation.howMany++,o._moveOperation.targetPosition.path[o._moveOperation.targetPosition.path.length-2]++,[o]}return ci(t,e,n)});var ah=function(){function t(){wo(this,t),this._deltas=[],this._historyPoints=new Map}return _o(t,[{key:"addDelta",value:function(t){if(t.operations.length>0&&!this._historyPoints.has(t.baseVersion)){var e=this._deltas.length;this._deltas[e]=t,this._historyPoints.set(t.baseVersion,e)}}},{key:"getDeltas",value:regeneratorRuntime.mark(function e(){var t,n,r=arguments.length<=0||void 0===arguments[0]?0:arguments[0],i=arguments.length<=1||void 0===arguments[1]?Number.POSITIVE_INFINITY:arguments[1];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this._deltas.length){e.next=2;break}return e.abrupt("return");case 2:if(t=this._getIndex(r),t!=-1){e.next=5;break}return e.abrupt("return");case 5:if(!(t<this._deltas.length)){e.next=13;break}if(n=this._deltas[t++],!(n.baseVersion>=i)){e.next=9;break}return e.abrupt("break",13);case 9:return e.next=11,n;case 11:e.next=5;break;case 13:case"end":return e.stop()}},e,this)})},{key:"getDelta",value:function(t){var e=this._historyPoints.get(t);if(void 0===e)return null;var n=[];for(e;e<this._deltas.length;e++){var r=this._deltas[e];if(r.baseVersion!=t)break;n.push(r)}return 0===n.length?null:n}},{key:"removeDelta",value:function(t){this.updateDelta(t,[])}},{key:"updateDelta",value:function(t,e){var n,r=this.getDelta(t);if(null!==r){var i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;l.baseVersion=t}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}(n=this._deltas).splice.apply(n,[this._getIndex(t),r.length].concat(So(e)));var f=e.length-r.length,h=!0,d=!1,v=void 0;try{for(var y,g=this._historyPoints.keys()[Symbol.iterator]();!(h=(y=g.next()).done);h=!0){var p=y.value;p>t&&this._historyPoints.set(p,this._historyPoints.get(p)+f)}}catch(c){d=!0,v=c}finally{try{!h&&g["return"]&&g["return"]()}finally{if(d)throw v}}}}},{key:"_getIndex",value:function(t){var e=this._historyPoints.get(t);if(void 0===e){var n=this._deltas[this._deltas.length-1],r=n.baseVersion+n.operations.length;if(t<0||t>=r)return-1;throw new Bo("history-wrong-version: Given base version points to the middle of a delta.")}return e}}]),t}(),sh=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return gi.call(r),r}return xo(e,t),_o(e,[{key:"detach",value:function(){this.stopListening()}}]),e}(Ga);K(sh,To);var uh=function(){function t(){wo(this,t),this._lastRangeBackward=!1,this._ranges=[]}return _o(t,[{key:"addRange",value:function(t,e){this._pushRange(t),this._lastRangeBackward=!!e,this.fire("change:range")}},{key:"getRanges",value:regeneratorRuntime.mark(function e(){var t,n,r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,r=void 0,e.prev=3,i=this._ranges[Symbol.iterator]();case 5:if(t=(o=i.next()).done){e.next=12;break}return a=o.value,e.next=9,Ga.createFromRange(a);case 9:t=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](3),n=!0,r=e.t0;case 18:e.prev=18,e.prev=19,!t&&i["return"]&&i["return"]();case 21:if(e.prev=21,!n){e.next=24;break}throw r;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25]])})},{key:"getFirstRange",value:function(){for(var t=null,e=0;e<this._ranges.length;e++){var n=this._ranges[e];t&&!n.start.isBefore(t.start)||(t=n)}return t?Ga.createFromRange(t):null}},{key:"getFirstPosition",value:function(){var t=this.getFirstRange();return t?rs.createFromPosition(t.start):null}},{key:"removeAllRanges",value:function(){this._ranges=[],this.fire("change:range")}},{key:"setRanges",value:function(t,e){this._ranges=[];var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this._pushRange(s)}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}this._lastRangeBackward=!!e,this.fire("change:range")}},{key:"collapse",value:function(t,e){var n=rs.createAt(t,e),r=new Ga(n,n);this.setRanges([r])}},{key:"setFocus",value:function(t,e){if(null===this.anchor)throw new Bo("selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.");var n=rs.createAt(t,e);if("SAME"!=n.compareWith(this.focus)){var r=this.anchor;this._ranges.length&&this._popRange(),"BEFORE"==n.compareWith(r)?this.addRange(new Ga(n,r),!0):this.addRange(new Ga(r,n))}}},{key:"_checkRange",value:function(t){for(var e=0;e<this._ranges.length;e++)if(t.isIntersecting(this._ranges[e]))throw new Bo("selection-range-intersects: Trying to add a range that intersects with another range from selection.",{addedRange:t,intersectingRange:this._ranges[e]})}},{key:"_popRange",value:function(){this._ranges.pop()}},{key:"_pushRange",value:function(t){this._checkRange(t),this._ranges.push(Ga.createFromRange(t))}},{key:"anchor",get:function(){if(this._ranges.length>0){var t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.end:t.start}return null}},{key:"focus",get:function(){if(this._ranges.length>0){var t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.start:t.end}return null}},{key:"isCollapsed",get:function(){var t=this._ranges.length;return 1===t&&this._ranges[0].isCollapsed}},{key:"rangeCount",get:function(){return this._ranges.length}},{key:"isBackward",get:function(){return!this.isCollapsed&&this._lastRangeBackward}}],[{key:"createFromSelection",value:function(t){var e=new this;return e.setRanges(t.getRanges(),t.isBackward),e}}]),t}();K(uh,To);var lh="selection:",ch=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this));return n._document=t,n._attrs=new Map,n}return xo(e,t),_o(e,[{key:"destroy",value:function(){for(var t=0;t<this._ranges.length;t++)this._ranges[t].detach()}},{key:"getRanges",value:regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._ranges.length){t.next=4;break}return t.delegateYield(ko(Object.getPrototypeOf(e.prototype),"getRanges",this).call(this),"t0",2);case 2:t.next=6;break;case 4:return t.next=6,this._getDefaultRange();case 6:case"end":return t.stop()}},n,this)})},{key:"getFirstRange",value:function(){return ko(Object.getPrototypeOf(e.prototype),"getFirstRange",this).call(this)||this._getDefaultRange()}},{key:"removeAllRanges",value:function(){this.destroy(),ko(Object.getPrototypeOf(e.prototype),"removeAllRanges",this).call(this)}},{key:"setRanges",value:function(t,n){this.destroy(),ko(Object.getPrototypeOf(e.prototype),"setRanges",this).call(this,t,n)}},{key:"clearAttributes",value:function(){this._attrs.clear(),this._setStoredAttributesTo(new Map),this.fire("change:attribute")}},{key:"getAttribute",value:function(t){return this._attrs.get(t)}},{key:"getAttributes",value:function(){return this._attrs[Symbol.iterator]()}},{key:"hasAttribute",value:function(t){return this._attrs.has(t)}},{key:"removeAttribute",value:function(t){this._attrs["delete"](t),this._removeStoredAttribute(t),this.fire("change:attribute")}},{key:"setAttribute",value:function(t,e){this._attrs.set(t,e),this._storeAttribute(t,e),this.fire("change:attribute")}},{key:"setAttributesTo",value:function(t){this._attrs=U(t),this._setStoredAttributesTo(this._attrs),this.fire("change:attribute")}},{key:"_popRange",value:function(){this._ranges.pop().detach()}},{key:"_pushRange",value:function(t){this._checkRange(t),this._ranges.push(sh.createFromRange(t))}},{key:"_getDefaultRange",value:function(){var t=this._document._getDefaultRoot(),e=!0,n=!1,r=void 0;try{for(var i,o=Ga.createFromElement(t).getPositions()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;if(this._document.schema.check({name:"$text",inside:a}))return new Ga(a,a)}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}var u=new rs(t,[0]);return new Ga(u,u)}},{key:"_getStoredAttributes",value:regeneratorRuntime.mark(function r(){var t,e,n,i,o,a,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=this.getFirstPosition().parent,!this.isCollapsed||0!==t.getChildCount()){r.next=30;break}e=!0,n=!1,i=void 0,r.prev=5,o=t.getAttributes()[Symbol.iterator]();case 7:if(e=(a=o.next()).done){r.next=16;break}if(s=a.value,0!==s[0].indexOf(lh)){r.next=13;break}return u=s[0].substr(lh.length),r.next=13,[u,s[1]];case 13:e=!0,r.next=7;break;case 16:r.next=22;break;case 18:r.prev=18,r.t0=r["catch"](5),n=!0,i=r.t0;case 22:r.prev=22,r.prev=23,!e&&o["return"]&&o["return"]();case 25:if(r.prev=25,!n){r.next=28;break}throw i;case 28:return r.finish(25);case 29:return r.finish(22);case 30:case"end":return r.stop()}},r,this,[[5,18,22,30],[23,,25,29]])})},{key:"_removeStoredAttribute",value:function(t){var n=this,r=this.getFirstPosition().parent;this.isCollapsed&&0===r.getChildCount()&&!function(){var i=e._getStoreAttributeKey(t);n._document.enqueueChanges(function(){n._document.batch().removeAttr(i,r)})}()}},{key:"_storeAttribute",value:function(t,n){var r=this,i=this.getFirstPosition().parent;this.isCollapsed&&0===i.getChildCount()&&!function(){var o=e._getStoreAttributeKey(t);r._document.enqueueChanges(function(){r._document.batch().setAttr(o,n,i)})}()}},{key:"_setStoredAttributesTo",value:function(t){var n=this,r=this.getFirstPosition().parent;this.isCollapsed&&0===r.getChildCount()&&this._document.enqueueChanges(function(){var i=n._document.batch(),o=!0,a=!1,s=void 0;try{for(var u,l=n._getStoredAttributes()[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value,f=e._getStoreAttributeKey(c[0]);i.removeAttr(f,r)}}catch(h){a=!0,s=h}finally{try{!o&&l["return"]&&l["return"]()}finally{if(a)throw s}}var d=!0,v=!1,y=void 0;try{for(var g,p=t[Symbol.iterator]();!(d=(g=p.next()).done);d=!0){var m=g.value,b=e._getStoreAttributeKey(m[0]);i.setAttr(b,m[1],r)}}catch(h){v=!0,y=h}finally{try{!d&&p["return"]&&p["return"]()}finally{if(v)throw y}}})}},{key:"_updateAttributes",value:function(){function t(t){return t instanceof Ja?t.getAttributes():null}var e=this.getFirstPosition(),n=e.parent,r=null;if(this.isCollapsed){var i=n.getChild(e.offset-1),o=n.getChild(e.offset);if(r=t(i),r||(r=t(o)),!r)for(var a=i;a&&!r;)a=a.previousSibling,r=t(a);if(!r)for(var s=o;s&&!r;)s=s.nextSibling,r=t(s);r||(r=this._getStoredAttributes())}else{var u=this.getFirstRange(),l=!0,c=!1,f=void 0;try{for(var h,d=u[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var v=h.value;"TEXT"==v.type&&null===r&&(r=v.item.getAttributes())}}catch(y){c=!0,f=y}finally{try{!l&&d["return"]&&d["return"]()}finally{if(c)throw f}}}r?this._attrs=new Map(r):this.clearAttributes(),this.fire("change:attribute")}},{key:"isCollapsed",get:function(){var t=this._ranges.length;return 0===t||ko(Object.getPrototypeOf(e.prototype),"isCollapsed",this)}},{key:"anchor",get:function(){return ko(Object.getPrototypeOf(e.prototype),"anchor",this)||this._getDefaultRange().start}},{key:"focus",get:function(){return ko(Object.getPrototypeOf(e.prototype),"focus",this)||this._getDefaultRange().start}},{key:"rangeCount",get:function(){return this._ranges.length?this._ranges.length:1}}],[{key:"_getStoreAttributeKey",value:function(t){return lh+t}}]),e}(uh),fh=function(){function t(e){wo(this,t),this._schema=e,this._allowed=[],this._disallowed=[],this._requiredAttributes=[]}return _o(t,[{key:"allow",value:function(t,e){this._addPath("_allowed",t,e)}},{key:"disallow",value:function(t,e){this._addPath("_disallowed",t,e)}},{key:"requireAttributes",value:function(t){this._requiredAttributes.push(t)}},{key:"_addPath",value:function(t,e,n){e=e.slice(),Ca(n)||(n=[n]);var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;this[t].push({path:e,attribute:u})}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}},{key:"_getPaths",value:function(t,e){var n="ALLOW"===t?this._allowed:this._disallowed,r=[],i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;l.attribute===e&&r.push(l.path)}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return r}},{key:"_checkRequiredAttributes",value:function(t){var e=!0,n=!0,r=!1,i=void 0;try{for(var o,a=this._requiredAttributes[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e=!0;var u=!0,l=!1,c=void 0;try{for(var f,h=s[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var d=f.value;if(t.indexOf(d)==-1){e=!1;break}}}catch(v){l=!0,c=v}finally{try{!u&&h["return"]&&h["return"]()}finally{if(l)throw c}}if(e)break}}catch(v){r=!0,i=v}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return e}},{key:"_hasMatchingPath",value:function(t,e,n){var r=this._getPaths(t,n),i=!0,o=!1,a=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value,c=0,f=!0,h=!1,d=void 0;try{for(var v,y=e[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value,p=this._schema._extensionChains.get(g);p.indexOf(l[c])>-1&&c++}}catch(m){h=!0,d=m}finally{try{!f&&y["return"]&&y["return"]()}finally{if(h)throw d}}if(c===l.length)return!0}}catch(m){o=!0,a=m}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return!1}},{key:"toJSON",value:function(){var t=ze(this);return t._schema="[model.Schema]",t}}]),t}(),hh=function(){function t(){wo(this,t),this._items=new Map,this._extensionChains=new Map,this.registerItem("$root"),this.registerItem("$block"),this.registerItem("$inline"),this.registerItem("$text","$inline"),this.allow({name:"$block",inside:"$root"}),this.allow({name:"$inline",inside:"$block"})}return _o(t,[{key:"allow",value:function(e){this._getItem(e.name).allow(t._normalizeQueryPath(e.inside),e.attributes)}},{key:"disallow",value:function(e){this._getItem(e.name).disallow(t._normalizeQueryPath(e.inside),e.attributes)}},{key:"requireAttributes",value:function(t,e){this._getItem(t).requireAttributes(e)}},{key:"check",value:function(e){var n=this;if(!this.hasItem(e.name))return!1;Ca(e.attributes)?0===e.attributes.length&&e.attributes.push(void 0):e.attributes=[e.attributes];var r=t._normalizeQueryPath(e.inside),i=this._extensionChains.get(e.name).map(function(t){return n._getItem(t)});if(!this._getItem(e.name)._checkRequiredAttributes(e.attributes))return!1;var o=!0,a=!1,s=void 0;try{for(var u,l=e.attributes[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value,f=!0,h=!1,d=void 0;try{for(var v,y=i[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value;if(g._hasMatchingPath("DISALLOW",r,c))return!1}}catch(p){h=!0,d=p}finally{try{!f&&y["return"]&&y["return"]()}finally{if(h)throw d}}}}catch(p){a=!0,s=p}finally{try{!o&&l["return"]&&l["return"]()}finally{if(a)throw s}}var m=!0,b=!1,w=void 0;try{for(var _,k=e.attributes[Symbol.iterator]();!(m=(_=k.next()).done);m=!0){var x=_.value,O=!1,P=!0,S=!1,A=void 0;try{for(var C,E=i[Symbol.iterator]();!(P=(C=E.next()).done);P=!0){var T=C.value;if(T._hasMatchingPath("ALLOW",r,x)){O=!0;break}}}catch(p){S=!0,A=p}finally{try{!P&&E["return"]&&E["return"]()}finally{if(S)throw A}}if(!O)return!1}}catch(p){b=!0,w=p}finally{try{!m&&k["return"]&&k["return"]()}finally{if(b)throw w}}return!0}},{key:"hasItem",value:function(t){return this._items.has(t)}},{key:"registerItem",value:function(t,e){if(this.hasItem(t))throw new Bo("schema-item-exists: Item with specified name already exists in schema.");if(e&&!this.hasItem(e))throw new Bo("schema-no-item: Item with specified name does not exist in schema.");this._items.set(t,new fh(this));var n=this.hasItem(e)?this._extensionChains.get(e).concat(t):[t];this._extensionChains.set(t,n)}},{key:"_getItem",value:function(t){if(!this.hasItem(t))throw new Bo("schema-no-item: Item with specified name does not exist in schema.");return this._items.get(t)}}],[{key:"_normalizeQueryPath",value:function(t){var e=[];if(Ca(t)){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s instanceof Qa?e.push(s.name):F(s)&&e.push(s)}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}}else if(t instanceof rs){for(var l=t.parent;null!==l;)e.push(l.name),l=l.parent;e.reverse()}else F(t)&&(e=t.split(" "));return e}}]),t}(),dh=function(t){function e(t,n,r){if(wo(this,e),!(t instanceof Bl))throw new Bo("liveposition-root-not-rootelement: LivePosition root has to be an instance of RootElement.");var i=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return i.stickiness=r||"STICKS_TO_NEXT",mi.call(i),i}return xo(e,t),_o(e,[{key:"detach",value:function(){this.stopListening()}}]),e}(rs);K(dh,To);var vh=function(){function t(){wo(this,t),this.on("deleteContents",function(t,e){return wi(e.batch,e.selection,e.options)}),this.on("modifySelection",function(t,e){return _i(e.selection,e.options)})}return _o(t,[{key:"deleteContents",value:function(t,e,n){this.fire("deleteContents",{batch:t,selection:e,options:n})}},{key:"modifySelection",value:function(t,e){this.fire("modifySelection",{selection:t,options:e})}}]),t}();K(vh,To);var yh="$graveyard",gh=function(){function t(){var e=this;wo(this,t),this.version=0,this.selection=new ch(this),this.schema=new hh,this.composer=new vh,this._pendingChanges=[],this._roots=new Map,this.selection.on("change:range",function(){e.selection._updateAttributes()}),this.on("changesDone",function(){e.selection._updateAttributes()}),this.createRoot("$root",yh),this.history=new ah(this)}return _o(t,[{key:"applyOperation",value:function(t){if(t.baseVersion!==this.version)throw new Bo("document-applyOperation-wrong-version: Only operations with matching versions can be applied.",{operation:t});var e=t._execute();this.version++,this.history.addDelta(t.delta);var n=t.delta&&t.delta.batch;e&&this.fire("change",t.type,e,n)}},{key:"batch",value:function(t){return new Il(this,t)}},{key:"createRoot",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"$root":arguments[0],e=arguments.length<=1||void 0===arguments[1]?"main":arguments[1];if(this._roots.has(e))throw new Bo("document-createRoot-name-exists: Root with specified name already exists.",{name:e});var n=new Bl(this,t,e);return this._roots.set(e,n),n}},{key:"destroy",value:function(){this.selection.destroy(),this.stopListening()}},{key:"enqueueChanges",value:function(t){if(this._pendingChanges.push(t),1==this._pendingChanges.length){for(;this._pendingChanges.length;)this._pendingChanges[0](),this._pendingChanges.shift();this.fire("changesDone")}}},{key:"getRoot",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"main":arguments[0];if(!this._roots.has(t))throw new Bo("document-getRoot-root-not-exist: Root with specified name does not exist.",{name:t});return this._roots.get(t)}},{key:"hasRoot",value:function(t){return this._roots.has(t)}},{key:"toJSON",value:function(){var t=ze(this);return t.selection="[engine.model.LiveSelection]",t}},{key:"_getDefaultRoot",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._roots.values()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;if(o!==this.graveyard)return o}}catch(a){e=!0,n=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}return this.graveyard}},{key:"graveyard",get:function(){return this.getRoot(yh)}},{key:"rootNames",get:function(){return Array.from(this._roots.keys()).filter(function(t){return t!=yh})}}]),t}();K(gh,To);var ph=function(){function t(e){wo(this,t),this.config=new Io(e),this.plugins=new Wa(this),this.commands=new Map,this.locale=new Ka(this.config.get("lang")),this.t=this.locale.t,
this.document=new gh,this.data=new Rs(this.document)}return _o(t,[{key:"initPlugins",value:function e(){function t(){var t=r.get("features")||[];return Ca(t)||(t=t.split(",")),n.plugins.load(t)}function e(t){return t.reduce(function(t,e){return t.then(e.init.bind(e))},Promise.resolve())}var n=this,r=this.config;return t().then(e)}},{key:"destroy",value:function(){var t=this;return this.fire("destroy"),this.stopListening(),Promise.resolve().then(function(){t.document.destroy(),t.data.destroy()})}},{key:"execute",value:function(t,e){var n=this.commands.get(t);if(!n)throw new Bo("editor-command-not-found: Specified command has not been added to the editor.");n._execute(e)}}],[{key:"create",value:function(t){var e=this;return new Promise(function(n){var r=new e(t);n(r.initPlugins().then(function(){return r}))})}}]),t}();K(ph,To);var mh=function(){function t(e){var n=this;wo(this,t),this.editor=e,this._listener=Object.create(To),this._keystrokes=new Map,this._listener.listenTo(e.editing.view,"keydown",function(t,e){var r=n.press(e);r&&e.preventDefault()})}return _o(t,[{key:"set",value:function(t,e){this._keystrokes.set(Pt(t),e)}},{key:"press",value:function(t){var e=Ot(t),n=this._keystrokes.get(e);return!!n&&("string"==typeof n?this.editor.execute(n):n(t),!0)}},{key:"destroy",value:function(){this._keystrokes=new Map,this._listener.stopListening()}}]),t}(),bh=function(){function t(e,n){wo(this,t),this.domDocuments=new Set,this.domConverter=e,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this.selection=n,this._inlineFillerPosition=null,this.isFocused=!1}return _o(t,[{key:"markToSync",value:function(t,e){if("text"===t)this.domConverter.getCorrespondingDom(e.parent)&&this.markedTexts.add(e);else{if(!this.domConverter.getCorrespondingDom(e))return;if("attributes"===t)this.markedAttributes.add(e);else{if("children"!==t)throw new Bo("renderer-unknown-type: Unknown type passed to Renderer.markToSync.");this.markedChildren.add(e)}}}},{key:"render",value:function(){this._isInlineFillerAtSelection()||(this._removeInlineFiller(),this._needAddInlineFiller()?(this._inlineFillerPosition=this.selection.getFirstPosition(),this.markedChildren.add(this._inlineFillerPosition.parent)):this._inlineFillerPosition=null);var t=!0,e=!1,n=void 0;try{for(var r,i=this.markedTexts[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;!this.markedChildren.has(o.parent)&&this.domConverter.getCorrespondingDom(o.parent)&&this._updateText(o)}}catch(a){e=!0,n=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}var s=!0,u=!1,l=void 0;try{for(var c,f=this.markedAttributes[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var h=c.value;this._updateAttrs(h)}}catch(a){u=!0,l=a}finally{try{!s&&f["return"]&&f["return"]()}finally{if(u)throw l}}var d=!0,v=!1,y=void 0;try{for(var g,p=this.markedChildren[Symbol.iterator]();!(d=(g=p.next()).done);d=!0){var m=g.value;this._updateChildren(m)}}catch(a){v=!0,y=a}finally{try{!d&&p["return"]&&p["return"]()}finally{if(v)throw y}}this._updateSelection(),this._updateFocus(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}},{key:"_isInlineFillerAtSelection",value:function(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;var t=this.selection.getFirstPosition(),e=this._inlineFillerPosition;return!!e&&(!!e.isEqual(t)||!!(t.parent instanceof os&&e.isEqual(cs.createBefore(t.parent))))}},{key:"_removeInlineFiller",value:function(){if(this._inlineFillerPosition){var t=this.domConverter.viewPositionToDom(this._inlineFillerPosition),e=t.parent;if(!this.domConverter.isText(e)||!At(e))throw new Bo("renderer-render-no-inline-filler: No inline filler on expected position.");Ct(e)?e.parentNode.removeChild(e):e.data=e.data.substr(Ss)}}},{key:"_needAddInlineFiller",value:function(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;var t=this.selection.getFirstPosition(),e=t.parent,n=t.offset;if(!this.domConverter.getCorrespondingDomElement(e.getRoot()))return!1;if(!(e instanceof ss))return!1;if(n===e.getFillerOffset())return!1;var r=t.nodeBefore,i=t.nodeAfter;return!(r instanceof os||i instanceof os)}},{key:"_updateText",value:function(t){var e=this.domConverter.getCorrespondingDom(t),n=e.data,r=t.data,i=this._inlineFillerPosition;i&&i.parent==t.parent&&i.offset==t.getIndex()&&(r=As+r),n!=r&&(e.data=r)}},{key:"_updateAttrs",value:function(t){var e=this.domConverter.getCorrespondingDom(t),n=Array.from(e.attributes).map(function(t){return t.name}),r=t.getAttributeKeys(),i=!0,o=!1,a=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;e.setAttribute(l,t.getAttribute(l))}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}var f=!0,h=!1,d=void 0;try{for(var v,y=n[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value;t.hasAttribute(g)||e.removeAttribute(g)}}catch(c){h=!0,d=c}finally{try{!f&&y["return"]&&y["return"]()}finally{if(h)throw d}}}},{key:"_updateChildren",value:function(t){function e(t,e){return t===e||(n.isText(t)&&n.isText(e)?t.data===e.data:!(!Tt(t,n.blockFiller)||!Tt(e,n.blockFiller)))}var n=this.domConverter,r=n.getCorrespondingDom(t),i=r.ownerDocument,o=this._inlineFillerPosition,a=r.childNodes,s=Array.from(n.viewChildrenToDom(t,i,{bind:!0}));if(o&&o.parent==t){var u=s[o.offset];this.domConverter.isText(u)?u.data=As+u.data:s.splice(o.offset,0,i.createTextNode(As))}var l=xi(a,s,e),c=0,f=!0,h=!1,d=void 0;try{for(var v,y=l[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value;"INSERT"===g?(Oi(r,c,s[c]),c++):"DELETE"===g?Pi(a[c]):c++}}catch(p){h=!0,d=p}finally{try{!f&&y["return"]&&y["return"]()}finally{if(h)throw d}}}},{key:"_updateSelection",value:function(){if(0===this.selection.rangeCount)return void this._removeDomSelction();if(this.isFocused){var t=this.selection.getEditableElement(),e=this.domConverter.getCorrespondingDomElement(t);if(e){var n=e.ownerDocument.defaultView.getSelection(),r=n&&this.domConverter.domSelectionToView(n);if(!r||!this.selection.isEqual(r)){n.removeAllRanges();var i=!0,o=!1,a=void 0;try{for(var s,u=this.selection.getRanges()[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;if(l.start.parent.getRoot()==t){var c=this.domConverter.viewPositionToDom(l.start),f=this.domConverter.viewPositionToDom(l.end),h=new Range;h.setStart(c.parent,c.offset),h.setEnd(f.parent,f.offset),n.addRange(h)}}}catch(d){o=!0,a=d}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}}}}}},{key:"_removeDomSelction",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.domDocuments[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value,a=o.getSelection();if(a.rangeCount){var s=o.activeElement,u=this.domConverter.getCorrespondingViewElement(s);s&&u&&o.getSelection().removeAllRanges()}}}catch(l){e=!0,n=l}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}}},{key:"_updateFocus",value:function(){if(this.isFocused){var t=this.selection.getEditableElement();t&&this.domConverter.focus(t)}}}]),t}();K(bh,za);var wh=function(t){function e(t,n){var r=arguments.length<=2||void 0===arguments[2]?"main":arguments[2];wo(this,e);var i=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return i.rootName=r,i}return xo(e,t),e}(ls),_h=function(){function t(){var e=this;wo(this,t),this.domRoots=new Map,this.selection=new ks,this.writer=new _s,this.domConverter=new Ts,this.roots=new Map,this.set("isFocused",!1),this.renderer=new bh(this.domConverter,this.selection),this.renderer.bind("isFocused").to(this,"isFocused"),this._observers=new Map,Rt(this),this.on("render",function(){e.disableObservers(),e.renderer.render(),e.enableObservers()})}return _o(t,[{key:"addObserver",value:function(t){var e=this._observers.get(t);if(e)return e;e=new t(this),this._observers.set(t,e);var n=!0,r=!1,i=void 0;try{for(var o,a=this.domRoots[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=Po(o.value,2),u=s[0],l=s[1];e.observe(l,u)}}catch(c){r=!0,i=c}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return e.enable(),e}},{key:"getObserver",value:function(t){return this._observers.get(t)}},{key:"createRoot",value:function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]?"main":arguments[1],r="string"==typeof t?t:t.tagName,i=new wh(this,r,n);return this.roots.set(n,i),i.on("change:children",function(t,n){return e.renderer.markToSync("children",n)}),i.on("change:attributes",function(t,n){return e.renderer.markToSync("attributes",n)}),i.on("change:text",function(t,n){return e.renderer.markToSync("text",n)}),this.domConverter.isElement(t)&&this.attachDomRoot(t,n),i}},{key:"attachDomRoot",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?"main":arguments[1],n=this.getRoot(e);this.domRoots.set(e,t),this.domConverter.bindElements(t,n),this.renderer.markToSync("children",n),this.renderer.domDocuments.add(t.ownerDocument);var r=!0,i=!1,o=void 0;try{for(var a,s=this._observers.values()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u.observe(t,e)}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}},{key:"getRoot",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"main":arguments[0];return this.roots.get(t)}},{key:"getDomRoot",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"main":arguments[0];return this.domRoots.get(t)}},{key:"render",value:function(){this.fire("render")}},{key:"focus",value:function(){if(!this.isFocused){var t=this.selection.getEditableElement();t?(this.domConverter.focus(t),this.render()):Ha.warn("view-focus-no-selection: There is no selection in any editable to focus.")}}},{key:"disableObservers",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._observers.values()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.disable()}}catch(a){e=!0,n=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}}},{key:"enableObservers",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._observers.values()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.enable()}}catch(a){e=!0,n=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}}}]),t}();K(_h,za);var kh=function(){function t(e){wo(this,t),this.document=e,this.isEnabled=!1}return _o(t,[{key:"enable",value:function(){this.isEnabled=!0}},{key:"disable",value:function(){this.isEnabled=!1}}]),t}(),xh=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t));return n._config={childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},n.domConverter=t.domConverter,n.renderer=t.renderer,n._domElements=[],n._mutationObserver=new window.MutationObserver(n._onMutations.bind(n)),n}return xo(e,t),_o(e,[{key:"flush",value:function(){this._onMutations(this._mutationObserver.takeRecords())}},{key:"observe",value:function(t){this._domElements.push(t),this.isEnabled&&this._mutationObserver.observe(t,this._config)}},{key:"enable",value:function(){ko(Object.getPrototypeOf(e.prototype),"enable",this).call(this);var t=!0,n=!1,r=void 0;try{for(var i,o=this._domElements[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this._mutationObserver.observe(a,this._config)}}catch(s){n=!0,r=s}finally{try{!t&&o["return"]&&o["return"]()}finally{if(n)throw r}}}},{key:"disable",value:function(){ko(Object.getPrototypeOf(e.prototype),"disable",this).call(this),this._mutationObserver.disconnect()}},{key:"_onMutations",value:function(t){if(0!==t.length){var e=this.domConverter,n=new Map,r=new Set,i=!0,o=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;if("childList"===l.type){var c=e.getCorrespondingViewElement(l.target);c&&r.add(c)}}}catch(f){o=!0,a=f}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}var h=!0,d=!1,v=void 0;try{for(var y,g=t[Symbol.iterator]();!(h=(y=g.next()).done);h=!0){var p=y.value;if("characterData"===p.type){var m=e.getCorrespondingViewText(p.target);m&&!r.has(m.parent)?n.set(m,{type:"text",oldText:m.data,newText:Et(p.target),node:m}):!m&&At(p.target)&&r.add(e.getCorrespondingViewElement(p.target.parentNode))}}}catch(f){d=!0,v=f}finally{try{!h&&g["return"]&&g["return"]()}finally{if(d)throw v}}var b=[],w=!0,_=!1,k=void 0;try{for(var x,O=n.values()[Symbol.iterator]();!(w=(x=O.next()).done);w=!0){var P=x.value;this.renderer.markToSync("text",P.node),b.push(P)}}catch(f){_=!0,k=f}finally{try{!w&&O["return"]&&O["return"]()}finally{if(_)throw k}}var S=!0,A=!1,C=void 0;try{for(var E,T=r[Symbol.iterator]();!(S=(E=T.next()).done);S=!0){var R=E.value,j=e.getCorrespondingDomElement(R),M=R.getChildren(),F=e.domChildrenToView(j);this.renderer.markToSync("children",R),b.push({type:"children",oldChildren:Array.from(M),newChildren:Array.from(F),node:R})}}catch(f){A=!0,C=f}finally{try{!S&&T["return"]&&T["return"]()}finally{if(A)throw C}}this.document.fire("mutations",b),this.document.render()}}}]),e}(kh),Oh=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t));return n.mutationObserver=t.getObserver(xh),n.document=t,n.selection=t.selection,n.domConverter=t.domConverter,n._documents=new WeakSet,n}return xo(e,t),_o(e,[{key:"observe",value:function(t){var e=this,n=t.ownerDocument;this._documents.has(n)||(n.addEventListener("selectionchange",function(){return e._handleSelectionChange(n)}),this._documents.add(n))}},{key:"_handleSelectionChange",value:function(t){if(this.isEnabled&&this.document.isFocused){this.mutationObserver.flush();var e=t.defaultView.getSelection(),n=this.domConverter.domSelectionToView(e);if(!this.selection.isEqual(n)){if(this._isInfiniteLoop(n))return void Ha.warn("selectionchange-infinite-loop: Selection change observer detected an infinite rendering loop.");this.document.fire("selectionChange",{oldSelection:this.selection,newSelection:n,domSelection:e}),this.document.render()}}}},{key:"_isInfiniteLoop",value:function(t){return this._lastSelection&&this._lastButOneSelection&&(t.isEqual(this._lastSelection)||t.isEqual(this._lastButOneSelection))?this._loopbackCounter++:(this._lastButOneSelection=this._lastSelection,this._lastSelection=t,this._loopbackCounter=0),this._loopbackCounter>10}}]),e}(kh),Ph=function(){function t(e,n,r){wo(this,t),this.document=e,this.domEvent=n,this.domTarget=n.target,Da(this,r)}return _o(t,[{key:"preventDefault",value:function(){this.domEvent.preventDefault()}},{key:"stopPropagation",value:function(){this.domEvent.stopPropagation()}},{key:"target",get:function(){return this.document.domConverter.getCorrespondingViewElement(this.domTarget)}}]),t}(),Sh=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"observe",value:function(t){var e=this,n="string"==typeof this.domEventType?[this.domEventType]:this.domEventType;n.forEach(function(n){t.addEventListener(n,function(t){return e.isEnabled&&e.onDomEvent(t)})})}},{key:"fire",value:function(t,e,n){this.isEnabled&&this.document.fire(t,new Ph(this.document,e,n))}}]),e}(kh),Ah=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t));return n.domEventType=["focus","blur"],t.on("focus",function(){t.isFocused=!0}),t.on("blur",function(e,n){var r=t.selection.getEditableElement();null!==r&&r!==n.target||(t.isFocused=!1)}),n}return xo(e,t),_o(e,[{key:"onDomEvent",value:function(t){this.fire(t.type,t)}}]),e}(Sh),Ch=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t));return n.domEventType="keydown",n}return xo(e,t),_o(e,[{key:"onDomEvent",value:function(t){this.fire("keydown",t,{keyCode:t.keyCode,altKey:t.altKey,ctrlKey:t.ctrlKey||t.metaKey,shiftKey:t.shiftKey,get keystroke(){return Ot(this)}})}}]),e}(Sh),Eh=function(){function t(e){var n=this;wo(this,t),this.model=e,this.view=new _h,this.view.addObserver(xh),this.view.addObserver(Oh),this.view.addObserver(Ah),this.view.addObserver(Ch),this.mapper=new hs,this.modelToView=new vs({writer:this.view.writer,mapper:this.mapper,viewSelection:this.view.selection}),this._listenter=Object.create(To),this._listenter.listenTo(this.view,"selectionChange",Si(e,this.mapper)),this._listenter.listenTo(this.model,"change",function(t,e,r){n.modelToView.convertChange(e,r)}),this._listenter.listenTo(this.model,"changesDone",function(){n.modelToView.convertSelection(e.selection),n.view.render()}),this.modelToView.on("insert:$text",it()),this.modelToView.on("remove",ct()),this.modelToView.on("move",lt()),this.modelToView.on("selection",Ti()),this.modelToView.on("selection",Ai()),this.modelToView.on("selection",Ci())}return _o(t,[{key:"createRoot",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?"main":arguments[1],n=this.view.createRoot(t,e),r=this.model.getRoot(e);return this.mapper.bindElements(r,n),n}},{key:"destroy",value:function(){this._listenter.stopListening()}}]),t}(),Th=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,n));return r.element=t,r.editing=new Eh(r.document),r.keystrokes=new mh(r),r}return xo(e,t),_o(e,[{key:"destroy",value:function(){var t=this;return Promise.resolve().then(function(){return t.editing.destroy()}).then(ko(Object.getPrototypeOf(e.prototype),"destroy",this).call(this))}},{key:"setData",value:function(t){this.data.set(t)}},{key:"getData",value:function(){return this.data.get()}},{key:"updateEditorElement",value:function(){ji(this.element,this.getData())}},{key:"loadDataFromEditorElement",value:function(){this.setData(Ri(this.element))}}],[{key:"create",value:function(t,e){var n=this;return new Promise(function(r){var i=new n(t,e);r(i.initPlugins().then(function(){return i}))})}}]),e}(ph),Rh=function(){function t(){wo(this,t)}return _o(t,[{key:"getHtml",value:function(t){var e=document.implementation.createHTMLDocument(""),n=e.createElement("div");return n.appendChild(t),n.innerHTML}}]),t}(),jh=function(){function t(){wo(this,t),this._domParser=new DOMParser,this._htmlWriter=new Rh}return _o(t,[{key:"toData",value:function(t){return this._htmlWriter.getHtml(t)}},{key:"toDom",value:function(t){for(var e=this._domParser.parseFromString(t,"text/html"),n=e.createDocumentFragment(),r=e.body.childNodes;r.length>0;)n.appendChild(r[0]);return n}}]),t}(),Mh=function(){function t(e){wo(this,t),this._items=[],this._itemMap=new Map,this._idProperty=e&&e.idProperty||"id"}return _o(t,[{key:"add",value:function(t,e){var n=void 0,r=this._idProperty;if(r in t){if(n=t[r],"string"!=typeof n)throw new Bo("collection-add-invalid-id");if(this.get(n))throw new Bo("collection-add-item-already-exists")}else n=this._getNextId(),t[r]=n;if(void 0===e)e=this._items.length;else if(e>this._items.length||e<0)throw new Bo("collection-add-item-invalid-index");return this._items.splice(e,0,t),this._itemMap.set(n,t),this.fire("add",t,e),this}},{key:"get",value:function(t){var e=void 0;if("string"==typeof t)e=this._itemMap.get(t);else{if("number"!=typeof t)throw new Bo("collection-get-invalid-arg: Index or id must be given.");e=this._items[t]}return e||null}},{key:"remove",value:function(t){var e=void 0,n=void 0,r=void 0,i=!1,o=this._idProperty;if("string"==typeof t?(n=t,r=this._itemMap.get(n),i=!r,r&&(e=this._items.indexOf(r))):"number"==typeof t?(e=t,r=this._items[e],i=!r,r&&(n=r[o])):(r=t,n=r[o],e=this._items.indexOf(r),i=e==-1||!this._itemMap.get(n)),i)throw new Bo("collection-remove-404: Item not found.");return this._items.splice(e,1),this._itemMap["delete"](n),this.fire("remove",r),r}},{key:"map",value:function(t,e){return this._items.map(t,e)}},{key:"find",value:function(t,e){return this._items.find(t,e)}},{key:"filter",value:function(t,e){return this._items.filter(t,e)}},{key:"clear",value:function(){for(;this.length;)this.remove(0)}},{key:Symbol.iterator,value:function(){return this._items[Symbol.iterator]()}},{key:"_getNextId",value:function(){var t=void 0;do t=String(Co());while(this._itemMap.has(t));return t}},{key:"length",get:function(){return this._items.length}}]),t}();K(Mh,To);var Fh=function(){function t(e,n){var r=this;wo(this,t),this.model=e||null,this.ready=!1,this.view=n||null,this.collections=new Mh({idProperty:"name"}),this.collections.on("add",function(t,e){e.parent=r,r.listenTo(e,"add",function(t,n,i){r.ready&&n.view&&r.view.regions.get(e.name).views.add(n.view,i)}),r.listenTo(e,"remove",function(t,n){r.ready&&n.view&&r.view.regions.get(e.name).views.remove(n.view)})}),this.collections.on("remove",function(t,e){e.parent=null,r.stopListening(e)})}return _o(t,[{key:"init",value:function(){var t=this;if(this.ready)throw new Bo("ui-controller-init-reinit: This Controller already been initialized.");return Promise.resolve().then(this._initView.bind(this)).then(this._initCollections.bind(this)).then(function(){t.ready=!0,t.fire("ready")})}},{key:"destroy",value:function(){var t=this,e=[],n=void 0,r=void 0,i=!0,o=!1,a=void 0;try{for(var s,u=this.collections[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){n=s.value;var l=!0,c=!1,f=void 0;try{for(var h,d=n[Symbol.iterator]();!(l=(h=d.next()).done);l=!0)r=h.value,e.push(r.destroy())}catch(v){c=!0,f=v}finally{try{!l&&d["return"]&&d["return"]()}finally{if(c)throw f}}n.clear()}}catch(v){o=!0,a=v}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return this.collections.clear(),this.view&&e.push(Promise.resolve().then(function(){return t.view.destroy()})),e.push(Promise.resolve().then(function(){t.model=t.ready=t.view=t.collections=null})),Promise.all(e)}},{key:"add",value:function(t,e,n){this.collections.get(t).add(e,n)}},{key:"remove",value:function(t,e){return this.collections.get(t).remove(e)}},{key:"_initView",value:function(){var t=Promise.resolve();return this.view&&(t=t.then(this.view.init.bind(this.view))),t}},{key:"_initCollections",value:function(){var t=[],e=void 0,n=void 0,r=!0,i=!1,o=void 0;try{for(var a,s=this.collections[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){e=a.value;var u=!0,l=!1,c=void 0;try{for(var f,h=e[Symbol.iterator]();!(u=(f=h.next()).done);u=!0)n=f.value,this.view&&n.view&&this.view.regions.get(e.name).views.add(n.view),t.push(n.init())}catch(d){l=!0,c=d}finally{try{!u&&h["return"]&&h["return"]()}finally{if(l)throw c}}}}catch(d){i=!0,o=d}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return Promise.all(t)}}]),t}();K(Fh,To);var Vh=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this));if(!t)throw new Bo("ui-controllercollection-no-name: ControllerCollection must be initialized with a name.");return n.name=t,n.parent=null,n}return xo(e,t),_o(e,[{key:"add",value:function(t,n){ko(Object.getPrototypeOf(e.prototype),"add",this).call(this,t,n);var r=Promise.resolve();return this.parent&&this.parent.ready&&!t.ready&&(r=r.then(function(){return t.init()})),r}}]),e}(Mh),Nh=function(){function t(e){wo(this,t),this.editor=e,this._components=new Map}return _o(t,[{key:"add",value:function(t,e,n,r){if(this._components.get(t))throw new Bo("componentfactory-item-exists: The item already exists in the component factory.",{name:t});this._components.set(t,{ControllerClass:e,ViewClass:n,model:r})}},{key:"create",value:function(t){var e=this._components.get(t),n=e.model,r=new e.ViewClass(n,this.editor.locale),i=new e.ControllerClass(n,r,this.editor);return i}}]),t}(),Dh=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return n.model.bind("sprite").to(t),r}return xo(e,t),e}(Fh),Ih=function cv(t,e){wo(this,cv),e&&Da(this,e),t&&this.set(t)};K(Ih,za);var Bh=function(){function t(e){wo(this,t),this.name=e,this.views=new Mh,this.element=null}return _o(t,[{key:"init",value:function(t){this.element=t,t&&(this.views.on("add",function(e,n,r){t.insertBefore(n.element,t.childNodes[r])}),this.views.on("remove",function(t,e){e.element.remove()}))}},{key:"destroy",value:function(){if(this.element){var t=!0,e=!1,n=void 0;try{for(var r,i=this.views[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.element.remove(),this.views.remove(o)}}catch(a){e=!0,n=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}}this.element=this.views=null}}]),t}(),Lh=Symbol("bindTo"),zh=Symbol("bindIf"),qh=function(){function t(e){wo(this,t);var n=Li(e);zi(n),this.definition=n}return _o(t,[{key:"render",value:function(){return this._renderNode(this.definition,void 0,!0)}},{key:"apply",value:function(t){if(!t)throw new Bo("ui-template-wrong-node: No DOM Node specified.");return this._renderNode(this.definition,t)}},{key:"_renderNode",value:function(t,e,n){var r=void 0;if(r=e?t.tag&&t.text:t.tag?t.text:!t.text)throw new Bo('ui-template-wrong-syntax: Node definition must have either "tag" or "text" when rendering new Node.');return t.text?this._renderText(t,e):this._renderElement(t,e,n)}},{key:"_renderElement",value:function(t,e,n){var r=e||document.createElementNS(t.ns||"http://www.w3.org/1999/xhtml",t.tag);if(this._renderElementAttributes(t,r),n){var i=document.createDocumentFragment();this._renderElementChildren(t,i),r.appendChild(i)}else this._renderElementChildren(t,r,!!e);return this._setUpListeners(t,r),r}},{key:"_renderText",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?document.createTextNode(""):arguments[1];return Fi(t.text)?this._bindToObservable(t.text,e,Di(e)):e.textContent=t.text.join(""),e}},{key:"_renderElementAttributes",value:function(t,e){var n=t.attributes,r=void 0,i=void 0,o=void 0;if(n)for(r in n)i=n[r],o=i[0].ns||null,Fi(i)?this._bindToObservable(i[0].value||i,e,Ii(e,r,o)):"style"==r&&"string"!=typeof i[0]?this._renderStyleAttribute(i[0],e):(i=i.map(function(t){return t?t.value||t:t}).reduce(function(t,e){return t.concat(e)},[]).reduce(Ji),e.setAttributeNS(o,r,i))}},{key:"_renderStyleAttribute",value:function(t,e){for(var n in t){var r=t[n];Fi(r)?this._bindToObservable([r],e,Bi(e,n)):e.style[n]=r}}},{key:"_renderElementChildren",value:function(t,e,n){var r=this;t.children&&t.children.forEach(function(t,i){n?r._renderNode(t,e.childNodes[i]):e.appendChild(r._renderNode(t))})}},{key:"_setUpListeners",value:function(t,e){if(t.on){var n=function(n){var r=n.split("@"),i=Po(r,2),o=i[0],a=i[1],s=!0,u=!1,l=void 0;try{for(var c,f=function(){var t=c.value;t.emitter.listenTo(e,o,function(e,n){a&&!n.target.matches(a)||("function"==typeof t.eventNameOrFunction?t.eventNameOrFunction(n):t.observable.fire(t.eventNameOrFunction,n))})},h=t.on[n][Symbol.iterator]();!(s=(c=h.next()).done);s=!0)f()}catch(d){u=!0,l=d}finally{try{!s&&h["return"]&&h["return"]()}finally{if(u)throw l}}};for(var r in t.on)n(r)}}},{key:"_bindToObservable",value:function(t){var e=arguments;t.filter(function(t){return t.observable}).forEach(function(t){var n=t.emitter,r=t.observable,i=t.attribute;n.listenTo(r,"change:"+i,function(){Ni.apply(void 0,e)})}),Ni.apply(void 0,arguments)}}],[{key:"bind",value:function(t,e){return{to:function(n,r){return{type:Lh,eventNameOrFunction:n,attribute:n,observable:t,emitter:e,callback:r}},"if":function(n,r,i){return{type:zh,observable:t,emitter:e,attribute:n,valueIfTrue:r,callback:i}}}}},{key:"extend",value:function(e,n){var r=Li(n);zi(r),e instanceof t?Xi(e.definition,r):Xi(e,r)}}]),t}();K(qh,To);var Hh=function fv(t){wo(this,fv),this._emitterId=Yi(t),this._domNode=t};Da(Hh.prototype,To,{on:function(t){if(To.on.apply(this,arguments),!this._domListeners||!this._domListeners[t]){var e=this._createDomListener(t);this._domNode.addEventListener(t,e),this._domListeners||(this._domListeners={}),this._domListeners[t]=e}},off:function(t){To.off.apply(this,arguments);var e=void 0;(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener:function(t){var e=this,n=function(n){e.fire(t,n)};return n.removeListener=function(){e._domNode.removeEventListener(t,n),delete e._domListeners[t]},n}});var Wh=Da({},To,{listenTo:function(){var t=Array.prototype.slice.call(arguments),e=t[0];Gi(e)&&(t[0]=this._getProxyEmitter(e)||new Hh(e)),To.listenTo.apply(this,t)},stopListening:function(){var t=Array.prototype.slice.call(arguments),e=t[0];if(Gi(e)){var n=this._getProxyEmitter(e);n?t[0]=n:Ha.error("domemittermixin-stoplistening: Stopped listening on a DOM Node that has no emitter or emitter is gone.",e)}To.stopListening.apply(this,t)},_getProxyEmitter:function(t){var e=void 0,n=void 0,r=void 0,i=Yi(t);return(n=this._listeningTo)&&(r=n[i])&&(e=r.emitter),e||null}}),Kh=function(){function t(e){wo(this,t),this.model=new Ih,this.locale=e,this.t=e&&e.t,this.regions=new Mh({idProperty:"name"}),this._regionSelectors={}}return _o(t,[{key:"init",value:function(){this._initRegions()}},{key:"register",value:function(){for(var t=void 0,e=void 0,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];if("string"==typeof r[0])e=r[0],t=this.regions.get(e)||new Bh(e);else{if(!(r[0]instanceof Bh))throw new Bo("ui-view-register-wrongtype");e=r[0].name,t=r[0]}var o=r[1];if(!o||!Qi(o))throw new Bo("ui-view-register-badselector");var a=this.regions.get(e);if(a){if(a!==t){if(!r[2])throw new Bo("ui-view-register-override");this.regions.remove(a),this.regions.add(t)}}else this.regions.add(t);this._regionSelectors[e]=o}},{key:"destroy",value:function(){var t=void 0;this.stopListening();var e=!0,n=!1,r=void 0;try{for(var i,o=this.regions[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){for(var a=i.value;t=a.views.get(0);)a.views.remove(t);this.regions.remove(a).destroy()}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}this.template&&this.element.remove(),this.model=this.regions=this.template=this.locale=this.t=null,this._regionSelectors=this._element=null}},{key:"_initRegions",value:function(){var t=void 0,e=void 0,n=void 0,r=!0,i=!1,o=void 0;try{for(var a,s=this.regions[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)t=a.value,n=this._regionSelectors[t.name],e="string"==typeof n?this.element.querySelector(n):"function"==typeof n?n(this.element):null,t.init(e)}catch(u){i=!0,o=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}},{key:"element",get:function(){return this._element?this._element:this.template?this._element=this.template.render():null},set:function(t){this._element=t}},{key:"bind",get:function(){return this._bind?this._bind:this._bind=qh.bind(this.model,this)}}]),t}();K(Kh,Wh);var $h=new Set(["string","boolean","function"]),Jh=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t));return n.template=new qh({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{"class":"ck-icon-manager-sprite"}}),n}return xo(e,t),_o(e,[{key:"init",value:function(){return this.element.innerHTML=this.model.sprite,ko(Object.getPrototypeOf(e.prototype),"init",this).call(this)}}]),e}(Kh),Uh=["ck-icon-align-center","ck-icon-align-left","ck-icon-align-right","ck-icon-bold","ck-icon-bold","ck-icon-bulletedlist","ck-icon-image","ck-icon-italic","ck-icon-italic","ck-icon-link","ck-icon-numberedlist","ck-icon-picker","ck-icon-quote","ck-icon-redo","ck-icon-source","ck-icon-table","ck-icon-underline","ck-icon-undo","ck-icon-unlink"],Xh="ck-icon-",Yh=new Ih({icons:Uh.map(function(t){return t.slice(Xh.length)}),sprite:'<symbol viewBox="0 0 20 20" id="ck-icon-align-center"><title>align-center</title><path d="M16 10v1H4v-1h12zm-1 6v1H5v-1h10zm3-3v1H2v-1h16zm-2-9v1H4V4h12zm2 3v1H2V7h16z" fill="#444" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-align-left"><title>align-left</title><path d="M3 10v1h12v-1H3zm0 6v1h10v-1H3zm0-3v1h15v-1H3zm0-9v1h12V4H3zm0 3v1h15V7H3z" fill="#444" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-align-right"><title>align-right</title><path d="M17 10v1H5v-1h12zm0 6v1H7v-1h10zm0-3v1H2v-1h15zm0-9v1H5V4h12zm0 3v1H2V7h15z" fill="#444" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-bold"><title>bold</title><path d="M15.135 10.41c.36.247.654.558.88.933.225.375.338.816.338 1.324 0 .61-.128 1.123-.385 1.543-.256.42-.624.75-1.103.994a5.908 5.908 0 0 1-1.755.55c-.663.107-1.442.16-2.338.16H4.54v-.66a22.5 22.5 0 0 0 .66-.076c.264-.033.45-.073.557-.118.208-.085.35-.196.427-.334.076-.138.114-.317.114-.537V5.73c0-.203-.03-.372-.093-.507-.062-.135-.21-.254-.448-.355a3.326 3.326 0 0 0-.61-.182c-.23-.048-.433-.086-.608-.114v-.66h6.52c1.64 0 2.824.226 3.55.677.728.452 1.092 1.117 1.092 1.996 0 .406-.082.763-.245 1.07a2.388 2.388 0 0 1-.702.8c-.277.208-.606.388-.99.54-.383.153-.795.28-1.234.38v.162c.44.045.897.142 1.37.29.474.15.886.344 1.235.58zm-2.723-3.612c0-.665-.187-1.184-.562-1.556-.375-.372-.937-.558-1.687-.558a8.89 8.89 0 0 0-.42.012c-.17.01-.32.016-.443.02v4.45h.44c.913 0 1.587-.213 2.02-.64.435-.424.652-1 .652-1.728zm.592 5.76c0-.836-.248-1.476-.744-1.92-.496-.446-1.21-.67-2.14-.67a22.977 22.977 0 0 0-.82.034v4.39c.05.208.21.385.474.528.265.144.586.216.964.216.67 0 1.216-.225 1.636-.676.42-.452.63-1.086.63-1.903z" fill="#454545" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-bold"><title>bold</title><path d="M15.135 10.41c.36.247.654.558.88.933.225.375.338.816.338 1.324 0 .61-.128 1.123-.385 1.543-.256.42-.624.75-1.103.994a5.908 5.908 0 0 1-1.755.55c-.663.107-1.442.16-2.338.16H4.54v-.66a22.5 22.5 0 0 0 .66-.076c.264-.033.45-.073.557-.118.208-.085.35-.196.427-.334.076-.138.114-.317.114-.537V5.73c0-.203-.03-.372-.093-.507-.062-.135-.21-.254-.448-.355a3.326 3.326 0 0 0-.61-.182c-.23-.048-.433-.086-.608-.114v-.66h6.52c1.64 0 2.824.226 3.55.677.728.452 1.092 1.117 1.092 1.996 0 .406-.082.763-.245 1.07a2.388 2.388 0 0 1-.702.8c-.277.208-.606.388-.99.54-.383.153-.795.28-1.234.38v.162c.44.045.897.142 1.37.29.474.15.886.344 1.235.58zm-2.723-3.612c0-.665-.187-1.184-.562-1.556-.375-.372-.937-.558-1.687-.558a8.89 8.89 0 0 0-.42.012c-.17.01-.32.016-.443.02v4.45h.44c.913 0 1.587-.213 2.02-.64.435-.424.652-1 .652-1.728zm.592 5.76c0-.836-.248-1.476-.744-1.92-.496-.446-1.21-.67-2.14-.67a22.977 22.977 0 0 0-.82.034v4.39c.05.208.21.385.474.528.265.144.586.216.964.216.67 0 1.216-.225 1.636-.676.42-.452.63-1.086.63-1.903z" fill="#454545" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-bulletedlist"><title>bulletedlist</title><path d="M6 16v1h10v-1H6zM6 4v1h12V4H6zm0 6v1h11v-1H6zM1 4.5C1 3.672 1.666 3 2.5 3 3.328 3 4 3.666 4 4.5 4 5.328 3.334 6 2.5 6 1.672 6 1 5.334 1 4.5zm0 6C1 9.672 1.666 9 2.5 9c.828 0 1.5.666 1.5 1.5 0 .828-.666 1.5-1.5 1.5-.828 0-1.5-.666-1.5-1.5zm0 6c0-.828.666-1.5 1.5-1.5.828 0 1.5.666 1.5 1.5 0 .828-.666 1.5-1.5 1.5-.828 0-1.5-.666-1.5-1.5z" fill="#454545" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-image"><title>image</title><path d="M2 14.994A2 2 0 0 0 3.994 17h12.012A2 2 0 0 0 18 14.994V5.006A2 2 0 0 0 16.006 3H3.994A2 2 0 0 0 2 5.006v9.988zm1-9.992C3 4.45 3.45 4 4.007 4h11.986A1.01 1.01 0 0 1 17 5.002v9.996C17 15.55 16.55 16 15.993 16H4.007A1.01 1.01 0 0 1 3 14.998V5.002zm1.024 10H16v-3.096l-2.89-4.263-3.096 5.257-3.003-2.103L4 13.96l.024 1.043zM6.406 6A1.4 1.4 0 0 0 5 7.393a1.4 1.4 0 0 0 1.406 1.393 1.4 1.4 0 0 0 1.407-1.393A1.4 1.4 0 0 0 6.406 6z" fill="#454545" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-italic"><title>italic</title><path d="M13.825 3.914l-.126.558a5.7 5.7 0 0 0-.686.076c-.282.045-.49.088-.626.127-.237.073-.406.186-.508.338-.1.153-.174.32-.22.5l-2.03 8.77a1.24 1.24 0 0 0-.034.27c0 .13.03.24.086.33.056.09.157.168.304.236.085.04.27.085.558.14.288.052.502.085.643.096l-.127.558H5.656l.127-.558c.158-.01.383-.028.677-.05.293-.023.5-.057.625-.102.22-.08.387-.188.5-.326.112-.138.188-.306.228-.503l2.02-8.778a1.428 1.428 0 0 0 .035-.305.59.59 0 0 0-.072-.295c-.048-.085-.148-.16-.3-.23a3.457 3.457 0 0 0-.622-.19 5 5 0 0 0-.58-.105l.128-.558h5.403z" fill="#454545" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-italic"><title>italic</title><path d="M13.825 3.914l-.126.558a5.7 5.7 0 0 0-.686.076c-.282.045-.49.088-.626.127-.237.073-.406.186-.508.338-.1.153-.174.32-.22.5l-2.03 8.77a1.24 1.24 0 0 0-.034.27c0 .13.03.24.086.33.056.09.157.168.304.236.085.04.27.085.558.14.288.052.502.085.643.096l-.127.558H5.656l.127-.558c.158-.01.383-.028.677-.05.293-.023.5-.057.625-.102.22-.08.387-.188.5-.326.112-.138.188-.306.228-.503l2.02-8.778a1.428 1.428 0 0 0 .035-.305.59.59 0 0 0-.072-.295c-.048-.085-.148-.16-.3-.23a3.457 3.457 0 0 0-.622-.19 5 5 0 0 0-.58-.105l.128-.558h5.403z" fill="#454545" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-link"><title>link</title><g transform="rotate(45 5.793 16.243)" fill="#222" fill-rule="evenodd"><path d="M8 6.56V4.824a4 4 0 0 0-8 0v2.93c0 2.212 1.79 3.997 4 3.997.55 0 1.077-.112 1.555-.314H5.12v-.903a2.99 2.99 0 0 1-1.12.217c-1.657 0-3-1.336-3-2.997v-2.93a3 3 0 0 1 6 0V6.56h1z"/><path d="M2.636 6.902A3.99 3.99 0 0 1 4 6.662c2.21 0 4 1.786 4 3.997v2.93a4 4 0 0 1-4 3.996c-2.21 0-4-1.785-4-3.996v-1.927h1v1.927a3 3 0 0 0 6 0v-2.93a2.995 2.995 0 0 0-3-2.997c-.49 0-.954.118-1.364.327V6.902z"/></g></symbol><symbol viewBox="0 0 20 20" id="ck-icon-numberedlist"><title>numberedlist</title><g transform="translate(2 2)" fill="#454545" fill-rule="evenodd"><path d="M5 15h10v-1H5v1zM4 2v1h13V2H4zm1 6v1h11V8H5zM0 .5a.5.5 0 0 0 .5.5H1v3.5a.5.5 0 0 0 1 0v-4a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5zM.5 6a.5.5 0 0 0 0 1H2v1H.5a.5.5 0 0 0-.5.5v2a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 0-1H1V9h1.5a.46.46 0 0 0 .188-.03.45.45 0 0 0 .28-.282A.46.46 0 0 0 3 8.5v-2a.46.46 0 0 0-.03-.187.45.45 0 0 0-.283-.282.463.463 0 0 0-.124-.03H.5zM2.852 16.853a.493.493 0 0 0 .148-.35v-4.005A.493.493 0 0 0 2.505 12H.495a.494.494 0 0 0-.495.5c0 .268.222.5.495.5H2v1H.495a.494.494 0 0 0-.495.5c0 .268.222.5.495.5H2v1H.495a.494.494 0 0 0-.495.5c0 .268.222.5.495.5h2.01a.49.49 0 0 0 .35-.146z"/></g></symbol><symbol viewBox="0 0 20 20" id="ck-icon-picker"><title>picker</title><path d="M9.635 7.53l-6.252 6.473A2 2 0 0 0 6.26 16.78l6.252-6.472-.72-.695-6.25 6.474a1 1 0 0 1-1.44-1.39l6.252-6.473-.72-.695zm5.125.745c.115-.096.238-.21.37-.346 1.33-1.38 1.758-3.128.954-3.904-.805-.777-2.537-.29-3.868 1.09-.13.136-.24.262-.332.38l2.876 2.78zm-4.755-3.27l4.774 4.61-.663.685-4.774-4.61.662-.685z" fill="#454545" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-quote"><title>quote</title><path d="M12.06 15.51v-.882c1.396-.847 2.346-1.633 2.852-2.358.37-.533.553-1.162.553-1.887 0-.437-.082-.76-.246-.964-.15-.206-.33-.308-.534-.308-.137 0-.328.048-.574.143-.37.123-.67.185-.902.185-.547 0-1.033-.205-1.456-.615-.424-.41-.636-.923-.636-1.538 0-.698.212-1.238.636-1.62.587-.52 1.27-.78 2.05-.78.93 0 1.757.39 2.482 1.17.724.778 1.087 1.742 1.087 2.89 0 1.614-.602 3.084-1.805 4.41-.807.875-1.976 1.593-3.507 2.153zm-8.385 0v-.882c1.394-.847 2.345-1.633 2.85-2.358.37-.533.554-1.162.554-1.887 0-.437-.083-.76-.247-.964-.15-.206-.328-.308-.533-.308-.137 0-.328.048-.574.143-.37.123-.67.185-.903.185-.547 0-1.032-.205-1.456-.615-.424-.41-.636-.923-.636-1.538 0-.698.213-1.238.637-1.62.588-.52 1.272-.78 2.05-.78.93 0 1.758.39 2.482 1.17.724.778 1.086 1.742 1.086 2.89 0 1.614-.6 3.084-1.804 4.41-.807.875-1.976 1.593-3.507 2.153z" fill="#454545" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-redo"><title>redo</title><path d="M10 16l1-3.982c-3.417 0-8.616.87-10 3.982 0-5.983 6.6-7.96 10-7.96 0-.85-1-3.32-1-4.04l8 6-8 6z" fill="#454545" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-source"><title>source</title><path d="M15.116 7.96l2.426 2.207-.01-.417-.01-.525-5.87 5.83.916.924 5.87-5.833.485-.482-.506-.46-2.42-2.198-.88.954zm-2.96-2.69l-.483-.44.874-.96.49.446-.88.955zm-7.04 7.613l-2.443-2.22-.507-.46.486-.483 5.87-5.83.915.922-5.87 5.83-.02-.94 2.45 2.226-.882.955zm2.96 2.69L8.54 16l.875-.962-.46-.417-.882.954zM4.517 17.43L17.475 3.422l-.954-.882L3.565 16.548l.954.882z" fill="#232323" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-table"><title>table</title><path d="M3.994 4A2 2 0 0 0 2 6.006v9.988A2 2 0 0 0 3.994 18h12.012A2 2 0 0 0 18 15.994V6.006A2 2 0 0 0 16.006 4H3.994zM3 6.018h4v3H3v-3zm5 0h4v3H8v-3zm5 0h4v3h-4v-3zm-10 4h4v3H3v-3zm5 0h4v3H8v-3zm5 0h4v3h-4v-3zm-10 4h4v3H3v-3zm5 0h4v3H8v-3zm5 0h4v3h-4v-3z" fill="#454545" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-underline"><title>underline</title><g transform="translate(4 3)" fill="none" fill-rule="evenodd"><path d="M12.628 1.5a4.51 4.51 0 0 0-.678.1c-.297.06-.54.15-.726.272-.188.127-.317.388-.388.785-.072.396-.108.88-.108 1.453v5.096c0 .65-.135 1.214-.405 1.693-.27.478-.624.872-1.065 1.18a4.49 4.49 0 0 1-1.375.64c-.482.13-.943.194-1.383.194-.705 0-1.333-.092-1.883-.277-.55-.184-1.013-.433-1.388-.747a3.143 3.143 0 0 1-.835-1.078 2.986 2.986 0 0 1-.28-1.268v-6.93c0-.19-.032-.352-.096-.482s-.192-.25-.385-.36a1.93 1.93 0 0 0-.528-.185 4.137 4.137 0 0 0-.53-.087V.914H5.46V1.5c-.155.006-.35.03-.583.075a3.874 3.874 0 0 0-.516.124c-.187.065-.312.175-.375.33a1.313 1.313 0 0 0-.095.503v6.475c0 .313.034.642.103.987.07.344.205.664.41.962.214.303.505.55.874.743.37.193.876.29 1.52.29.606 0 1.114-.097 1.524-.29.41-.193.734-.446.97-.76a2.84 2.84 0 0 0 .48-.933c.094-.325.14-.652.14-.983V4.218c0-.612-.044-1.11-.132-1.5-.088-.388-.217-.642-.388-.763-.192-.138-.455-.245-.788-.322a5.096 5.096 0 0 0-.764-.133V.914h4.79V1.5z" fill="#454545"/><path fill="#585858" d="M0 14h12v1H0z"/></g></symbol><symbol viewBox="0 0 20 20" id="ck-icon-undo"><title>undo</title><path d="M2 10l8 6-1-3.982c3.417 0 8.616.87 10 3.982 0-5.983-6.6-7.96-10-7.96 0-.85 1-3.32 1-4.04l-8 6z" fill="#454545" fill-rule="evenodd"/></symbol><symbol viewBox="0 0 20 20" id="ck-icon-unlink"><title>unlink</title><g transform="rotate(45 5.793 16.243)" fill="#222" fill-rule="evenodd"><path d="M8 6.56V4.824a4 4 0 0 0-8 0v2.93c0 2.212 1.79 3.997 4 3.997.55 0 1.077-.112 1.555-.314H5.12v-.903a2.99 2.99 0 0 1-1.12.217c-1.657 0-3-1.336-3-2.997v-2.93a3 3 0 0 1 6 0V6.56h1z"/><path d="M12.13 9.692V6.076h-1.02v3.616H7.793v1.02h3.317v3.616h1.02v-3.616h3.915v-1.02H12.13zm-4.604-1.05A4.067 4.067 0 0 0 2.69 6.98v1.123a3.02 3.02 0 0 1 1.39-.338c1.167 0 2.18.656 2.698 1.625l.748-.748zm.636 3.752v1.484c0 2.276-1.83 4.122-4.08 4.122C1.825 18 0 16.16 0 13.878V11.89h1.02v1.988c0 1.713 1.37 3.09 3.06 3.09 1.688 0 3.062-1.383 3.062-3.09v-2.504l1.02 1.02z"/></g></symbol>'
}),Gh=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this));return n.editor=t,n.featureComponents=new Nh(t),n.collections.add(new Vh("body")),n}return xo(e,t),_o(e,[{key:"init",value:function(){return this._setupIconManager(),ko(Object.getPrototypeOf(e.prototype),"init",this).call(this)}},{key:"_setupIconManager",value:function(){this.icons=Yh.icons,this.collections.get("body").add(new Dh(Yh,new Jh))}}]),e}(Fh);K(Gh,za);var Qh=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t));n.collections.add(new Vh("top")),n.collections.add(new Vh("main"));var r=t.config;return n.set("width",r.get("ui.width")),n.set("height",r.get("ui.height")),n}return xo(e,t),e}(Gh),Zh=function(t){function e(t,n,r){wo(this,e);var i=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return i.editor=r,n.model.bind("isReadOnly","isFocused").to(t),n.model.set("name",t.rootName),i}return xo(e,t),e}(Fh),td=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t)),i=r.bind;return n&&(r.element=r.editableElement=n),r.template=new qh({tag:"div",attributes:{"class":[i.to("isFocused",function(t){return t?"ck-focused":"ck-blurred"}),"ck-editor__editable"],contenteditable:i.to("isReadOnly",function(t){return!t})}}),r}return xo(e,t),_o(e,[{key:"init",value:function(){this.editableElement?this.template.apply(this.editableElement):this.editableElement=this.element,ko(Object.getPrototypeOf(e.prototype),"init",this).call(this)}},{key:"destroy",value:function(){ko(Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.editableElement.contentEditable=!1}}]),e}(Kh),ed=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n)),i=r.bind,o=r.t,a=function(t){return o("Rich Text Editor, %0",[t])};return qh.extend(r.template,{attributes:{role:"textbox","aria-label":i.to("name",a),title:i.to("name",a),"class":"ck-editor__editable_inline"}}),r}return xo(e,t),e}(td),nd={addButtons:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.add("buttons",this.editor.ui.featureComponents.create(a))}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}}},rd=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return r.collections.add(new Vh("buttons")),r}return xo(e,t),e}(Fh),id=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return n.model.bind("isActive").to(t),r}return xo(e,t),e}(rd),od=function(t){function e(t,n,r){wo(this,e);var i=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return i.editor=r,i}return xo(e,t),e}(id);K(od,nd);var ad=function(t){function e(){wo(this,e);var t=Oo(this,Object.getPrototypeOf(e).call(this));return t.template=new qh({tag:"div",attributes:{"class":["ck-reset ck-toolbar"]}}),t.register("buttons",function(t){return t}),t}return xo(e,t),e}(Kh),sd=function(t){function e(){wo(this,e);var t=Oo(this,Object.getPrototypeOf(e).call(this)),n=t.bind;return t.model.set("isSticky",!1),qh.extend(t.template,{attributes:{"class":n["if"]("isSticky","ck-toolbar_sticky")}}),t}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this;ko(Object.getPrototypeOf(e.prototype),"init",this).call(this),this._elementPlaceholder=document.createElement("div"),this._elementPlaceholder.classList.add("ck-toolbar__placeholder"),this.element.parentNode.insertBefore(this._elementPlaceholder,this.element),this.listenTo(window,"scroll",function(){t._checkIfShouldBeSticky()}),this.listenTo(this.model,"change:isActive",function(e,n,r){r?t._checkIfShouldBeSticky():t._detach()})}},{key:"destroy",value:function(){ko(Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this._elementPlaceholder.remove()}},{key:"_checkIfShouldBeSticky",value:function(){var t=this.model.isSticky?this._elementPlaceholder:this.element,e=t.getBoundingClientRect();e.top<0&&this.model.isActive?this._stick(e):this._detach()}},{key:"_stick",value:function(t){Object.assign(this._elementPlaceholder.style,{display:"block",height:t.height+"px"}),Object.assign(this.element.style,{width:t.width+2+"px",marginLeft:-window.scrollX-1+"px"}),this.model.isSticky=!0}},{key:"_detach",value:function(){Object.assign(this._elementPlaceholder.style,{display:"none"}),Object.assign(this.element.style,{width:"auto",marginLeft:"auto"}),this.model.isSticky=!1}}]),e}(ad),ud=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t));return n.toolbar=n._createToolbar(),n.editable=n._createEditableUI(),n}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this.editor.config.get("toolbar");return t&&this.toolbar.addButtons(t),ko(Object.getPrototypeOf(e.prototype),"init",this).call(this)}},{key:"_createToolbar",value:function(){var t=this.editor,e=new Ih;e.bind("isActive").to(t.editing.view.getRoot(),"isFocused");var n=new od(e,new sd(t.locale),t);return this.add("top",n),n}},{key:"_createEditableUI",value:function(){var t=this.editor,e=t.editing.view.getRoot(),n=new Zh(e,new ed(t.locale),t);return this.add("main",n),n}},{key:"editableElement",get:function(){return this.editable.view.element}}]),e}(Qh),ld=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t));return n._createBodyRegion(),n}return xo(e,t),_o(e,[{key:"destroy",value:function(){this._bodyRegionContainer.remove(),this._bodyRegionContainer=null}},{key:"_createBodyRegion",value:function(){var t=document.createElement("div");document.body.appendChild(t),new qh({attributes:{"class":"ck-body ck-reset-all"}}).apply(t),this._bodyRegionContainer=t,this.register("body",function(){return t})}}]),e}(Kh),cd=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t)),r=n.t,i=Co();return n.template=new qh({tag:"div",attributes:{"class":["ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:"ltr",lang:t.lang,"aria-labelledby":"cke-editor__aria-label_"+i},children:[{tag:"span",attributes:{id:"cke-editor__aria-label_"+i,"class":"cke-voice-label",children:[r("Rich Text Editor")]}},{tag:"div",attributes:{"class":"ck-editor__top ck-reset-all",role:"presentation"}},{tag:"div",attributes:{"class":"ck-editor__main",role:"presentation"}}]}),n.register("top",".ck-editor__top"),n.register("main",".ck-editor__main"),n}return xo(e,t),e}(ld),fd=function(){function t(){wo(this,t),this._replacedElements=[]}return _o(t,[{key:"replace",value:function(t,e){this._replacedElements.push({element:t,newElement:e}),t.style.display="none",e&&t.parentNode.insertBefore(e,t.nextSibling)}},{key:"restore",value:function(){this._replacedElements.forEach(function(t){var e=t.element,n=t.newElement;e.style.display="",n&&n.remove()}),this._replacedElements=[]}}]),t}(),hd=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return r.document.createRoot(),r.editing.createRoot("div"),r.data.processor=new jh,r.ui=new ud(r),r.ui.view=new cd(r.locale),r._elementReplacer=new fd,r}return xo(e,t),_o(e,[{key:"destroy",value:function(){var t=this;return this.updateEditorElement(),this._elementReplacer.restore(),this.ui.destroy().then(function(){return ko(Object.getPrototypeOf(e.prototype),"destroy",t).call(t)})}}],[{key:"create",value:function(t,n){return new Promise(function(r){var i=new e(t,n);r(i.initPlugins().then(function(){return i._elementReplacer.replace(t,i.ui.view.element)}).then(function(){return i.ui.init()}).then(function(){return i.editing.view.attachDomRoot(i.ui.editableElement)}).then(function(){return i.loadDataFromEditorElement()}).then(function(){return i}))})}}]),e}(Th),dd=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),e}(qa),vd=function(){function t(e){var n=this;wo(this,t),this.editor=e,this.set("isEnabled",!0),this._checkEnabled&&this.on("refreshState",function(t,e){e.isEnabled=n._checkEnabled()})}return _o(t,[{key:"destroy",value:function(){this.stopListening()}},{key:"refreshState",value:function(){var t={isEnabled:!0};this.fire("refreshState",t),this.isEnabled=t.isEnabled}},{key:"_execute",value:function(t){this.isEnabled&&this._doExecute(t)}},{key:"_disable",value:function(){this.on("refreshState",Zi),this.refreshState()}},{key:"_enable",value:function(){this.off("refreshState",Zi),this.refreshState()}},{key:"_doExecute",value:function(){}}]),t}();K(vd,za);for(var yd=function(){function t(e){var n=this,r=arguments.length<=1||void 0===arguments[1]?20:arguments[1];wo(this,t),this.document=e,this.size=0,this.limit=r,this._changeCallback=function(t,e,r,i){n._onBatch(i)},e.on("change",this._changeCallback)}return _o(t,[{key:"input",value:function(t){this.size+=t,this.size>=this.limit&&this._reset()}},{key:"destroy",value:function(){this.document.off("change",this._changeCallback)}},{key:"_onBatch",value:function(t){"transparent"!=t.type&&t!==this._batch&&to(t.getOperations())<=1&&this._reset()}},{key:"_reset",value:function(){this._batch=null,this.size=0}},{key:"batch",get:function(){return this._batch||(this._batch=this.document.batch()),this._batch}}]),t}(),gd=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t));return r.direction=n,r._buffer=new yd(t.document,t.config.get("undo.step")),r}return xo(e,t),_o(e,[{key:"_doExecute",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=this.editor.document;n.enqueueChanges(function(){var r=uh.createFromSelection(n.selection);if(r.isCollapsed&&n.composer.modifySelection(r,{direction:t.direction,unit:e.unit}),!r.isCollapsed){var i=0;r.getFirstRange().getMinimalFlatRanges().forEach(function(t){i+=to(t.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),n.composer.deleteContents(t._buffer.batch,r,{merge:!0}),t._buffer.input(i),n.selection.setRanges(r.getRanges(),r.isBackward)}})}}]),e}(vd),pd=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t));return t.on("keydown",function(e,n){var r={};if(n.keyCode==xs["delete"])r.direction="FORWARD";else{if(n.keyCode!=xs.backspace)return;r.direction="BACKWARD"}r.unit=n.altKey?"WORD":"CHARACTER",t.fire("delete",new Ph(t,n.domEvent,r))}),n}return xo(e,t),_o(e,[{key:"observe",value:function(){}}]),e}(kh),md=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this.editor,e=t.editing.view;e.addObserver(pd),t.commands.set("forwardDelete",new gd(t,"FORWARD")),t.commands.set("delete",new gd(t,"BACKWARD")),this.listenTo(e,"delete",function(e,n){t.execute("FORWARD"==n.direction?"forwardDelete":"delete"),n.preventDefault()})}}]),e}(dd),bd=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this,e=this.editor,n=e.editing.view;this._buffer=new yd(e.document,e.config.get("typing.undoStep")||20),this.listenTo(n,"keydown",function(e,n){t._handleKeydown(n)},null,9999),this.listenTo(n,"mutations",function(e,n){t._handleMutations(n)})}},{key:"destroy",value:function(){ko(Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this._buffer.destroy(),this._buffer=null}},{key:"_handleKeydown",value:function(t){var e=this,n=this.editor.document;no(t)||n.selection.isCollapsed||n.enqueueChanges(function(){n.composer.deleteContents(e._buffer.batch,n.selection)})}},{key:"_handleMutations",value:function(t){var e=this.editor.document,n=new wd(this.editor.editing,this._buffer);e.enqueueChanges(function(){return n.handle(t)})}}]),e}(dd),wd=function(){function t(e,n){wo(this,t),this.editing=e,this.buffer=n,this.insertedCharacterCount=0}return _o(t,[{key:"handle",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this._handleTextMutation(a),this._handleTextNodeInsertion(a)}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}this.buffer.input(Math.max(this.insertedCharacterCount,0)),this.selectionPosition&&this.editing.model.selection.collapse(this.selectionPosition)}},{key:"_handleTextMutation",value:function(t){if("text"==t.type){var e=xi(t.oldText,t.newText),n=eo(e,t.newText),r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,l=new cs(t.node,u.index),c=this.editing.mapper.toModelPosition(l);if("INSERT"==u.type){var f=u.values.join("");this._insert(c,f),this.selectionPosition=rs.createAt(c.parent,c.offset+f.length)}else this._remove(new Ga(c,c.getShiftedBy(u.howMany)),u.howMany),this.selectionPosition=c}}catch(h){i=!0,o=h}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}}},{key:"_handleTextNodeInsertion",value:function(t){function e(t,e){return t instanceof os&&e instanceof os?t.data===e.data:t===e}if("children"==t.type&&t.newChildren.length-t.oldChildren.length==1){var n=xi(t.oldChildren,t.newChildren,e),r=eo(n,t.newChildren);if(!(r.length>1)){var i=r[0];if(i.values[0]instanceof os){var o=new cs(t.node,i.index),a=this.editing.mapper.toModelPosition(o),s=i.values[0].data;this._insert(a,s),this.selectionPosition=rs.createAt(a.parent,"END")}}}}},{key:"_insert",value:function(t,e){this.buffer.batch.weakInsert(t,e),this.insertedCharacterCount+=e.length}},{key:"_remove",value:function(t,e){this.buffer.batch.remove(t),this.insertedCharacterCount-=e}}]),t}(),_d=[Ot("arrowUp"),Ot("arrowRight"),Ot("arrowDown"),Ot("arrowLeft"),16,17,18,20,27,33,34,35,36],kd=112;kd<=135;kd++)_d.push(kd);var xd=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t));return n._stack=[],n._createdBatches=new WeakSet,n.refreshState(),n}return xo(e,t),_o(e,[{key:"addBatch",value:function(t){var e={ranges:Array.from(this.editor.document.selection.getRanges()),isBackward:this.editor.document.selection.isBackward};this._stack.push({batch:t,selection:e}),this.refreshState()}},{key:"clearStack",value:function(){this._stack=[],this.refreshState()}},{key:"_checkEnabled",value:function(){return this._stack.length>0}}]),e}(vd),Od=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"_doExecute",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?null:arguments[0],n=e?this._stack.findIndex(function(t){return t.batch==e}):this._stack.length-1,r=this._stack.splice(n,1)[0];this.editor.document.enqueueChanges(function(){t._undo(r.batch),t._restoreSelection(r.selection.ranges,r.selection.isBackward,r.batch.baseVersion)}),this.fire("revert",r.batch),this.refreshState()}},{key:"_getItemIndexFromBaseVersion",value:function(t){for(var e=0;e<this._stack.length;e++)if(this._stack[e].batch.baseVersion==t)return e;return null}},{key:"_undo",value:function(t){var e=this.editor.document,n=e.batch();this._createdBatches.add(n);var r=e.history,i=t.deltas.slice();i.reverse();var o=!0,a=!1,s=void 0;try{for(var u,l=i[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value,f=c.baseVersion,h=f+c.operations.length,d=r.getDelta(f);if(null!==d){d.reverse();var v=[],y=!0,g=!1,p=void 0;try{for(var m,b=d[Symbol.iterator]();!(y=(m=b.next()).done);y=!0){var w=m.value;v.push(w.getReversed())}}catch(_){g=!0,p=_}finally{try{!y&&b["return"]&&b["return"]()}finally{if(g)throw p}}var k={},x=!0,O=!1,P=void 0;try{for(var S,A=r.getDeltas(h)[Symbol.iterator]();!(x=(S=A.next()).done);x=!0){var C=S.value,E=this._getItemIndexFromBaseVersion(C.baseVersion);null!==E&&(this._stack[E].selection.ranges=oo(this._stack[E].selection.ranges,v));var T=ro([C],v,!1);v=ro(v,[C],!0),k[C.baseVersion]||(k[C.baseVersion]=[]),k[C.baseVersion]=k[C.baseVersion].concat(T)}}catch(_){O=!0,P=_}finally{try{!x&&A["return"]&&A["return"]()}finally{if(O)throw P}}var R=!0,j=!1,M=void 0;try{for(var F,V=v[Symbol.iterator]();!(R=(F=V.next()).done);R=!0){var N=F.value;N.baseVersion=e.version,n.addDelta(N);var D=!0,I=!1,B=void 0;try{for(var L,z=N.operations[Symbol.iterator]();!(D=(L=z.next()).done);D=!0){var q=L.value;e.applyOperation(q)}}catch(_){I=!0,B=_}finally{try{!D&&z["return"]&&z["return"]()}finally{if(I)throw B}}}}catch(_){j=!0,M=_}finally{try{!R&&V["return"]&&V["return"]()}finally{if(j)throw M}}r.removeDelta(f);var H=!0,W=!1,K=void 0;try{for(var $,J=v[Symbol.iterator]();!(H=($=J.next()).done);H=!0){var U=$.value;r.removeDelta(U.baseVersion)}}catch(_){W=!0,K=_}finally{try{!H&&J["return"]&&J["return"]()}finally{if(W)throw K}}for(var X in k)r.updateDelta(Number(X),k[X])}}}catch(_){a=!0,s=_}finally{try{!o&&l["return"]&&l["return"]()}finally{if(a)throw s}}}},{key:"_restoreSelection",value:function(t,e,n){var r=this.editor.document,i=[],o=!0,a=!1,s=void 0;try{for(var u,l=t[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value,f=io(c,n,r),h=f.find(function(t){return t.start.root!=r.graveyard});h&&i.push(h)}}catch(d){a=!0,s=d}finally{try{!o&&l["return"]&&l["return"]()}finally{if(a)throw s}}i.length&&r.selection.setRanges(i,e)}}]),e}(xd),Pd=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"_doExecute",value:function(){var t=this,e=this._stack.pop();this.editor.document.enqueueChanges(function(){t._redo(e.batch),t._restoreSelection(e.selection.ranges,e.selection.isBackward)}),this.refreshState()}},{key:"_redo",value:function(t){var e=this.editor.document,n=e.batch();this._createdBatches.add(n);var r=t.deltas.slice();r.reverse();var i=!0,o=!1,a=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value,c=l.baseVersion+l.operations.length,f=[l.getReversed()],h=!0,d=!1,v=void 0;try{for(var y,g=e.history.getDeltas(c)[Symbol.iterator]();!(h=(y=g.next()).done);h=!0){var p=y.value;this._createdBatches.has(p.batch)||(f=ro(f,[p],!0))}}catch(m){d=!0,v=m}finally{try{!h&&g["return"]&&g["return"]()}finally{if(d)throw v}}var b=!0,w=!1,_=void 0;try{for(var k,x=f[Symbol.iterator]();!(b=(k=x.next()).done);b=!0){var O=k.value;O.baseVersion=e.version,n.addDelta(O);var P=!0,S=!1,A=void 0;try{for(var C,E=O.operations[Symbol.iterator]();!(P=(C=E.next()).done);P=!0){var T=C.value;e.applyOperation(T)}}catch(m){S=!0,A=m}finally{try{!P&&E["return"]&&E["return"]()}finally{if(S)throw A}}}}catch(m){w=!0,_=m}finally{try{!b&&x["return"]&&x["return"]()}finally{if(w)throw _}}}}catch(m){o=!0,a=m}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}}},{key:"_restoreSelection",value:function(t,e){this.editor.document.selection.setRanges(t,e)}}]),e}(xd),Sd=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t));return n._batchRegistry=new WeakSet,n}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this;this._undoCommand=new Od(this.editor),this._redoCommand=new Pd(this.editor),this.editor.commands.set("undo",this._undoCommand),this.editor.commands.set("redo",this._redoCommand),this.listenTo(this.editor.document,"change",function(e,n,r,i){t._batchRegistry.has(i)||"transparent"==i.type||(t._undoCommand._createdBatches.has(i)?t._redoCommand.addBatch(i):t._redoCommand._createdBatches.has(i)?t._undoCommand.addBatch(i):(t._undoCommand.addBatch(i),t._redoCommand.clearStack()),t._batchRegistry.add(i))})}}]),e}(dd),Ad=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return n.model.bind("name","align").to(t),r}return xo(e,t),e}(Fh),Cd=function(t){function e(){wo(this,e);var t=Oo(this,Object.getPrototypeOf(e).call(this)),n=t.bind;return t.template=new qh({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{"class":["ck-icon",n.to("align",function(t){return t?"ck-icon-"+t.toLowerCase():""})]},children:[{tag:"use",ns:"http://www.w3.org/2000/svg",attributes:{href:{ns:"http://www.w3.org/1999/xlink",value:n.to("name",function(t){return"#ck-icon-"+t})}}}]}),t}return xo(e,t),e}(Kh),Ed=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return n.model.bind("label","isOn","isEnabled","noText").to(t),t.icon&&n.model.bind("icon","iconAlign").to(t),n.model.on("click",function(){return t.fire("execute")}),r}return xo(e,t),_o(e,[{key:"init",value:function(){if(this.model.icon){this.collections.add(new Vh("children"));var t=new Ih;t.bind("name","align").to(this.model,"icon","iconAlign"),this.add("children",new Ad(t,new Cd))}return ko(Object.getPrototypeOf(e.prototype),"init",this).call(this)}}]),e}(Fh),Td=function(t){function e(){wo(this,e);var t=Oo(this,Object.getPrototypeOf(e).call(this)),n=t.bind;return t.template=new qh({tag:"button",attributes:{"class":["ck-button",n.to("isEnabled",function(t){return t?"ck-enabled":"ck-disabled"}),n.to("isOn",function(t){return t?"ck-on":"ck-off"}),n["if"]("noText","ck-button-notext")]},children:[{tag:"span",attributes:{"class":["ck-button__label"]},children:[{text:n.to("label")}]}],on:{mousedown:n.to(function(t){t.preventDefault()}),click:n.to(function(){t.model.isEnabled&&t.model.fire("click")})}}),t.register("children",function(t){return t}),t}return xo(e,t),e}(Kh),Rd=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this.editor,e=t.t;this._addButton("undo",e("Undo")),this._addButton("redo",e("Redo")),t.keystrokes.set("CTRL+Z","undo"),t.keystrokes.set("CTRL+Y","redo"),t.keystrokes.set("CTRL+SHIFT+Z","redo")}},{key:"_addButton",value:function(t,e){var n=this.editor,r=n.commands.get(t),i=new Ih({isOn:!1,label:e,noText:!0,icon:t,iconAlign:"LEFT"});i.bind("isEnabled").to(r,"isEnabled"),this.listenTo(i,"execute",function(){return n.execute(t)}),n.ui.featureComponents.add(t,Ed,Td,i)}}],[{key:"requires",get:function(){return[Sd]}}]),e}(dd),jd=function(){function t(e){wo(this,t),this._dispatchers=e,this._from=null}return _o(t,[{key:"fromElement",value:function(t){return this._from={type:"element",name:t,priority:null},this}},{key:"fromAttribute",value:function(t){return this._from={type:"attribute",key:t,priority:null},this}},{key:"withPriority",value:function(t){return this._from.priority=t,this}},{key:"toElement",value:function(t){var e=null===this._from.priority?10:this._from.priority,n=!0,r=!1,i=void 0;try{for(var o,a=this._dispatchers[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;"element"==this._from.type?(t="string"==typeof t?new us(t):t,s.on("insert:"+this._from.name,rt(t),null,e)):(t="string"==typeof t?new ws(t):t,s.on("addAttribute:"+this._from.key,st(t),null,e),s.on("changeAttribute:"+this._from.key,st(t),null,e),s.on("removeAttribute:"+this._from.key,ut(t),null,e),s.on("selectionAttribute:"+this._from.key,Ei(t),null,e))}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}}},{key:"toAttribute",value:function(t,e){if("element"!=this._from.type){var n=void 0;n=t?"string"==typeof t?e?function(){return{key:t,value:e}}:function(e){return{key:t,value:e}}:t:void 0;var r=!0,i=!1,o=void 0;try{for(var a,s=this._dispatchers[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u.on("addAttribute:"+this._from.key,ot(n),null,this._from.priority||10),u.on("changeAttribute:"+this._from.key,ot(n),null,this._from.priority||10),u.on("removeAttribute:"+this._from.key,at(n),null,this._from.priority||10)}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}}}]),t}(),Md=function(){function t(){wo(this,t),this._patterns=[],this.add.apply(this,arguments)}return _o(t,[{key:"add",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;("string"==typeof u||u instanceof RegExp)&&(u={name:u}),u["class"]&&("string"==typeof u["class"]||u["class"]instanceof RegExp)&&(u["class"]=[u["class"]]),this._patterns.push(u)}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}},{key:"match",value:function e(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value,c=!0,f=!1,h=void 0;try{for(var d,v=this._patterns[Symbol.iterator]();!(c=(d=v.next()).done);c=!0){var y=d.value,e=so(l,y);if(e)return{element:l,pattern:y,match:e}}}catch(g){f=!0,h=g}finally{try{!c&&v["return"]&&v["return"]()}finally{if(f)throw h}}}}catch(g){o=!0,a=g}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return null}},{key:"matchAll",value:function(){for(var t=[],e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value,c=!0,f=!1,h=void 0;try{for(var d,v=this._patterns[Symbol.iterator]();!(c=(d=v.next()).done);c=!0){var y=d.value,g=so(l,y);g&&t.push({element:l,pattern:y,match:g})}}catch(p){f=!0,h=p}finally{try{!c&&v["return"]&&v["return"]()}finally{if(f)throw h}}}}catch(p){o=!0,a=p}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return t.length>0?t:null}},{key:"getElementName",value:function(){return 1!=this._patterns.length||!this._patterns[0].name||this._patterns[0].name instanceof RegExp?null:this._patterns[0].name}}]),t}(),Fd=function(){function t(e){wo(this,t),this._dispatchers=e,this._from=[]}return _o(t,[{key:"fromElement",value:function(t){return this.from({name:t})}},{key:"fromAttribute",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?/.*/:arguments[1],n={};return n[t]=e,this.from(n)}},{key:"from",value:function(t){return t instanceof Md||(t=new Md(t)),this._from.push({matcher:t,consume:!1,priority:null}),this}},{key:"consuming",value:function(t){var e=this._from[this._from.length-1];return e.consume=t,this}},{key:"withPriority",value:function(t){var e=this._from[this._from.length-1];return e.priority=t,this}},{key:"toElement",value:function(t){var e=function(e){return function(n,r,i,o){var a=e.matcher.matchAll(r.input);if(a){var s=!0,u=!1,l=void 0;try{for(var c,f=a[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var h=c.value,d=t instanceof Function?t(r.input):new Qa(t),v=Array.from(d.getAttributes()).map(function(t){return t[0]});if(o.schema.check({name:d.name,attributes:v,inside:r.context})&&i.consume(r.input,e.consume||h.match)){r.context.push(d),d.appendChildren(o.convertChildren(r.input,i,r)),r.context.pop(),r.output=d;break}}}catch(y){u=!0,l=y}finally{try{!s&&f["return"]&&f["return"]()}finally{if(u)throw l}}}}};this._setCallback(e,10)}},{key:"toAttribute",value:function(t,e){var n=function(n){return function(r,i,o,a){var s=n.matcher.matchAll(i.input);if(s){var u=!0,l=!1,c=void 0;try{for(var f,h=s[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var d=f.value;if(o.consume(i.input,n.consume||d.match)){i.output||(i.output=a.convertChildren(i.input,o,i));var v=t instanceof Function?t(i.input):{key:t,value:e};ho(i.output,v,i,a);break}}}catch(y){l=!0,c=y}finally{try{!u&&h["return"]&&h["return"]()}finally{if(l)throw c}}}}};this._setCallback(n,1e3)}},{key:"_setCallback",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=this._from[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.matcher.getElementName(),l=u?"element:"+u:"element",c=t(s),f=null===s.priority?e:s.priority,h=!0,d=!1,v=void 0;try{for(var y,g=this._dispatchers[Symbol.iterator]();!(h=(y=g.next()).done);h=!0){var p=y.value;p.on(l,c,null,f)}}catch(m){d=!0,v=m}finally{try{!h&&g["return"]&&g["return"]()}finally{if(d)throw v}}}}catch(m){r=!0,i=m}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}}}]),t}(),Vd=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t));return r.attributeKey=n,r.set("value",!1),r.listenTo(r.editor.document.selection,"change:attribute",function(){r.value=r.editor.document.selection.hasAttribute(r.attributeKey)}),r}return xo(e,t),_o(e,[{key:"_checkEnabled",value:function(){var t=this.editor.document.selection,e=this.editor.document.schema;if(t.isCollapsed)return e.check({name:"$text",inside:t.getFirstPosition(),attributes:this.attributeKey});var n=t.getRanges(),r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)for(var u=a.value,l=new Ya({boundaries:u,mergeCharacters:!0}),c=l.position,f=l.next();!f.done;){var h=f.value.item.name||"$text";if(e.check({name:h,inside:c,attributes:this.attributeKey}))return!0;c=l.position,f=l.next()}}catch(d){i=!0,o=d}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return!1}},{key:"_doExecute",value:function(t){var e=this,n=this.editor.document,r=n.selection,i=void 0===t?!this.value:t;r.isCollapsed?i?r.setAttribute(this.attributeKey,!0):r.removeAttribute(this.attributeKey):n.enqueueChanges(function(){var t=e._getSchemaValidRanges(r.getRanges()),o=n.batch(),a=!0,s=!1,u=void 0;try{for(var l,c=t[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value;i?o.setAttr(e.attributeKey,i,f):o.removeAttr(e.attributeKey,f)}}catch(h){s=!0,u=h}finally{try{!a&&c["return"]&&c["return"]()}finally{if(s)throw u}}})}},{key:"_getSchemaValidRanges",value:function(t){var e=[],n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){for(var s=o.value,u=new Ya({boundaries:s,mergeCharacters:!0}),l=u.next(),c=s.start,f=s.start,h=s.end;!l.done;){var d=l.value.item.name||"$text";this.editor.document.schema.check({name:d,inside:c,attributes:this.attributeKey})||(f.isEqual(c)||e.push(new Ga(f,c)),f=u.position),c=u.position,l=u.next()}f&&!f.isEqual(h)&&e.push(new Ga(f,h))}}catch(v){r=!0,i=v}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return e}}]),e}(vd),Nd="bold",Dd=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this.editor,e=t.data,n=t.editing;t.document.schema.allow({name:"$inline",attributes:[Nd]}),ao(e.modelToView,n.modelToView).fromAttribute(Nd).toElement("strong"),vo(e.viewToModel).fromElement("strong").fromElement("b").fromAttribute("style",{"font-weight":"bold"}).toAttribute(Nd,!0),t.commands.set(Nd,new Vd(t,Nd))}}]),e}(dd),Id=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this.editor,e=t.t,n=t.commands.get("bold"),r=new Ih({isEnabled:!0,isOn:!1,label:e("Bold"),noText:!0,icon:"bold",iconAlign:"LEFT"});r.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(r,"execute",function(){return t.execute("bold")}),t.ui.featureComponents.add("bold",Ed,Td,r),t.keystrokes.set("CTRL+B","bold")}}],[{key:"requires",get:function(){return[Dd]}}]),e}(dd),Bd="italic",Ld=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this.editor,e=t.data,n=t.editing;t.document.schema.allow({name:"$inline",attributes:[Bd]}),ao(e.modelToView,n.modelToView).fromAttribute(Bd).toElement("em"),vo(e.viewToModel).fromElement("em").fromElement("i").fromAttribute("style",{"font-style":"italic"}).toAttribute(Bd,!0),t.commands.set(Bd,new Vd(t,Bd))}}]),e}(dd),zd=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this.editor,e=t.t,n=t.commands.get("italic"),r=new Ih({isEnabled:!0,isOn:!1,label:e("Italic"),noText:!0,icon:"italic",iconAlign:"LEFT"});r.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(r,"execute",function(){return t.execute("italic")}),t.ui.featureComponents.add("italic",Ed,Td,r),t.keystrokes.set("CTRL+I","italic")}}],[{key:"requires",get:function(){return[Ld]}}]),e}(dd),qd=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this.editor,e=t.data,n=t.editing;t.document.schema.registerItem("paragraph","$block"),ao(e.modelToView,n.modelToView).fromElement("paragraph").toElement("p"),
vo(e.viewToModel).fromElement("p").toElement("paragraph")}}]),e}(dd),Hd=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t));return r.formats=n,r.set("value",r.defaultFormat),r.listenTo(t.document.selection,"change",function(){var e=t.document.selection.getFirstPosition(),n=yo(e);if(n){var i=r._getFormatById(n.name);r.value=i}}),r}return xo(e,t),_o(e,[{key:"_doExecute",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?this.defaultFormat.id:arguments[0],n=this.editor.document,r=n.selection,i=r.getFirstPosition(),o=[],a=[].concat(So(r.getRanges())),s=r.isBackward,u=e===this.value.id;if(r.isCollapsed){var l=yo(i);l&&o.push(l)}else{var c=!0,f=!1,h=void 0;try{for(var d,v=a[Symbol.iterator]();!(c=(d=v.next()).done);c=!0){var y=d.value,g=yo(y.start),p=yo(y.end,!1);for(o.push(g);g!==p;)g=g.nextSibling,o.push(g)}}catch(m){f=!0,h=m}finally{try{!c&&v["return"]&&v["return"]()}finally{if(f)throw h}}}n.enqueueChanges(function(){var r=n.batch(),i=!0,l=!1,c=void 0;try{for(var f,h=o[Symbol.iterator]();!(i=(f=h.next()).done);i=!0){var d=f.value;u?d.name===e&&r.rename(t.defaultFormat.id,d):r.rename(e,d)}}catch(v){l=!0,c=v}finally{try{!i&&h["return"]&&h["return"]()}finally{if(l)throw c}}n.selection.setRanges(a,s)})}},{key:"_getFormatById",value:function(t){return this.formats.find(function(e){return e.id===t})}},{key:"defaultFormat",get:function(){return this._getFormatById("paragraph")}}]),e}(vd),Wd=[{id:"paragraph",viewElement:"p",label:"Paragraph"},{id:"heading1",viewElement:"h2",label:"Heading 1"},{id:"heading2",viewElement:"h3",label:"Heading 2"},{id:"heading3",viewElement:"h4",label:"Heading 3"}],Kd=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this.editor,e=t.data,n=t.editing,r=!0,i=!1,o=void 0;try{for(var a,s=Wd[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;"paragraph"!==u.id&&(t.document.schema.registerItem(u.id,"$block"),ao(e.modelToView,n.modelToView).fromElement(u.id).toElement(u.viewElement),vo(e.viewToModel).fromElement(u.viewElement).toElement(u.id))}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}var c=new Hd(t,Wd);t.commands.set("headings",c)}}],[{key:"requires",get:function(){return[qd]}}]),e}(dd),$d=function(t){function e(){wo(this,e);var t=Oo(this,Object.getPrototypeOf(e).call(this));return qh.extend(t.template,{attributes:{"class":"ck-dropdown__button"}}),t}return xo(e,t),e}(Td),Jd=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return n.model.bind("isVisible").to(t),r.collections.add(new Vh("content")),r}return xo(e,t),e}(Fh),Ud=function(t){function e(){wo(this,e);var t=Oo(this,Object.getPrototypeOf(e).call(this)),n=t.bind;return t.template=new qh({tag:"div",attributes:{"class":["ck-reset","ck-dropdown__panel",n["if"]("isVisible","ck-dropdown__panel-visible")]}}),t.register("content",function(t){return t}),t}return xo(e,t),e}(Kh),Xd=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return r.collections.add(new Vh("main")),r._createButton(),r._createPanel(),r}return xo(e,t),_o(e,[{key:"_createButton",value:function(){var t=this.model,e=this.view.model,n=new Ih;n.bind("label","isOn","isEnabled").to(t),this.add("main",this.button=new Ed(n,new $d)),this.listenTo(n,"execute",function(){return e.isOpen=!e.isOpen})}},{key:"_createPanel",value:function(){var t=new Ih;t.bind("isVisible").to(this.view.model,"isOpen"),this.add("main",this.panel=new Jd(t,new Ud))}}]),e}(Fh),Yd=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return n.model.bind("label").to(t),t.style&&n.model.bind("style").to(t),n.model.on("click",function(){return t.fire("execute")}),r}return xo(e,t),e}(Fh),Gd=function(t){function e(){wo(this,e);var t=Oo(this,Object.getPrototypeOf(e).call(this)),n=t.bind;return t.template=new qh({tag:"li",attributes:{"class":["ck-reset","ck-list__item"],style:n.to("style")},children:[{text:n.to("label")}],on:{click:n.to("click")}}),t}return xo(e,t),e}(Kh),Qd=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n));return r.collections.add(new Vh("list")),r}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this,n=!0,r=!1,i=void 0;try{for(var o,a=this.model.items[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this._addListItem(s)}}catch(u){r=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return this.model.items.on("add",function(e,n,r){t._addListItem(n,r)}),this.model.items.on("remove",function(e,n){t._removeListItem(n)}),ko(Object.getPrototypeOf(e.prototype),"init",this).call(this)}},{key:"_addListItem",value:function(t,e){var n=this,r=new Yd(t,new Gd);r.id=t.label,this.listenTo(t,"execute",function(){n.model.fire("execute",t)}),this.add("list",r,e)}},{key:"_removeListItem",value:function(t){this.stopListening(t,"execute"),this.remove("list",t.label)}}]),e}(Fh),Zd=function(t){function e(){wo(this,e);var t=Oo(this,Object.getPrototypeOf(e).call(this));return t.template=new qh({tag:"ul",attributes:{"class":["ck-reset","ck-list"]}}),t.register("list",function(t){return t}),t}return xo(e,t),e}(Kh),tv=function(t){function e(t,n){wo(this,e);var r=Oo(this,Object.getPrototypeOf(e).call(this,t,n)),i=r.model.content;return r.listenTo(i,"execute",function(){n.model.isOpen=!1}),r.list=new Qd(i,new Zd),r.panel.add("content",r.list),r}return xo(e,t),e}(Xd),ev=function(t){function e(){wo(this,e);var t=Oo(this,Object.getPrototypeOf(e).call(this));return t.model.set("isOpen",!1),t.template=new qh({tag:"div",attributes:{"class":["ck-dropdown"]}}),t.register("main",function(t){return t}),t}return xo(e,t),e}(Kh),nv=function(t){function e(){wo(this,e);var t=Oo(this,Object.getPrototypeOf(e).call(this));return t.listenTo(t.model,"change:isOpen",function(e,n,r){r?t.listenTo(document,"click",function(e,n){var r=n.target;t.element==r||t.element.contains(r)||(t.model.isOpen=!1)}):t.stopListening(document)}),t}return xo(e,t),e}(ev),rv=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this.editor,e=t.commands.get("headings"),n=e.formats,r=new Mh,i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;r.add(new Ih({id:l.id,label:l.label}))}}catch(c){o=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}var f=new Ih({items:r}),h=new Ih({isEnabled:!0,isOn:!1,label:"Headings",content:f});h.bind("isEnabled").to(e,"isEnabled"),h.bind("label").to(e,"value",function(t){return t.label}),this.listenTo(f,"execute",function(e,n){t.execute("headings",n.id),t.editing.view.focus()}),t.ui.featureComponents.add("headings",tv,nv,h)}}],[{key:"requires",get:function(){return[Kd]}}]),e}(dd),iv=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"_doExecute",value:function(){var t=this.editor.document;t.enqueueChanges(function(){go(t.batch(),t.selection,{defaultBlockName:"paragraph"})})}}]),e}(vd),ov=function(t){function e(t){wo(this,e);var n=Oo(this,Object.getPrototypeOf(e).call(this,t));return t.on("keydown",function(e,r){n.isEnabled&&r.keyCode==xs.enter&&t.fire("enter",new Ph(t,r.domEvent))}),n}return xo(e,t),_o(e,[{key:"observe",value:function(){}}]),e}(kh),av=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,[{key:"init",value:function(){var t=this.editor,e=t.editing.view;e.addObserver(ov),t.commands.set("enter",new iv(t)),this.listenTo(e,"enter",function(e,n){t.execute("enter"),n.preventDefault()})}}]),e}(dd),sv=function(t){function e(){return wo(this,e),Oo(this,Object.getPrototypeOf(e).apply(this,arguments))}return xo(e,t),_o(e,null,[{key:"create",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return e.features||(e.features=[]),e.features=[].concat(So(e.features),[md,bd,Rd,Id,zd,rv,qd,av]),hd.create(t,e)}}]),e}(hd);return sv}();